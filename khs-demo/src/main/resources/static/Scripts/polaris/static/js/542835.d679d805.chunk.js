"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[542835],{782345:function(e,t,n){n.d(t,{U:function(){return _},j:function(){return a}});var a,o=n(974165),r=n(115861),i=n(215671),c=n(143144),l=n(625477),u=n(500811),d=n(628264),s=n(652928),m=n(735622),f=n(995124),p=n(769071),h=n(981142),v=n(588567),E=n(416031),T=n(815e3),C=n(53110);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(a||(a={}));var O=/<!--\[if gte vml 1\]>/g,g=/<!\[endif\]-->/g,R=/<!--\[PO\]\[if gte vml 1\]>/g,I=/<!\[endif\]\[PO\]-->/g,_=function(){function e(){(0,i.Z)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return(0,c.Z)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,(0,l.Ce)((0,u.vQ)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,(0,l.Ce)((0,u.$A)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===f.O.COMMON_CLIPBOARD?m.Z.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):m.Z.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return(0,l.qm)(d.p_).viewMode===s.wO.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,h.o.editDocument(v.OjI.BR_EDITMODE_COPY,v.vlz.CLIPDATA_FAVORITE_DATA,null,a.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,h.o.editDocument(v.OjI.BR_EDITMODE_CUT,v.vlz.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.OjI.BR_EDITMODE_PASTE,t=T.ZP.get("preventPasteFromExternal");this.isNativeMode||t?h.o.editDocument(e,v.vlz.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD):this.showAlert(f.O.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){h.o.editDocument(v.OjI.BR_EDITMODE_ORIGINAL_FORMAT,t,t===v.vlz.CLIPDATA_HTML?this.excludeImgElements(e):e,a.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=function(){var t=e[0];if(t){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,a=t.width,i=t.height;a>e||i>n;)a>e?(i*=e/a,a=e):i>n&&(a*=n/i,i=n);var c=document.createElement("canvas");c.width=a,c.height=i;var l=c.getContext("2d");l&&(l.drawImage(t,0,0,a,i),c.toBlob(function(){var e=(0,r.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,(0,C.Cq)(t);case 3:(n=e.sent)instanceof ArrayBuffer&&h.o.imageInsert(n,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(t)}},n=0;n<e.length;n+=1)t()}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),a=!(0,E.isEmpty)(n),o=!(0,E.isEmpty)(t),r=a&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),i=e.files&&e.files.length>0,c=T.ZP.get("preventPasteFromExternal");r||c?this.nativePaste():i&&!o?this.appendClipboardImage(e.files):a&&this.htmlDataTagCount(n)>0?this.externalPaste(n,v.vlz.CLIPDATA_HTML):o&&this.externalPaste(t,v.vlz.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var a=n.getElementsByTagName(t).length;return n.remove(),a}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===v.vlz.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var a=document.createRange();a.selectNodeContents(n);var o=window.getSelection();if(o){var r,i,c=[];if(o.rangeCount>0)for(var l=0;l<o.rangeCount;l+=1){var u=o.getRangeAt(l);c.push(u)}if(o.removeAllRanges(),o.addRange(a),document.execCommand("copy"),o.removeAllRanges(),c&&c.length>0)for(var d=0;d<c.length;d+=1)o.addRange(c[d]);var s=null===(r=p.Z.getForcusRef("DocInputField"))||void 0===r||null===(i=r.elementRef)||void 0===i?void 0:i.current;s&&s instanceof HTMLInputElement&&s.select()}}n.remove(),p.Z.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(O,"").replace(g,"");for(var n=t.getElementsByTagName("img"),a=0;a<n.length;a+=1){var o=n[a].getAttribute("v:shapes");if(!(0,E.isEmpty)(o)){var r=t.querySelector('[id="'.concat(o,'"]'));if(!r||!r.tagName||!r.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(O,"\x3c!--[PO][if gte vml 1]>")).replace(g,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!R.test(e)||!I.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(R,"").replace(I,"");var n=document.createElement("div");n.innerHTML=e.replace(R,"\x3c!--[if gte vml 1]>").replace(I,"<![endif]--\x3e");for(var a=n.getElementsByTagName("img"),o=a.length-1;o>=0;o-=1){var r=a[o],i=r.getAttribute("v:shapes");if(!(0,E.isEmpty)(i)){var c=t.querySelector('[id="'.concat(i,'"]'));c&&c.tagName&&c.tagName.toLowerCase().startsWith("v:")&&r.remove()}}return n.innerHTML}}]),e}()},438481:function(e,t,n){var a=n(215671),o=n(143144),r=n(179340),i=n(432269),c=n(782345),l=n(981142),u=n(588567),d=n(625477),s=n(229860),m=n(305054),f=n(530624),p=n(46531),h=n(815e3),v=function(e){(0,r.Z)(n,e);var t=(0,i.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"clone",value:function(){l.o.editDocument(u.OjI.BR_EDITMODE_CLONE,0,null,c.j.NATIVE_CLIPBOARD)}},{key:"copyFormat",value:function(e){this.isCopyFormatMode?this.copyFormatMode(!1):(this.copyFormatMode(!0,e),l.o.setFormCopyPaste(u.YMl.eFCP_COPY))}},{key:"copyFormatMode",value:function(e,t){this.setCopyFormatMode(e)&&(this.isCopyFormatMode?((0,d.Ce)((0,p.FV)(t?1:0)),(0,d.Ce)((0,s.kA)(t?u.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_MULTI:u.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_ONE)),(0,d.Ce)((0,s.ve)(!0))):((0,d.Ce)((0,p.FV)(-1)),(0,d.Ce)((0,s.kA)(u.mel.BR_MOUSE_HOVERING_NONE,!0))))}},{key:"formatPaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m.Z.getObjectControlType()===f.uq.eObjCtrEmpty?this.copyFormatMode(!1):(l.o.formatPaste(!1),0===(0,d.qm)(p.Gu).currentIndex&&this.copyFormatMode(!1),e&&this.copyFormatMode(!1))}},{key:"onClipboardResult",value:function(e,t,n,a){if(e===u.RUN.COPY_EVENT||e===u.RUN.CUT_EVENT||e===u.RUN.SLIDE_COPY_EVENT||e===u.RUN.SLIDE_CUT_EVENT){if(this.setNativeMode(!0),h.ZP.get("preventCopyToExternal"))return;var o="",r=u.vlz.CLIPDATA_STR;if(""!==n&&(o=n),""!==a&&(o=a,r=u.vlz.CLIPDATA_HTML),m.Z.getObjectControlType()!==f.uq.eObjCtrTemplate&&m.Z.getObjectControlType()!==f.uq.eObjCtrLine&&m.Z.getObjectControlType()!==f.uq.eObjCtrImage&&m.Z.getObjectControlType()!==f.uq.eObjCtrChart&&m.Z.getObjectControlType()!==f.uq.eObjCtrVideo&&m.Z.getObjectControlType()!==f.uq.eObjCtrInfraPen||(o="<span>".concat(o,"</span>"),r=u.vlz.CLIPDATA_HTML),this.clipboardDataTransfer){var i=this.createClipboardElement(o);this.clipboardDataTransfer.setData("text/html",i.innerHTML),n.length>0&&this.clipboardDataTransfer.setData("text/plain",n),this.clipboardDataTransfer=null,i.remove()}else this.copyToClipboard(o,r)}}}]),n}(c.U),E=new v;t.Z=E},542835:function(e,t,n){n.r(t);var a=n(601413),o=n(944925),r=n(625477),i=n(448439),c=n(735622),l=n(588567),u=n(995124),d=n(237683),s=n(260861),m=n(886697),f=n(438481),p=n(877703),h=n(820371),v=n(981142),E=n(12689),T=n(769071),C=n(537997),O=n(78090),g=n(732094),R=n(104994),I=n(954978),_=n(347806),M=n(768895),y=n(815e3),D=n(652928),P=n(780386),b=n(100457),A=n(53110),L=n(173470),N=["imageBlob"],S={OnInitComplete:function(){(0,A.Vq)()||((0,r.Ce)((0,M.BM)(!0)),(0,r.Ce)((0,I.T5)()))},OnOpenComplete:function(){i.Z.commandInitvalue(),_.Z.hideContextMenu(),(0,r.Ce)((0,s.kp)()),(0,r.Ce)((0,h.DM)())},OnLoadFail:function(e){var t=function(){d.Z.apply("onLoadFail",[e]),c.Z.showDialog({dialogId:u.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_INTERNAL"}},(function(){d.Z.apply("onCancelOpenDocument")}))};switch(e){case l.v6t.kPoErrWritePasswordDoc:case l.v6t.kPoErrReadPasswordDoc:case l.v6t.kPoErrWrongWritePassword:case l.v6t.kPoErrWrongReadPassword:var n=y.ZP.get("viewMode"),a=y.ZP.get("preventEditPasswordDocument");if(((0,A.Vq)()||n!==D.wO.edit||!0===a)&&e===l.v6t.kPoErrWritePasswordDoc)return P.Z.setOpenMode(l.ekp.ePRM_PASSWORD_WRITE_READ_ONLY),void P.Z.openDocumentWithPassword();c.Z.showDialog({dialogId:u.O.COMMON_DOC_PASSWORD_CONFIRM,bModal:!0,data:e},(function(){t()}));break;case l.v6t.kPoErrReadOnlyFontData:i.Z.getCommandInstance("SlideReadonlyFontCommand").invoke();break;case l.v6t.kPoErrUnsupportedEncryptionType:d.Z.apply("onLoadFail",[e]),c.Z.showDialog({dialogId:u.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_ENCRYPTION_TYPE"}},(function(){d.Z.apply("onCancelOpenDocument")}));break;default:t()}},OnTotalLoadComplete:function(){v.o.setViewMode(l.lK3.eVIEWMODE_FITTOWHOLEPAGE),(0,r.Ce)((0,b.He)(!1)),(0,r.Ce)((0,O.Xx)())},OnDrawBitmap:function(){(0,r.Ce)((0,m.k4)()),(0,r.Ce)((0,M.oY)()),(0,r.Ce)((0,h.ce)()),(0,r.Ce)((0,L.Z7)()),(0,p.pL)()},OnClipboardResult:function(e){var t=e.nEventType,n=e.nResult,a=e.textData,o=e.htmlData;f.Z.onClipboardResult(t,n,a,o)},OnShapeDrawModeEnd:function(e){g.Z.endShapeDraw(),e>=901&&e<=912&&c.Z.showDialog({dialogId:u.O.SLIDE_ACTION,bModal:!0,currentTabIndex:0})},OnPptDrawSlidesBitmap:function(e){var t=e.pageNumber,n=e.imageBlob;(0,r.Ce)((0,p.Tz)({pageNumber:t,thumbnailItem:{url:URL.createObjectURL(n),isHide:v.o.getIsSlideHide(t)}}))},OnGetPageThumbnail:function(e){var t=e.imageBlob,n=(0,o.Z)(e,N);(0,r.Ce)((0,R.Fq)((0,a.Z)((0,a.Z)({},n),{},{url:URL.createObjectURL(t)})))},OnPageMove:function(e){var t=e.nCurrentPage,n=e.nTotalPage;T.Z.focus("DocInputField"),(0,r.Ce)((0,h.KT)(t,n)),(0,r.Ce)((0,C.CG)())},OnUndoOrRedo:function(e){e.isUndo;var t=e.brUndoRedoInfo;(0,p.z_)(t),(0,r.Ce)((0,C.CG)())},OnUndoOrRedoSlidePage:function(e){(0,p.z_)(e)},OnPptSlideInsert:function(){(0,r.Ce)((0,h.ce)()),(0,r.Ce)((0,C.CG)())},OnPptSlideDelete:function(){(0,r.Ce)((0,h.ce)()),(0,r.Ce)((0,C.CG)())},OnSlidePageUpdate:function(e){var t=e.pPageList;(0,r.Ce)((0,p.Ml)(t))},OnGetMasterPageInfo:function(e){var t=e.pageNumber,n=e.width,a=e.height,o=e.masterIndex,r=e.imageBlob;E.Z.OnGetMasterPageInfo(o,t,n,a,URL.createObjectURL(r))},OnThemeLoadStart:function(){(0,O.Rg)(!1)},OnThemeLoadComplete:function(){(0,O.Rg)(!0)},OnSearchMode:function(){},OnNewDoc:function(){}};t.default=S},78090:function(e,t,n){n.d(t,{Ho:function(){return g},Rg:function(){return _},Xx:function(){return C},zB:function(){return O}});var a=n(974165),o=n(115861),r=n(231881),i=n.n(r),c=n(426373),l=n(135323),u=n(625477),d=n(981142),s=n(588567),m=n(86983),f=n(977917),p=n(877703),h={currentItemId:-1,selectedIndex:-1},v=(0,c.oM)({name:"theme",initialState:h,reducers:{setDesignTheme:function(e,t){var n=t.payload;e.currentItemId=n,e.selectedIndex=n},initTheme:function(){return h}}}),E=v.actions,T=E.setDesignTheme,C=E.initTheme,O=(0,l.P1)((function(e){return e.command.design}),(function(e){return e.theme}));t.ZP=v.reducer;var g=function(e){return(0,u.RU)("setDesignThemeThunk",function(){var t=(0,o.Z)((0,a.Z)().mark((function t(n,o){var r,c,l,u,p,h,v,E;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o(),c=r.command.design.theme.selectedIndex,l=r.docInfo.docType,u=r.locale.currentLocale,c!==e){t.next=6;break}return t.abrupt("return");case 6:return t.prev=6,p=R[e],(h=(0,s.mm)()).nMasterIndex=0,h.nPPTThemeOpenMode=m.Zqb.THEME_MODE_THEME_REPLACE,h.eThemeSet=p.type,v="".concat("/polaris","/static/media/").concat(l,"/theme/").concat(u,"/").concat(p.fileName),t.next=15,i().get(v,{responseType:"arraybuffer"});case 15:E=t.sent.data,d.o.setThemeData(h,E,p.fileName),n(T(e)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(6),f.ZP.error("Theme file load Error","[".concat(t.t0.message,"]"));case 23:case"end":return t.stop()}}),t,null,[[6,20]])})));return function(e,n){return t.apply(this,arguments)}}())},R=[{type:m.RLW.BR_THEMESET_OFFICE,fileName:"theme-default.thmx"},{type:m.RLW.BR_THEMESET_SOLID,fileName:"theme-solid.thmx"},{type:m.RLW.BR_THEMESET_GRADATION,fileName:"theme-pattern.thmx"},{type:m.RLW.BR_THEMESET_WOOD,fileName:"theme-wood.thmx"},{type:m.RLW.BR_THEMESET_DIAGONAL,fileName:"theme-diagonal.thmx"},{type:m.RLW.BR_THEMESET_LINE,fileName:"theme-line.thmx"},{type:m.RLW.BR_THEMESET_BNW,fileName:"theme-pattern-BnW.thmx"},{type:m.RLW.BR_THEMESET_DARK,fileName:"theme-pattern-dark.thmx"},{type:m.RLW.BR_THEMESET_HEXAGON,fileName:"theme-pattern-hexagon.thmx"},{type:m.RLW.BR_THEMESET_PARTICLE,fileName:"theme-pattern-particle.thmx"},{type:m.RLW.BR_THEMESET_SQUARE,fileName:"theme-pattern-square.thmx"},{type:m.RLW.BR_THEMESET_WAVE,fileName:"theme-wave.thmx"}],I=!1,_=function(e){e?I&&((0,u.Ce)((0,p.A7)(!0)),I=!1):I=!0}},954978:function(e,t,n){n.d(t,{T5:function(){return f},UN:function(){return p},wW:function(){return u}});var a=n(426373),o=n(135323),r=n(981142),i=n(705233),c=n(625477),l=(0,a.oM)({name:"tableGrid",initialState:{isChecked:!1},reducers:{setIsChecked:function(e,t){e.isChecked=t.payload}}}),u=(0,o.P1)((function(e){return e.command.table.tableGrid}),(function(e){return e})),d=l.actions.setIsChecked;t.ZP=l.reducer;var s;!function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"}(s||(s={}));var m=function(e){r.o.setTableGrid(e?s.Show:s.Hide)},f=function(){return(0,c.RU)("initTableGridShowThunk",(function(e){var t="true"===(0,i.le)(i.Fe.TABLE_GRID_SHOW_KEY);m(t),e(d(t))}))},p=function(e){return(0,c.RU)("setTableGridShowThunk",(function(t){m(e),t(d(e)),function(e){(0,i.D$)(i.Fe.TABLE_GRID_SHOW_KEY,e?"true":"false")}(e)}))}},104994:function(e,t,n){n.d(t,{BV:function(){return l},Fq:function(){return c},wN:function(){return u}});var a=n(426373),o=n(135323),r=(0,a.oM)({name:"slideActionPage",initialState:{pageThumbnail:{}},reducers:{setActionThumbnail:function(e,t){e.pageThumbnail=t.payload},clearActionThumbnail:function(e){e.pageThumbnail={}}}}),i=r.actions,c=i.setActionThumbnail,l=i.clearActionThumbnail;t.ZP=r.reducer;var u=(0,o.P1)((function(e){return e.slideActionPage}),(function(e){return e}))}}]);