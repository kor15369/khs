"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[644975],{644975:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var a=n(747313),i=n(180252),s=n(837490),c=n(700936),u=n(448439),o=n(260861),l=n(82411),r=n(769071),d=n(346417);function _(e){var t=e.commandName,n=(0,i.I0)();return(0,a.useEffect)((function(){return n((0,l.J1)()),function(){n((0,l.J4)())}}),[n]),(0,d.jsx)("div",{className:"".concat(s.Z.sub_box),style:{display:"block"},children:(0,d.jsx)(I,{commandName:t})})}function I(e){var t=e.commandName,n=(0,i.v9)(l.jX),a=n.thumbnailDatas,c=n.currentStyleIndex;return(0,d.jsx)("div",{className:"".concat(s.Z.icon_list," ").concat(s.Z.ribon_style),children:a&&a.map((function(e,n){return(0,d.jsx)(E,{index:n,styleIndex:a[n].styleIndex,isChecked:a[n].styleIndex===c,commandName:t,url:a[n].url,styleName:a[n].styleName,isLocaleText:a[n].isLocaleText},n)}))})}function E(e){var t=(0,i.I0)(),n=e.styleIndex,l=e.commandName,_=e.isChecked,I=e.url,E=e.styleName,S=e.isLocaleText,h=(0,c.Z)().formatMessage,m=E;S&&(m=h({id:E}));var T=(0,a.useCallback)((function(e){var a=u.Z.getCommandInstance(l);a&&(a.invoke({styleIndex:n}),t((0,o.kp)()),r.Z.focus("DocInputField"))}),[l,t,n]),f="";return _&&(f="".concat(s.Z.active)),(0,d.jsx)("button",{className:f,onClick:T,style:{width:"76px",height:"60px"},children:(0,d.jsxs)("div",{className:"".concat(s.Z.icon),children:[(0,d.jsx)("i",{style:{background:"url(".concat(I,") no-repeat center"),backgroundSize:"cover",width:"70px",height:"30px"}}),(0,d.jsxs)("span",{className:"".concat(s.Z.text_type),children:[m," "]})]})})}function S(e){return"home_style"===e.unitId?(0,d.jsx)(_,{commandName:e.commandName}):null}},217010:function(e,t,n){var a=n(215671),i=n(143144),s=n(981142),c=n(625477),u=n(82411),o=new(function(){function e(){(0,a.Z)(this,e),this._thumbnailDatas=[],this.STYLE_NAME_LIST=["QUICK_STYLE_TITLE","QUICK_STYLE_HEADING1","QUICK_STYLE_HEADING2","QUICK_STYLE_HEADING3","QUICK_STYLE_HEADING4","QUICK_STYLE_HEADING5","QUICK_STYLE_HEADING6","QUICK_STYLE_HEADING7","QUICK_STYLE_HEADING8","QUICK_STYLE_HEADING9","QUICK_STYLE_SUBTITLE","QUICK_STYLE_SUBEMPHASI","QUICK_STYLE_EMPHASIS","QUICK_STYLE_INTEMPHASI","QUICK_STYLE_STRONG","QUICK_STYLE_QUOTE","QUICK_STYLE_INTQUOTE","QUICK_STYLE_SUBREFER","QUICK_STYLE_INTREFER","QUICK_STYLE_LISTPARA","QUICK_STYLE_NORMAL","QUICK_STYLE_NOSPACE","QUICK_STYLE_BOOKTITLE"],this.DEFAULT_STYLE_NAME=["Title","heading 1","heading 2","heading 3","heading 4","heading 5","heading 6","heading 7","heading 8","heading 9","Subtitle","Subtle Emphasis","Emphasis","Intense Emphasis","Strong","Quote","Intense Quote","Subtle Reference","Intense Reference","List Paragraph","Normal","No Spacing","Book title"]}return(0,i.Z)(e,[{key:"requestThumbnail",value:function(e){this._thumbnailDatas=[],s.o.getPreviewStyle(70*e,30*e,0,96*e)}},{key:"OnDrawGetPreviewStyle",value:function(e,t,n,a,i,s,o){var l=this,r=s,d=!1,_=this.DEFAULT_STYLE_NAME.indexOf(r);-1!==_&&(r=this.STYLE_NAME_LIST[_],d=!0);var I={index:i,width:t,height:n,url:e,styleName:r,styleIndex:a,isLocaleText:d};this._thumbnailDatas[i]=I,setTimeout((function(){(0,c.Ce)((0,u.KA)({thumbnailDatas:l._thumbnailDatas}))}),300)}}]),e}());t.Z=o},82411:function(e,t,n){n.d(t,{J1:function(){return T},J4:function(){return h},KA:function(){return S},jX:function(){return m}});var a=n(426373),i=n(135323),s=n(625477),c=n(101922),u=n(726091),o=n(371266),l=n(217010),r=n(981142),d=n(260861),_={isDisabled:!1,currentStyleIndex:-1,thumbnailDatas:[]},I=(0,a.oM)({name:"fontStyle",initialState:_,reducers:{setFontStyleThumbnail:function(e,t){var n=t.payload.thumbnailDatas;e.thumbnailDatas=n},clearFontStyleDatas:function(){return _}},extraReducers:function(e){e.addCase(c.He,(function(e){e.isDisabled=u.Z.isDisable(o.wI4)})),e.addCase(d.SP,(function(e,t){"home_style"===t.payload.id&&(e.currentStyleIndex=r.o.getStyleTypeIndex())}))}}),E=I.actions,S=E.setFontStyleThumbnail,h=E.clearFontStyleDatas;t.ZP=I.reducer;var m=(0,i.P1)((function(e){return e.command.font}),(function(e){return e.style})),T=function(){return(0,s.RU)("setFontStyleThumbnailThunk",(function(e,t){var n=t().section.devicePixelRatio;l.Z.requestThumbnail(n)}))}}}]);