"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[821076],{782345:function(e,t,n){n.d(t,{U:function(){return O},j:function(){return i}});var i,a=n(974165),r=n(115861),o=n(215671),l=n(143144),u=n(625477),c=n(500811),s=n(628264),d=n(652928),f=n(735622),h=n(995124),p=n(769071),v=n(981142),T=n(588567),m=n(416031),C=n(815e3),I=n(53110);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(i||(i={}));var _=/<!--\[if gte vml 1\]>/g,E=/<!\[endif\]-->/g,g=/<!--\[PO\]\[if gte vml 1\]>/g,D=/<!\[endif\]\[PO\]-->/g,O=function(){function e(){(0,o.Z)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return(0,l.Z)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,(0,u.Ce)((0,c.vQ)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,(0,u.Ce)((0,c.$A)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===h.O.COMMON_CLIPBOARD?f.Z.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):f.Z.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return(0,u.qm)(s.p_).viewMode===d.wO.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,v.o.editDocument(T.OjI.BR_EDITMODE_COPY,T.vlz.CLIPDATA_FAVORITE_DATA,null,i.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,v.o.editDocument(T.OjI.BR_EDITMODE_CUT,T.vlz.CLIPDATA_STR,null,i.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.OjI.BR_EDITMODE_PASTE,t=C.ZP.get("preventPasteFromExternal");this.isNativeMode||t?v.o.editDocument(e,T.vlz.CLIPDATA_STR,null,i.NATIVE_CLIPBOARD):this.showAlert(h.O.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){v.o.editDocument(T.OjI.BR_EDITMODE_ORIGINAL_FORMAT,t,t===T.vlz.CLIPDATA_HTML?this.excludeImgElements(e):e,i.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=function(){var t=e[0];if(t){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,i=t.width,o=t.height;i>e||o>n;)i>e?(o*=e/i,i=e):o>n&&(i*=n/o,o=n);var l=document.createElement("canvas");l.width=i,l.height=o;var u=l.getContext("2d");u&&(u.drawImage(t,0,0,i,o),l.toBlob(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,(0,I.Cq)(t);case 3:(n=e.sent)instanceof ArrayBuffer&&v.o.imageInsert(n,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(t)}},n=0;n<e.length;n+=1)t()}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),i=!(0,m.isEmpty)(n),a=!(0,m.isEmpty)(t),r=i&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),o=e.files&&e.files.length>0,l=C.ZP.get("preventPasteFromExternal");r||l?this.nativePaste():o&&!a?this.appendClipboardImage(e.files):i&&this.htmlDataTagCount(n)>0?this.externalPaste(n,T.vlz.CLIPDATA_HTML):a&&this.externalPaste(t,T.vlz.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var i=n.getElementsByTagName(t).length;return n.remove(),i}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===T.vlz.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var i=document.createRange();i.selectNodeContents(n);var a=window.getSelection();if(a){var r,o,l=[];if(a.rangeCount>0)for(var u=0;u<a.rangeCount;u+=1){var c=a.getRangeAt(u);l.push(c)}if(a.removeAllRanges(),a.addRange(i),document.execCommand("copy"),a.removeAllRanges(),l&&l.length>0)for(var s=0;s<l.length;s+=1)a.addRange(l[s]);var d=null===(r=p.Z.getForcusRef("DocInputField"))||void 0===r||null===(o=r.elementRef)||void 0===o?void 0:o.current;d&&d instanceof HTMLInputElement&&d.select()}}n.remove(),p.Z.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(_,"").replace(E,"");for(var n=t.getElementsByTagName("img"),i=0;i<n.length;i+=1){var a=n[i].getAttribute("v:shapes");if(!(0,m.isEmpty)(a)){var r=t.querySelector('[id="'.concat(a,'"]'));if(!r||!r.tagName||!r.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(_,"\x3c!--[PO][if gte vml 1]>")).replace(E,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!g.test(e)||!D.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(g,"").replace(D,"");var n=document.createElement("div");n.innerHTML=e.replace(g,"\x3c!--[if gte vml 1]>").replace(D,"<![endif]--\x3e");for(var i=n.getElementsByTagName("img"),a=i.length-1;a>=0;a-=1){var r=i[a],o=r.getAttribute("v:shapes");if(!(0,m.isEmpty)(o)){var l=t.querySelector('[id="'.concat(o,'"]'));l&&l.tagName&&l.tagName.toLowerCase().startsWith("v:")&&r.remove()}}return n.innerHTML}}]),e}()},217010:function(e,t,n){var i=n(215671),a=n(143144),r=n(981142),o=n(625477),l=n(82411),u=new(function(){function e(){(0,i.Z)(this,e),this._thumbnailDatas=[],this.STYLE_NAME_LIST=["QUICK_STYLE_TITLE","QUICK_STYLE_HEADING1","QUICK_STYLE_HEADING2","QUICK_STYLE_HEADING3","QUICK_STYLE_HEADING4","QUICK_STYLE_HEADING5","QUICK_STYLE_HEADING6","QUICK_STYLE_HEADING7","QUICK_STYLE_HEADING8","QUICK_STYLE_HEADING9","QUICK_STYLE_SUBTITLE","QUICK_STYLE_SUBEMPHASI","QUICK_STYLE_EMPHASIS","QUICK_STYLE_INTEMPHASI","QUICK_STYLE_STRONG","QUICK_STYLE_QUOTE","QUICK_STYLE_INTQUOTE","QUICK_STYLE_SUBREFER","QUICK_STYLE_INTREFER","QUICK_STYLE_LISTPARA","QUICK_STYLE_NORMAL","QUICK_STYLE_NOSPACE","QUICK_STYLE_BOOKTITLE"],this.DEFAULT_STYLE_NAME=["Title","heading 1","heading 2","heading 3","heading 4","heading 5","heading 6","heading 7","heading 8","heading 9","Subtitle","Subtle Emphasis","Emphasis","Intense Emphasis","Strong","Quote","Intense Quote","Subtle Reference","Intense Reference","List Paragraph","Normal","No Spacing","Book title"]}return(0,a.Z)(e,[{key:"requestThumbnail",value:function(e){this._thumbnailDatas=[],r.o.getPreviewStyle(70*e,30*e,0,96*e)}},{key:"OnDrawGetPreviewStyle",value:function(e,t,n,i,a,r,u){var c=this,s=r,d=!1,f=this.DEFAULT_STYLE_NAME.indexOf(s);-1!==f&&(s=this.STYLE_NAME_LIST[f],d=!0);var h={index:a,width:t,height:n,url:e,styleName:s,styleIndex:i,isLocaleText:d};this._thumbnailDatas[a]=h,setTimeout((function(){(0,o.Ce)((0,l.KA)({thumbnailDatas:c._thumbnailDatas}))}),300)}}]),e}());t.Z=u},938004:function(e,t,n){var i=n(215671),a=n(143144),r=n(179340),o=n(432269),l=n(782345),u=n(305054),c=n(588567),s=n(530624),d=n(815e3),f=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"onClipboardResult",value:function(e,t,n,i){if(e===c.RUN.COPY_EVENT||e===c.RUN.CUT_EVENT){if(this.setNativeMode(!0),d.ZP.get("preventCopyToExternal"))return;var a="",r=c.vlz.CLIPDATA_STR;if(""!==n&&(a=n),""!==i&&(a=i,r=c.vlz.CLIPDATA_HTML),u.Z.getObjectControlType()!==s.uq.eObjCtrTemplate&&u.Z.getObjectControlType()!==s.uq.eObjCtrTemplateInlineText&&u.Z.getObjectControlType()!==s.uq.eObjCtrLine&&u.Z.getObjectControlType()!==s.uq.eObjCtrLineInlineText&&u.Z.getObjectControlType()!==s.uq.eObjCtrImage&&u.Z.getObjectControlType()!==s.uq.eObjCtrImageInlineText&&u.Z.getObjectControlType()!==s.uq.eObjCtrChart&&u.Z.getObjectControlType()!==s.uq.eObjCtrChartInlineText||(a="<span>".concat(a,"</span>"),r=c.vlz.CLIPDATA_HTML),this.clipboardDataTransfer){var o=this.createClipboardElement(a);this.clipboardDataTransfer.setData("text/html",o.innerHTML),n.length>0&&this.clipboardDataTransfer.setData("text/plain",n),this.clipboardDataTransfer=null,o.remove()}else this.copyToClipboard(a,r)}}}]),n}(l.U),h=new f;t.Z=h},821076:function(e,t,n){n.r(t);var i=n(625477),a=n(448439),r=n(260861),o=n(347806),l=n(768895),u=n(981142),c=n(732094),s=n(938004),d=n(217010),f=n(849086),h=n(588567),p=n(735622),v=n(995124),T=n(237683),m=n(53110),C=n(832804),I=n(649922),_=n(815e3),E=n(491440),g={OnInitComplete:function(){(0,m.Vq)()||(0,i.Ce)((0,f.PF)())},OnOpenComplete:function(){a.Z.commandInitvalue(),o.Z.hideContextMenu(),(0,i.Ce)((0,r.kp)()),(0,i.Ce)((0,l.iE)()),u.o.setZoom(1e4),u.o.scrollUp(h.ZJZ.eSCROLL_FACTOR_80),m.tq&&u.o.setViewMode(h.lK3.eVIEWMODE_FITTOWIDTH),setTimeout((function(){(0,i.Ce)((0,I.TA)())}),200)},OnLoadFail:function(e){switch(T.Z.apply("onLoadFail",[e]),e){case h.v6t.kPoErrUnsupportedVersion:p.Z.showDialog({dialogId:v.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_NOT_SUPPORT_VERSION"}},(function(){T.Z.apply("onCancelOpenDocument")}));break;case h.v6t.kPoErrUnsupportedEncryptionType:case h.v6t.kPoErrUnsupportedVersionHwpxPassword:T.Z.apply("onLoadFail",[e]),p.Z.showDialog({dialogId:v.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_ENCRYPTION_TYPE"}},(function(){T.Z.apply("onCancelOpenDocument")}));break;case h.v6t.kPoErrUnsupportedVersionHwpxDistribution:T.Z.apply("onLoadFail",[e]),p.Z.showDialog({dialogId:v.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_DISTRIBUTION_HWPX"}},(function(){T.Z.apply("onCancelOpenDocument")}));break;default:p.Z.showDialog({dialogId:v.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_INTERNAL"}},(function(){T.Z.apply("onCancelOpenDocument")}))}},OnDrawBitmapThrottle:function(){(0,i.Ce)((0,l.oY)())},OnShapeDrawModeEnd:function(){c.Z.endShapeDraw()},OnGetHighlightListCount:function(e){(0,i.Ce)((0,C.R3)(e))},OnClipboardResult:function(e){var t=e.nEventType,n=e.nResult,i=e.textData,a=e.htmlData;s.Z.onClipboardResult(t,n,i,a)},OnDrawGetPreviewStyle:function(e){var t=e.imageBlob,n=e.width,i=e.height,a=e.styleIndex,r=e.index,o=e.styleName,l=e.bTextAttStyle;d.Z.OnDrawGetPreviewStyle(URL.createObjectURL(t),n,i,a,r,o,l)},OnNewDoc:function(){},OnGetImageLocationsInScreen:function(e){var t=e.imageLocations;if(_.ZP.checkCallback("onServiceExternal")){var n=[];t.forEach((function(e){var t=e.priority,i=e.points,a=e.origin_rect,r=e.rotateAngle,o=e.frameID,l=e.urlExists,u=l?e.frameUrl:"";n.push({priority:t,points:i,originalRect:a,rotateAngle:r,frameId:o,frameUrl:u,existUrl:l})})),(0,i.Ce)((0,E.UO)(n))}}};t.default=g},832804:function(e,t,n){n.d(t,{NI:function(){return m},PT:function(){return C},R3:function(){return v},bD:function(){return p},mU:function(){return T}});var i=n(426373),a=n(135323),r=n(101922),o=n(371266),l=n(588567),u=n(981142),c=n(625477),s=n(726091),d={isFindDisabled:!1,isReplaceDisabled:!1,findString:"",replaceString:"",direction:void 0,eFindReplaceResultType:void 0,highlightedCount:void 0},f=(0,i.oM)({name:"findReplace",initialState:d,reducers:{setFindString:function(e,t){e.findString=t.payload},setReplaceString:function(e,t){e.replaceString=t.payload},setHighlightedCount:function(e,t){e.highlightedCount=t.payload},setDirection:function(e,t){e.direction=t.payload}},extraReducers:function(e){e.addCase(r.He,(function(e){e.isFindDisabled=s.Z.isDisable(o.p$9),e.isReplaceDisabled=s.Z.isDisable(o.dYl)})),e.addCase(r.DZ,(function(e,t){e.eFindReplaceResultType=t.payload.nResult}))}}),h=f.actions,p=h.setFindString,v=(h.setReplaceString,h.setHighlightedCount),T=h.setDirection;t.ZP=f.reducer;var m=(0,a.P1)((function(e){return e.command.edit.findReplace}),(function(e){return e})),C=((0,a.P1)(m,(function(e){return{isDisabled:e.isFindDisabled}})),(0,a.P1)(m,(function(e){return{isDisabled:e.isReplaceDisabled}})),function(e){return(0,c.RU)("startFindRepeatInvertThunk",(function(t,n){var i=n().command.edit.findReplace.direction===l.mk_.BR_FIND_DIR_NEXT||n().command.edit.findReplace.direction===l.mk_.BR_FIND_DIR_GLOBAL?l.mk_.BR_FIND_DIR_PREV:l.mk_.BR_FIND_DIR_NEXT;e.Direction=i,u.o.searchStart(e),t(T(i))}))})},82411:function(e,t,n){n.d(t,{J1:function(){return C},J4:function(){return T},KA:function(){return v},jX:function(){return m}});var i=n(426373),a=n(135323),r=n(625477),o=n(101922),l=n(726091),u=n(371266),c=n(217010),s=n(981142),d=n(260861),f={isDisabled:!1,currentStyleIndex:-1,thumbnailDatas:[]},h=(0,i.oM)({name:"fontStyle",initialState:f,reducers:{setFontStyleThumbnail:function(e,t){var n=t.payload.thumbnailDatas;e.thumbnailDatas=n},clearFontStyleDatas:function(){return f}},extraReducers:function(e){e.addCase(o.He,(function(e){e.isDisabled=l.Z.isDisable(u.wI4)})),e.addCase(d.SP,(function(e,t){"home_style"===t.payload.id&&(e.currentStyleIndex=s.o.getStyleTypeIndex())}))}}),p=h.actions,v=p.setFontStyleThumbnail,T=p.clearFontStyleDatas;t.ZP=h.reducer;var m=(0,a.P1)((function(e){return e.command.font}),(function(e){return e.style})),C=function(){return(0,r.RU)("setFontStyleThumbnailThunk",(function(e,t){var n=t().section.devicePixelRatio;c.Z.requestThumbnail(n)}))}},849086:function(e,t,n){n.d(t,{Cm:function(){return T},Kc:function(){return h},PF:function(){return v}});var i=n(426373),a=n(135323),r=n(625477),o=n(981142),l=n(101922),u=n(726091),c=n(371266),s=n(705233),d=(0,i.oM)({name:"gridline",initialState:{isChecked:!0,isDisabled:!1},reducers:{setIsChecked:function(e,t){e.isChecked=t.payload}},extraReducers:function(e){e.addCase(l.He,(function(e){e.isChecked=o.o.getGridGuides().bShow,e.isDisabled=u.Z.isDisable(c.G4l)}))}}),f=function(e){var t=o.o.getGridGuides();o.o.setGridGuides(e,t.bSnap,t.nGapHimetric)},h=(0,a.P1)((function(e){return e.command.view.gridline}),(function(e){return e})),p=d.actions.setIsChecked;t.ZP=d.reducer;var v=function(){return(0,r.RU)("initGridlineThunk",(function(e){var t="true"===(0,s.le)(s.Fe.HWP_GRIDLINE_SHOW_KEY);f(t),e(p(t))}))},T=function(e){return(0,r.RU)("setGridlineThunk",(function(t){f(e),t(p(e)),function(e){(0,s.D$)(s.Fe.HWP_GRIDLINE_SHOW_KEY,e?"true":"false")}(e)}))}},649922:function(e,t,n){n.d(t,{Bc:function(){return h},TA:function(){return f},kW:function(){return s}});var i=n(426373),a=n(135323),r=n(981142),o=n(101922),l=n(705233),u=n(625477),c=(0,i.oM)({name:"showMemo",initialState:{isDisabled:!1,isChecked:!1},reducers:{},extraReducers:function(e){e.addCase(o.He,(function(e){e.isChecked=r.o.memoIsShow()}))}}),s=(0,a.P1)((function(e){return e.command.view.showMemo}),(function(e){return e}));t.ZP=c.reducer;var d=function(e){r.o.memoSetShow(e)},f=function(){return(0,u.RU)("initShowMemoThunk",(function(e){var t="true"===(0,l.le)(l.Fe.HWP_SHOW_MEMO);d(t)}))},h=function(e){return(0,u.RU)("setShowMemoThunk",(function(t){var n;d(e),n=e,(0,l.D$)(l.Fe.HWP_SHOW_MEMO,n?"true":"false")}))}}}]);