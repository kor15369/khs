"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[794848],{827611:function(e,t,n){n.d(t,{Z:function(){return i}});n(747313);var c=n(837490),a=n(307360),l=n(346417);function i(e){var t=e.buttonLabels,n=e.onClick,i=e.buttonDisableStates;return(0,l.jsx)("div",{className:c.Z.popup_btn_wrap,children:t.map((function(e,t){var r=!!i&&i[t];return(0,l.jsx)("button",{className:"".concat(c.Z.p_btn," ").concat(c.Z.normal),onClick:function(){return n(t)},disabled:r,children:(0,l.jsx)(a.Z,{label:e})},t)}))})}},634077:function(e,t,n){n.d(t,{r:function(){return s}});var c=n(870885),a=n(747313),l=n(59199),i=n(837490),r=n(346417),s=(0,a.forwardRef)((function(e,t){var n=e.list,s=e.currentIndex,o=e.isDisable,u=e.inputWidth,_=e.canEditInput,E=void 0!==_&&_,d=e.scrollTop,R=(0,a.useState)(!1),T=(0,c.Z)(R,2),M=T[0],x=T[1],C=(0,a.useState)(""),h=(0,c.Z)(C,2),N=h[0],O=h[1];(0,a.useEffect)((function(){e.inputValue?O(e.inputValue||""):n[s]&&O(n[s].text)}),[s,n,e.inputValue]);var m=(0,a.useCallback)((function(){o||x(!M)}),[o,M]),f=(0,a.useCallback)((function(){x(!1)}),[]),A=(0,a.useCallback)((function(t){x(!1),O(n[t].text),e.onClickItem&&e.onClickItem(t)}),[n,e]),g=(0,a.useCallback)((function(t){var n=t.target.value;O(n),e.onChangeInput&&e.onChangeInput(n)}),[e]),p="".concat(i.Z.custom_select," ").concat(o?"".concat(i.Z.disabled):""),j="".concat(i.Z.current),b={},D={},F={display:M?"block":"none",marginTop:"".concat(2-(d||0),"px")};return u&&(b.minWidth="".concat(u,"px"),b.width="auto",E&&(D.minWidth="".concat(u,"px"),D.boxSizing="border-box"),F.minWidth="".concat(u,"px"),F.boxSizing="border-box"),(0,r.jsx)("div",{className:p,children:(0,r.jsxs)(l.default,{onOutsideClick:f,children:[E?(0,r.jsx)("div",{className:i.Z.multi_select,children:(0,r.jsxs)("div",{className:i.Z.i_txt,style:D,children:[(0,r.jsx)("input",{type:"text",ref:t,value:N,onChange:g}),(0,r.jsx)("button",{className:i.Z.toggle,onClick:m,children:(0,r.jsx)("span",{children:"toggle"})})]})}):(0,r.jsx)("button",{className:j,style:b,onClick:m,children:(0,r.jsx)("span",{children:N})}),!n||n.length<1?null:(0,r.jsx)("ul",{className:i.Z.list,style:F,children:n.map((function(e,t){var n=t===s?"".concat(i.Z.active):"";return(0,r.jsx)("li",{className:i.Z.list,onClick:function(){return A(t)},children:(0,r.jsx)("button",{className:n,children:(0,r.jsx)("span",{children:e.text})})},t)}))})]})})}))},794848:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var c=n(601413),a=n(747313),l=n(180252),i=n(735622),r=n(827611),s=n(448439),o=n(870885),u=n(700936),_=n(837490),E=n(588567),d=n(632570),R=n(981142),T=n(634077),M=n(995124),x=n(59127),C=n(346417),h=30,N=47,O=[{category:E.Dtf.BR_SHEET_FORMAT_GENERAL,title:"HOME_NUMBER_FORMAT_GENERAL",guide:"IDS_RBN_HOME_NUMBER_FORMAT_GENERAL_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_NUMBER,title:"HOME_NUMBER_FORMAT_NUMBER",guide:"IDS_RBN_HOME_NUMBER_FORMAT_NUMBER_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_CURRENCY,title:"HOME_NUMBER_FORMAT_CURRENCY",guide:"IDS_RBN_HOME_NUMBER_FORMAT_CURRENCY_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_ACCOUNTING,title:"HOME_NUMBER_FORMAT_ACCOUNTING",guide:"IDS_RBN_HOME_NUMBER_FORMAT_ACCOUNTING_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_DATE,title:"HOME_NUMBER_FORMAT_DATE",guide:"IDS_RBN_HOME_NUMBER_FORMAT_DATE_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_TIME,title:"HOME_NUMBER_FORMAT_TIME",guide:"IDS_RBN_HOME_NUMBER_FORMAT_TIME_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_PERCENTAGE,title:"HOME_NUMBER_FORMAT_PERCENTAGE",guide:"IDS_RBN_HOME_NUMBER_FORMAT_PERCENTAGE_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_FRACTION,title:"HOME_NUMBER_FORMAT_FRACTION",guide:""},{category:E.Dtf.BR_SHEET_FORMAT_SCIENTIFIC,title:"HOME_NUMBER_FORMAT_SCIENTIFIC",guide:""},{category:E.Dtf.BR_SHEET_FORMAT_TEXT,title:"HOME_NUMBER_FORMAT_TEXT",guide:"IDS_RBN_HOME_NUMBER_FORMAT_TEXT_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_ETC,title:"HOME_NUMBER_FORMAT_ETC",guide:"IDS_RBN_HOME_NUMBER_FORMAT_ETC_GUIDE"},{category:E.Dtf.BR_SHEET_FORMAT_USERCUSTOM,title:"HOME_NUMBER_FORMAT_MORE",guide:"IDS_RBN_HOME_NUMBER_FORMAT_MORE_GUIDE"}];function m(e){var t=e.command,n=e.scrollTop,l=(0,a.useMemo)((function(){return t.getCellFormatInfo()}),[t]),r=(0,a.useState)(t.getCellFormatMode()===d.k.ACCOUNTING?O[E.Dtf.BR_SHEET_FORMAT_ACCOUNTING]:O[l.wFormat]),s=(0,o.Z)(r,2),m=s[0],f=s[1],A=(0,a.useState)(l.bSeparate>0),g=(0,o.Z)(A,2),p=g[0],j=g[1],b=(0,a.useState)(l.wDecimalPlaces),D=(0,o.Z)(b,2),F=D[0],S=D[1],B=(0,a.useState)(l.wNegative),I=(0,o.Z)(B,2),Z=I[0],y=I[1],U=(0,a.useState)(l.wDate),v=(0,o.Z)(U,2),k=v[0],L=v[1],H=(0,a.useState)(l.wTime),G=(0,o.Z)(H,2),w=G[0],P=G[1],Y=(0,a.useState)(l.wFraction),W=(0,o.Z)(Y,2),V=W[0],K=W[1],X=(0,a.useState)(l.wEtc),z=(0,o.Z)(X,2),J=z[0],q=z[1],Q=(0,a.useState)(l.wUserCustom),$=(0,o.Z)(Q,2),ee=$[0],te=$[1],ne=(0,a.useState)(t.getLocaleIndex(l.wLanguage)),ce=(0,o.Z)(ne,2),ae=ce[0],le=ce[1],ie=(0,a.useState)(l.wFormat===E.Dtf.BR_SHEET_FORMAT_ACCOUNTING?t.getCurrencyIndex(l.wAccounting):t.getCurrencyIndex(l.wCurrency)),re=(0,o.Z)(ie,2),se=re[0],oe=re[1],ue=(0,a.useState)(t.getCalendarIndex(l.wLanguage,l.wDateTerm)),_e=(0,o.Z)(ue,2),Ee=_e[0],de=_e[1],Re=(0,u.Z)().formatMessage,Te=(0,a.useMemo)((function(){return t.getCurrencyList()}),[t]),Me=(0,a.useMemo)((function(){return t.getLocaleList()}),[t]),xe=(0,a.useMemo)((function(){return t.getFractionList()}),[t]),Ce=(0,a.useMemo)((function(){return t.getEtcList()}),[t]),he={decimal:!1,currency:!1,decimal_check:!1,minus:!1,type:!1,locale:!1,calendar:!1,delBtnDisabled:!0},Ne=(0,a.useMemo)((function(){var e="";if(e=m&&m.category===E.Dtf.BR_SHEET_FORMAT_NUMBER?p?"1,234":"1234":"1,234",F>0){e+=".";for(var n=F;n>0;n-=1)e+=(n-1)%10}if(m&&m.category===E.Dtf.BR_SHEET_FORMAT_CURRENCY){var c=Te[se].currency;e=t.isRightIndication(c)?"".concat(e," ").concat(Te[se].text2):t.isNeedWhiteSpaceAtMidCurrency(c)?"".concat(Te[se].text2," ").concat(e):"".concat(Te[se].text2).concat(e)}return["(".concat(e,")"),"(".concat(e,")"),e,"-".concat(e),"-".concat(e)]}),[p,t,Te,se,m,F]),Oe=(0,a.useMemo)((function(){var e=Me[ae].locale,n=t.getCalendarValue(e,Ee);return t.getDateList(e,n)}),[Ee,t,Me,ae]),me=(0,a.useMemo)((function(){return t.getTimeList(Me[ae].locale)}),[t,Me,ae]),fe=(0,a.useMemo)((function(){return ee<0?[]:t.getCustomList()}),[t,ee]),Ae=(0,a.useState)(fe[l.wUserCustom]),ge=(0,o.Z)(Ae,2),pe=ge[0],je=ge[1],be=(0,a.useMemo)((function(){var e=Te[se].currency,n=m?m.category:void 0,c=Me[ae].locale,a=t.getCalendarValue(c,Ee);return t.getNumberFormatPreview(n,F,p,Z,e,k,c,a,w,V,J,ee,pe)}),[Ee,p,t,Te,se,m,ee,pe,k,F,J,V,Me,ae,Z,w]),De=(0,a.useCallback)((function(e){f(O[e])}),[]),Fe=(0,a.useCallback)((function(e){var t=F;e?t+=1:t-=1,t>h||t<0||S(t)}),[F]),Se=(0,a.useCallback)((function(e){var t=e.currentTarget.checked;j(t)}),[]),Be=(0,a.useCallback)((function(e){e!==Z&&y(e)}),[Z]),Ie=(0,a.useCallback)((function(e){switch(m.category){case E.Dtf.BR_SHEET_FORMAT_DATE:L(e);break;case E.Dtf.BR_SHEET_FORMAT_TIME:P(e);break;case E.Dtf.BR_SHEET_FORMAT_FRACTION:K(e);break;case E.Dtf.BR_SHEET_FORMAT_ETC:q(e);break;case E.Dtf.BR_SHEET_FORMAT_USERCUSTOM:te(e),je(fe[e])}}),[m,fe]),Ze=(0,a.useCallback)((function(e){e!==se&&oe(e)}),[se]),ye=(0,a.useCallback)((function(e){e!==ae&&le(e)}),[ae]),Ue=(0,a.useCallback)((function(e){e!==Ee&&de(e)}),[Ee]),ve=(0,a.useCallback)((function(e){var t=e.currentTarget.value;je(t)}),[]),ke=(0,a.useCallback)((function(){t.deleteCustomFormatCode(ee),te(0),je(fe[0])}),[t,fe,ee]),Le=[],He=0;switch(m&&m.category){case E.Dtf.BR_SHEET_FORMAT_NUMBER:he.decimal=!0,he.decimal_check=!0,he.minus=!0;break;case E.Dtf.BR_SHEET_FORMAT_CURRENCY:he.decimal=!0,he.currency=!0,he.minus=!0;break;case E.Dtf.BR_SHEET_FORMAT_ACCOUNTING:he.decimal=!0,he.currency=!0;break;case E.Dtf.BR_SHEET_FORMAT_DATE:he.type=!0,he.locale=!0,Me[ae].locale!==E.IlM.BR_LOCALE_KOREAN&&Me[ae].locale!==E.IlM.BR_LOCALE_JAPANESE||(he.calendar=!0),Le=Oe,He=k;break;case E.Dtf.BR_SHEET_FORMAT_TIME:he.type=!0,he.locale=!0,Le=me,He=w;break;case E.Dtf.BR_SHEET_FORMAT_PERCENTAGE:he.decimal=!0;break;case E.Dtf.BR_SHEET_FORMAT_FRACTION:he.type=!0,Le=xe.map((function(e){return Re({id:e})})),He=V;break;case E.Dtf.BR_SHEET_FORMAT_SCIENTIFIC:he.decimal=!0;break;case E.Dtf.BR_SHEET_FORMAT_ETC:he.type=!0,he.locale=!0,Le=Ce[ae].map((function(e){return Re({id:e})})),He=J;break;case E.Dtf.BR_SHEET_FORMAT_USERCUSTOM:he.type=!0,Le=fe,He=ee,R.o.getDocType()!==E.VrN.eDOCTYPE_XLS&&(he.delBtnDisabled=!(ee>N)||pe.length<=0);break;default:Le=[]}var Ge=(0,a.useMemo)((function(){var e=Te.map((function(e){return{text:e.currency===E.nh4.BR_SHEET_CURRENCY_LOCALE?e.text1:Re({id:e.text1})}}));return{currentIndex:se,list:e,onClickItem:Ze,inputWidth:270,scrollTop:n}}),[Te,se,Re,n,Ze]),we=(0,a.useMemo)((function(){var e=Me.map((function(e){return{text:Re({id:e.text})}}));return{currentIndex:ae,list:e,onClickItem:ye,inputWidth:380,scrollTop:n}}),[Re,Me,ae,n,ye]),Pe=(0,a.useMemo)((function(){var e=[];return Me[ae].locale===E.IlM.BR_LOCALE_KOREAN?(e.push({text:Re({id:"HOME_NUMBER_FORMAT_CALENDAR_AD"})}),e.push({text:Re({id:"HOME_NUMBER_FORMAT_CALENDAR_BC"})})):(e.push({text:Re({id:"HOME_NUMBER_FORMAT_CALENDAR_GREGORIAN"})}),e.push({text:Re({id:"HOME_NUMBER_FORMAT_CALENDAR_JAPANESE"})})),{currentIndex:Ee,list:e,onClickItem:Ue,inputWidth:270,scrollTop:n}}),[Ee,Re,Me,ae,n,Ue]),Ye=(0,a.useRef)(null);(0,a.useEffect)((function(){var e=Ye.current;e&&(e.value=F.toString())}),[F]);var We=(0,a.useCallback)((function(){var e=Ye.current;if(e){var t=parseInt(e.value);!isNaN(t)&&t<=30&&t>=0?S(t):i.Z.showDialog({dialogId:M.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OUT_OF_RANGE",values:{arg1:"".concat(0),arg2:"".concat(h)}},currentTabIndex:0})}}),[S]),Ve=(0,a.useCallback)((function(e){e.keyCode===x.S.Enter&&We(),e.keyCode===x.S.Escape&&e.currentTarget.blur()}),[We]),Ke=(0,a.useCallback)((function(e){We()}),[We]);return(0,C.jsx)(a.Fragment,{children:(0,C.jsxs)("div",{className:_.Z.popup_contents,children:[(0,C.jsxs)("div",{className:"".concat(_.Z.flex_box," ").concat(_.Z.col),children:[(0,C.jsxs)("div",{className:_.Z.inner_box,style:{width:"160px"},children:[(0,C.jsx)("p",{className:_.Z.info_txt,children:Re({id:"DLG_CELL_FORMAT_CATEGORY"})}),(0,C.jsx)("div",{className:_.Z.list_box,style:{height:"368px"},children:(0,C.jsx)("ul",{children:O.map((function(e,t){var n,c=e.category,a=e.title;return m&&m.category===c&&(n="".concat(_.Z.active)),(0,C.jsx)("li",{children:(0,C.jsx)("button",{onClick:function(){return De(t)},className:n,children:Re({id:a})})},t)}))})})]}),(0,C.jsxs)("div",{className:"".concat(_.Z.inner_box),children:[(0,C.jsx)("p",{className:_.Z.info_txt,children:Re({id:"DLG_CELL_FORMAT_SAMPLE"})}),(0,C.jsx)("div",{className:_.Z.preview_txt,children:(0,C.jsx)("input",{type:"text",value:be,style:{cursor:"unset"},readOnly:!0})}),he.decimal||he.currency?(0,C.jsxs)("table",{className:"".concat(_.Z.form_table," ").concat(_.Z.mt5),children:[(0,C.jsxs)("colgroup",{children:[(0,C.jsx)("col",{style:{width:"110px"}}),(0,C.jsx)("col",{style:{width:"auto"}})]}),(0,C.jsxs)("tbody",{children:[he.decimal?(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_DECIMAL"})}),(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:"".concat(_.Z.spinner_select," ").concat(_.Z.medium," ").concat(_.Z.horizontal),children:(0,C.jsxs)("div",{className:_.Z.i_txt,children:[(0,C.jsx)("input",{type:"text",value:F,style:{width:"114px"},ref:Ye,maxLength:2,onKeyDown:Ve,onBlur:Ke,readOnly:!0}),(0,C.jsx)("button",{className:"".concat(_.Z.toggle," ").concat(_.Z.up),onClick:function(){return Fe(!0)},children:(0,C.jsx)("span",{children:"+"})}),(0,C.jsx)("button",{className:"".concat(_.Z.toggle," ").concat(_.Z.down),onClick:function(){return Fe(!1)},children:(0,C.jsx)("span",{children:"-"})})]})})})]}):null,he.currency?(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_CURRENCY"})}),(0,C.jsx)("td",{children:Ge?(0,C.jsx)(T.r,(0,c.Z)({},Ge)):null})]}):null]})]}):null,he.decimal_check?(0,C.jsx)("div",{className:_.Z.mt5,children:(0,C.jsxs)("label",{className:_.Z.chk_label,children:[(0,C.jsx)("input",{type:"checkbox",checked:p,onChange:Se}),(0,C.jsx)("span",{children:Re({id:"DLG_CELL_FORMAT_DECIMAL_CHECK"})})]})}):null,he.minus||he.type||he.locale||he.calendar?(0,C.jsxs)("table",{className:"".concat(_.Z.form_table," ").concat(_.Z.mt5),children:[(0,C.jsx)("colgroup",{children:(0,C.jsx)("col",{style:{width:"auto"}})}),(0,C.jsxs)("tbody",{children:[he.minus?(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_MINUS"})})}),(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:_.Z.list_box,style:{height:"150px"},children:(0,C.jsx)("ul",{children:Ne.map((function(e,t){var n=t%2===0?_.Z.point_red_color:"";return n+=t===Z?" ".concat(_.Z.active):"",(0,C.jsx)("li",{onClick:function(){return Be(t)},children:(0,C.jsx)("button",{className:n,children:e})},t)}))})})})})]}):null,he.type?(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_TYPE"})})}),(0,C.jsx)("tr",{children:(0,C.jsxs)("td",{children:[m&&m.category===E.Dtf.BR_SHEET_FORMAT_USERCUSTOM?(0,C.jsx)("div",{className:_.Z.i_txt,children:(0,C.jsx)("input",{type:"text",value:pe,onChange:ve})}):null,(0,C.jsx)("div",{className:"".concat(_.Z.list_box," ").concat(_.Z.mt10),style:{height:"140px"},children:(0,C.jsx)("ul",{children:Le.map((function(e,t){var n=t===He?" ".concat(_.Z.active):"";return(0,C.jsx)("li",{onClick:function(){return Ie(t)},children:(0,C.jsx)("button",{className:n,children:e})},t)}))})})]})})]}):null,he.locale?(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_LOCALE"})})}),(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:we?(0,C.jsx)(T.r,(0,c.Z)({},we)):null})})]}):null,he.calendar?(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:Re({id:"DLG_CELL_FORMAT_CALENDAR"})})}),(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:Pe?(0,C.jsx)(T.r,(0,c.Z)({},Pe)):null})})]}):null]})]}):null,m&&m.category===E.Dtf.BR_SHEET_FORMAT_USERCUSTOM?(0,C.jsx)("div",{className:_.Z.popup_btn_wrap,children:(0,C.jsx)("button",{className:"".concat(_.Z.p_btn02," ").concat(_.Z.normal),onClick:ke,disabled:he.delBtnDisabled,children:(0,C.jsx)("span",{children:Re({id:"DELETE"})})})}):null]})]}),(0,C.jsx)("p",{className:_.Z.info_txt,style:{height:"50px"},children:m&&m.guide?Re({id:m.guide}):null})]})})}var f=n(407604);function A(e){var t=e.dialogId,n=e.tabs,o=e.commandName,u=e.dialogIndex,_=n[0].buttons,E=s.Z.getCommandInstance(o),R=(0,l.v9)((0,f.R1)(u)).scrollTop,T={buttonLabels:_,onClick:(0,a.useCallback)((function(e){0===e&&E.invoke(),E&&E instanceof d.Z&&E.init(),i.Z.hideDialog(t)}),[E,t])};return E&&E instanceof d.Z?(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)(m,{command:E,scrollTop:R||0}),(0,C.jsx)(r.Z,(0,c.Z)({},T))]}):null}}}]);