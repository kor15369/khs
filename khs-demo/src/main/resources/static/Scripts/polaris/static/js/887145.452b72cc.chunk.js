"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[887145,463779],{827611:function(e,t,n){n.d(t,{Z:function(){return u}});n(747313);var a=n(837490),r=n(307360),i=n(346417);function u(e){var t=e.buttonLabels,n=e.onClick,u=e.buttonDisableStates;return(0,i.jsx)("div",{className:a.Z.popup_btn_wrap,children:t.map((function(e,t){var l=!!u&&u[t];return(0,i.jsx)("button",{className:"".concat(a.Z.p_btn," ").concat(a.Z.normal),onClick:function(){return n(t)},disabled:l,children:(0,i.jsx)(r.Z,{label:e})},t)}))})}},887145:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var a=n(601413),r=n(870885),i=n(747313),u=n(837490),l=n(827611),c=n(735622),o=n(180252),s=n(930581),h=n(995124),d=n(416031),f=n(981142),m=n(791406),p=n(977917),b=n(346417);function x(e){var t=(0,o.I0)(),n=e.onClickThumbnail,a=(0,o.v9)(s.zq).thumbnailItems,l=(0,i.useState)(void 0),c=(0,r.Z)(l,2),h=c[0],d=c[1],f=(0,i.useCallback)((function(e,t){d(e),n(t)}),[n]),m=(0,i.useCallback)((function(e){var n=e.nativeEvent.srcElement,a=n.offsetHeight;n.scrollTop+a===n.scrollHeight&&t((0,s.ZX)())}),[t]);return(0,b.jsx)("div",{className:u.Z.img_list,onScroll:m,children:a&&a.map((function(e,t){return(0,b.jsx)("div",{className:u.Z.item,onClick:function(){return f(t,e)},children:(0,b.jsxs)("div",{className:"".concat(u.Z.online_video_item),children:[(0,b.jsx)("img",{src:e.defaultThumbnailUrl,alt:""}),h===t?(0,b.jsx)("label",{className:"".concat(u.Z.chk_label),children:(0,b.jsx)("input",{type:"checkbox",checked:!0,readOnly:!0})}):""]})},t)}))})}function v(e){var t=e.dialogId,n=e.tabs[0].buttons,r=(0,o.I0)(),v=(0,i.useRef)(null),g=(0,i.useRef)(null),w=(0,i.useRef)(null),y=(0,i.useRef)(null),Z=(0,i.useRef)(null),A=(0,i.useRef)(null),T=(0,i.useRef)(null),j=(0,o.v9)(s.zq).searchText;(0,i.useEffect)((function(){return r((0,s.ZX)()),function(){r((0,s.lp)())}}),[r]);var k=(0,i.useCallback)((function(e){if("Enter"===e.key){var t=v.current&&v.current.value;if((0,d.isEmpty)(t))return void c.Z.showDialog({dialogId:h.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_EMPTY_INPUT"},currentTabIndex:0});r((0,s.FD)(t||"")),r((0,s.Kb)()),r((0,s.ZX)())}}),[r]),I=(0,i.useCallback)((function(){var e,t=y.current&&y.current.textContent||"";null===(e=window.open(t,"from Polaris Web Office".concat(Math.floor(100*Math.random()))))||void 0===e||e.focus()}),[]),C=(0,i.useCallback)((function(e){var t=e.title,n=e.channelTitle,a=e.videoId,r=e.highThumbnailUrl,i=e.highThumbnailWidth,u=e.highThumbnailHeight,l=g.current,c=w.current,o=y.current,s=Z.current,h=A.current,d=T.current;l&&c&&o&&s&&h&&d&&(l.textContent=t,c.textContent=n,o.textContent="".concat(m.Tg).concat(a),s.src=r,s.width=i,s.height=u,h.textContent="".concat(m.iv,"/").concat(a),d.textContent=a)}),[]),M=(0,i.useCallback)((function(e){if(n.length-1===e)return c.Z.clickButton(t,e),void c.Z.hideDialog(t);var a=Z.current,i=A.current,u=T.current,l=g.current,o=w.current;if(a&&i&&u&&l&&o){var d=l.textContent||"";(0,m.LS)(d,a.width,a.height).then((function(e){var n=i.textContent||"";f.o.mediaInsert(e,a.width,a.height,!1,n,!1,!1),r((0,s.lp)()),c.Z.hideDialog(t),c.Z.hideDialog(h.O.SLIDE_INSERT_VIDEO)})).catch((function(e){p.ZP.error("createYoutubeThumbnailImage error = ".concat(e))}))}}),[n.length,t,r]),S={buttonLabels:n,onClick:M};return(0,b.jsxs)(i.Fragment,{children:[(0,b.jsxs)("div",{className:u.Z.popup_contents,children:[(0,b.jsxs)("table",{className:u.Z.form_table,children:[(0,b.jsxs)("colgroup",{children:[(0,b.jsx)("col",{style:{width:"120px"}}),(0,b.jsx)("col",{style:{width:"auto"}})]}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:u.Z.fs13,children:(0,b.jsx)("span",{className:u.Z.logo_youtube,children:"YouTube"})}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"text",className:u.Z.f_txt,defaultValue:j,ref:v,onKeyDown:k})})]})})]}),(0,b.jsx)(x,{onClickThumbnail:C}),(0,b.jsxs)("div",{style:{display:"none"},children:[(0,b.jsx)("img",{ref:Z,alt:""}),(0,b.jsx)("span",{ref:A}),(0,b.jsx)("span",{ref:T})]}),(0,b.jsx)("div",{className:u.Z.txt_cont,children:(0,b.jsx)("span",{ref:g})}),(0,b.jsxs)("div",{className:"".concat(u.Z.txt_cont," ").concat(u.Z.link),onClick:I,children:[(0,b.jsx)("span",{ref:w}),(0,b.jsx)("span",{ref:y,style:{display:"none"}})]})]}),(0,b.jsx)(l.Z,(0,a.Z)({},S))]})}},791406:function(e,t,n){n.d(t,{$Q:function(){return x},LS:function(){return v},Tg:function(){return p},iv:function(){return b}});var a=n(974165),r=n(115861),i=n(231881),u=n.n(i),l=n(977917),c=n(416031),o=n(815e3),s=n(53110),h=n(735622),d=n(995124),f=n(442113),m=n(463779),p="https://www.youtube.com/watch?v=",b="https://www.youtube.com/embed",x=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=new URLSearchParams).append("q",t),r.append("part","snippet"),r.append("maxResults","50"),r.append("type","video"),r.append("key",o.ZP.get("youtubeSearchAPIKey")||""),(0,c.isEmpty)(n)||r.append("pageToken",n),e.next=10,u().get("https://www.googleapis.com/youtube/v3/search",{params:r});case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(0),l.ZP.error("requestYoutubeVideo error = ".concat(e.t0)),i=f.localeIntl.formatMessage,s="".concat(i({id:"DLG_VIDEO_ERROR_MSG"}),"\n").concat(e.t0.response.data.error.message),h.Z.showDialog({dialogId:d.O.COMMON_ALERT,bModal:!0,alertMsg:{label:s}}),e.abrupt("return","");case 20:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n,i){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(r,u){var l,c,o,h,d,f,p,b,x,v,g,w,y;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(l=document.createElement("canvas")).width=n,l.height=i,c=l.getContext("2d")){e.next=7;break}return e.abrupt("return");case 7:return c.fillStyle="black",c.fillRect(0,0,n,i),e.next=11,(0,s.po)("".concat(m));case 11:for(o=e.sent,h=o.width,d=o.height,c.drawImage(o,n/2-h/2,i/2-d/2,h,d),0,f=12,12,p=(t||"").split(" "),b="",c.fillStyle="white",c.font="12px Noto Sans KR",x=0;x<p.length;x+=1)v="".concat(b+p[x]," "),g=c.measureText(v),g.width>n&&x>0?(c.fillText(b,0,f),b="".concat(p[x]," "),f+=12):b=v;return c.fillText(b,0,f),e.next=27,(0,s.G)(l);case 27:return w=e.sent,e.next=30,(0,s.Cq)(w);case 30:y=e.sent,r(y),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(0),u(e.t0);case 37:case"end":return e.stop()}}),e,null,[[0,34]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},930581:function(e,t,n){n.d(t,{FD:function(){return h},Kb:function(){return f},ZX:function(){return b},lp:function(){return m},zq:function(){return p}});var a=n(426373),r=n(135323),i=n(625477),u=n(416031),l=n(791406),c={searchText:"",selectedIndex:void 0,nextPageToken:"",thumbnailItems:[]},o=(0,a.oM)({name:"onlineVideoThumbnail",initialState:c,reducers:{setSearchText:function(e,t){e.searchText=t.payload},setThumbnailItems:function(e,t){var n=t.payload,a=n.nextPageToken,r=n.thumbnailItems;e.nextPageToken=a,r.forEach((function(t){e.thumbnailItems.push(t)}))},clearSearchedItems:function(e){e.nextPageToken="",e.selectedIndex=0,e.thumbnailItems=[]},clearOnlineVideoThumbnail:function(){return c}}}),s=o.actions,h=s.setSearchText,d=s.setThumbnailItems,f=s.clearSearchedItems,m=s.clearOnlineVideoThumbnail;t.ZP=o.reducer;var p=(0,r.P1)((function(e){return e.onlineVideoThumbnail}),(function(e){return e})),b=function(){return(0,i.RU)("requestYoutubeVideoThunk",(function(e){var t=(0,i.qm)(p),n=t.searchText,a=t.nextPageToken;(0,l.$Q)(n,a).then((function(t){if(t){var n=[];t.data.items.forEach((function(e){var t=e.snippet;n.push({title:t.title,channelTitle:t.channelTitle,videoId:e.id.videoId,defaultThumbnailUrl:t.thumbnails.default?t.thumbnails.default.url:"",defaultThumbnailWidth:t.thumbnails.default?t.thumbnails.default.width:120,defaultThumbnailHeight:t.thumbnails.default?t.thumbnails.default.height:90,highThumbnailUrl:t.thumbnails.high?t.thumbnails.high.url:"",highThumbnailWidth:t.thumbnails.high?t.thumbnails.high.width:480,highThumbnailHeight:t.thumbnails.high?t.thumbnails.high.height:360})})),e(d({nextPageToken:(0,u.isEmpty)(t.data.nextPageToken)?"":t.data.nextPageToken,thumbnailItems:n}))}}))}))}},463779:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAByCAMAAAC4A3VPAAAAxlBMVEUvLy8AAABAQEAvLy8vLy8xMTEvLy8wMDAwMDA2NjY6OjovLy9JSUkwMDAvLy8wMDAvLy8wMDAvLy8uLi4wMDAvLy8vLy8vLy8wMDAvLy8wMDAwMDAwMDAvLy8vLy8wMDAwMDAwMDAwMDAuLi41NTUuLi7Y2Ng6OjrS0tLBwcGTk5N+fn5eXl42NjbOzs6srKx4eHgxMTHZ2dm8vLypqakyMjLIyMi0tLSDg4NxcXFmZmZTU1M/Pz8vLy+hoaGOjo6Kiorc3NyOsBvnAAAAQXRSTlPmAATJsx26gEcTC+Lp4d/W1dHPy8a/vqqmo4uGdXFoZlVLRTciIf7n/fv08ezn/PfwXv769yn7+fHv7evoXfbz8t5Wy84AAAMVSURBVGje1ZsHVttAFEUfM6NqXHDv3YbgGDAJBBIg0f43FVGCIBhLX39GiLuBe47e0Wh+EfZIiPl02G2rpqwUixXZVO3ucDoXeyQISm/SaxSwhUKjN/H0K2eOjZ3YzkynctGXSIDsL/QoxVghMWos2EpxK0FC3gqW0h9VQaY68tMr3RpSUXNTKq0OUtOxUijFoAQGpYGgKi0FJsqiKd0y2JRdglI40IIjkir9FjTR8pMpPRvasL0kSqsOjdSteOXFAbRycBGntEKjZqe1W+nVoZ26t0vp2zCA7b+vFC0YoSXeVTowhPOe0oUx3O1KqwxjlK1tSqFgECW2KAcwyuCt0irBKCXrjbIDw3T+V7owjvta6ddgnJr/SjlCBoxeKkUVGVAVL5QbZMImUgqJeNar1SF4SPGsHCMBp0FwtCqAxfhZqZCA8yDky09wUP+UCyQheOR0HwwWT8o+RRmcHzMi7T8pJUl5HynSIh+VMxCVYaRfkZLZg9IhKZmROg9Km6RkRmrfKz3QlFGkZ0iBFyonNCU30kmo7NGVEd/JkfZCZYOjDJbUSBt7EAWOMuSEFmlBYA6akh3pHFOikh3pFEOikh3pEF2ikh1pF22mMuJbskjbUEQlO1KFJl8Zsfy9RhxNSKKSHalERa8yjDTm6VZQ1KwMndhJ0YDyMk5Z0a68jnuwUrPyxy/sRmp8SRJerZsaj4KEBYSiHnj8o71NPdb5H7Au6ePFP9NDhno+0SfXlE/0nK9c/lmTLiKiwFXe3dCuW4xLZfTqU2hwr86X5Kq6xysQjlZrUJlwyqDz4xvQ8YjFHr/CtKklLb+OdtIW7idnnMKd3p6I7nF0ZKomTHC3z2/CLCjK8NVnsCA11JZByOU1OCh62/BqDRZjWnP08Orqht0czbwFfPsRje7s2/nZDy2yH818/AAqgzFbHoaJxkem+RgMmx1/52fIb3CVIU8LG6bWUvK2fGNixSiPi1S618XyuhSnc/UvzwuOmtY487+syl7J/SyLx9muV0eIjQQJuRGfb1We+EPAZ/7twfDPHeZ/YfkLpBE+dIx46wMAAAAASUVORK5CYII="}}]);