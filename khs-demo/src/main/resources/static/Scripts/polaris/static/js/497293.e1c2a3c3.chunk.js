"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[497293],{782345:function(e,t,n){n.d(t,{U:function(){return b},j:function(){return i}});var i,r=n(974165),a=n(115861),o=n(215671),u=n(143144),s=n(625477),l=n(500811),h=n(628264),C=n(652928),c=n(735622),d=n(995124),M=n(769071),p=n(981142),w=n(588567),S=n(416031),f=n(815e3),g=n(53110);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(i||(i={}));var x=/<!--\[if gte vml 1\]>/g,U=/<!\[endif\]-->/g,v=/<!--\[PO\]\[if gte vml 1\]>/g,m=/<!\[endif\]\[PO\]-->/g,b=function(){function e(){(0,o.Z)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return(0,u.Z)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,(0,s.Ce)((0,l.vQ)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,(0,s.Ce)((0,l.$A)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===d.O.COMMON_CLIPBOARD?c.Z.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):c.Z.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return(0,s.qm)(h.p_).viewMode===C.wO.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,p.o.editDocument(w.OjI.BR_EDITMODE_COPY,w.vlz.CLIPDATA_FAVORITE_DATA,null,i.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,p.o.editDocument(w.OjI.BR_EDITMODE_CUT,w.vlz.CLIPDATA_STR,null,i.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.OjI.BR_EDITMODE_PASTE,t=f.ZP.get("preventPasteFromExternal");this.isNativeMode||t?p.o.editDocument(e,w.vlz.CLIPDATA_STR,null,i.NATIVE_CLIPBOARD):this.showAlert(d.O.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){p.o.editDocument(w.OjI.BR_EDITMODE_ORIGINAL_FORMAT,t,t===w.vlz.CLIPDATA_HTML?this.excludeImgElements(e):e,i.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=function(){var t=e[0];if(t){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,i=t.width,o=t.height;i>e||o>n;)i>e?(o*=e/i,i=e):o>n&&(i*=n/o,o=n);var u=document.createElement("canvas");u.width=i,u.height=o;var s=u.getContext("2d");s&&(s.drawImage(t,0,0,i,o),u.toBlob(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,(0,g.Cq)(t);case 3:(n=e.sent)instanceof ArrayBuffer&&p.o.imageInsert(n,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(t)}},n=0;n<e.length;n+=1)t()}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),i=!(0,S.isEmpty)(n),r=!(0,S.isEmpty)(t),a=i&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),o=e.files&&e.files.length>0,u=f.ZP.get("preventPasteFromExternal");a||u?this.nativePaste():o&&!r?this.appendClipboardImage(e.files):i&&this.htmlDataTagCount(n)>0?this.externalPaste(n,w.vlz.CLIPDATA_HTML):r&&this.externalPaste(t,w.vlz.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var i=n.getElementsByTagName(t).length;return n.remove(),i}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===w.vlz.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var i=document.createRange();i.selectNodeContents(n);var r=window.getSelection();if(r){var a,o,u=[];if(r.rangeCount>0)for(var s=0;s<r.rangeCount;s+=1){var l=r.getRangeAt(s);u.push(l)}if(r.removeAllRanges(),r.addRange(i),document.execCommand("copy"),r.removeAllRanges(),u&&u.length>0)for(var h=0;h<u.length;h+=1)r.addRange(u[h]);var C=null===(a=M.Z.getForcusRef("DocInputField"))||void 0===a||null===(o=a.elementRef)||void 0===o?void 0:o.current;C&&C instanceof HTMLInputElement&&C.select()}}n.remove(),M.Z.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(x,"").replace(U,"");for(var n=t.getElementsByTagName("img"),i=0;i<n.length;i+=1){var r=n[i].getAttribute("v:shapes");if(!(0,S.isEmpty)(r)){var a=t.querySelector('[id="'.concat(r,'"]'));if(!a||!a.tagName||!a.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(x,"\x3c!--[PO][if gte vml 1]>")).replace(U,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!v.test(e)||!m.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(v,"").replace(m,"");var n=document.createElement("div");n.innerHTML=e.replace(v,"\x3c!--[if gte vml 1]>").replace(m,"<![endif]--\x3e");for(var i=n.getElementsByTagName("img"),r=i.length-1;r>=0;r-=1){var a=i[r],o=a.getAttribute("v:shapes");if(!(0,S.isEmpty)(o)){var u=t.querySelector('[id="'.concat(o,'"]'));u&&u.tagName&&u.tagName.toLowerCase().startsWith("v:")&&a.remove()}}return n.innerHTML}}]),e}()},438481:function(e,t,n){var i=n(215671),r=n(143144),a=n(179340),o=n(432269),u=n(782345),s=n(981142),l=n(588567),h=n(625477),C=n(229860),c=n(305054),d=n(530624),M=n(46531),p=n(815e3),w=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"clone",value:function(){s.o.editDocument(l.OjI.BR_EDITMODE_CLONE,0,null,u.j.NATIVE_CLIPBOARD)}},{key:"copyFormat",value:function(e){this.isCopyFormatMode?this.copyFormatMode(!1):(this.copyFormatMode(!0,e),s.o.setFormCopyPaste(l.YMl.eFCP_COPY))}},{key:"copyFormatMode",value:function(e,t){this.setCopyFormatMode(e)&&(this.isCopyFormatMode?((0,h.Ce)((0,M.FV)(t?1:0)),(0,h.Ce)((0,C.kA)(t?l.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_MULTI:l.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_ONE)),(0,h.Ce)((0,C.ve)(!0))):((0,h.Ce)((0,M.FV)(-1)),(0,h.Ce)((0,C.kA)(l.mel.BR_MOUSE_HOVERING_NONE,!0))))}},{key:"formatPaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c.Z.getObjectControlType()===d.uq.eObjCtrEmpty?this.copyFormatMode(!1):(s.o.formatPaste(!1),0===(0,h.qm)(M.Gu).currentIndex&&this.copyFormatMode(!1),e&&this.copyFormatMode(!1))}},{key:"onClipboardResult",value:function(e,t,n,i){if(e===l.RUN.COPY_EVENT||e===l.RUN.CUT_EVENT||e===l.RUN.SLIDE_COPY_EVENT||e===l.RUN.SLIDE_CUT_EVENT){if(this.setNativeMode(!0),p.ZP.get("preventCopyToExternal"))return;var r="",a=l.vlz.CLIPDATA_STR;if(""!==n&&(r=n),""!==i&&(r=i,a=l.vlz.CLIPDATA_HTML),c.Z.getObjectControlType()!==d.uq.eObjCtrTemplate&&c.Z.getObjectControlType()!==d.uq.eObjCtrLine&&c.Z.getObjectControlType()!==d.uq.eObjCtrImage&&c.Z.getObjectControlType()!==d.uq.eObjCtrChart&&c.Z.getObjectControlType()!==d.uq.eObjCtrVideo&&c.Z.getObjectControlType()!==d.uq.eObjCtrInfraPen||(r="<span>".concat(r,"</span>"),a=l.vlz.CLIPDATA_HTML),this.clipboardDataTransfer){var o=this.createClipboardElement(r);this.clipboardDataTransfer.setData("text/html",o.innerHTML),n.length>0&&this.clipboardDataTransfer.setData("text/plain",n),this.clipboardDataTransfer=null,o.remove()}else this.copyToClipboard(r,a)}}}]),n}(u.U),S=new w;t.Z=S},497293:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var i=n(215671),r=n(143144),a=n(611752),o=n(661120),u=n(179340),s=n(432269),l=n(416031),h=n(171091),C=n(262112),c=[[C.w.ContextMenuClipboardCut,h.OUd],[C.w.ContextMenuClipboardCopy,h.$n9],[C.w.ContextMenuClipboardPaste,h.BR2],[C.w.ContextMenuInsertHyperlink,h.HXA],[C.w.ContextMenuSlideTableLayoutMergeCellMerge,h.VlG],[C.w.ContextMenuSlideTableLayoutMergeCellSplit,h.ldL],[C.w.ContextMenuSlideTableSelect,h.f$],[C.w.ContextMenuSlideTableLayoutRowColInsert,h.Zvt],[C.w.ContextMenuDeleteCol,h.WJr],[C.w.ContextMenuDeleteRow,h.E9c],[C.w.ContextMenuSlideReviewCommentsNewComment,h.Y0s],[C.w.ContextMenuSlideReviewCommentsDelete,h.fK$],[C.w.ContextMenuSlideCopySlide,h.kIE],[C.w.ContextMenuSlideInsertSlide,h.RfC],[C.w.ContextMenuSlideDuplicateSlide,h.d69],[C.w.ContextMenuSlideDeleteSlide,h.Krq],[C.w.ContextMenuSlideInsertLayout,h.voj],[C.w.ContextMenuSlideDesignCustomSlidesize,h.YDA],[C.w.ContextMenuParagraphBullet,h.X$H],[C.w.ContextMenuParagraphNumbering,h.a2R],[C.w.ContextMenuArrangeGroup,h.lmu],[C.w.ContextMenuArrangeGroupGroup,h.Hq8],[C.w.ContextMenuArrangeGroupRegroup,h.hNo],[C.w.ContextMenuArrangeGroupUngroup,h.O9$],[C.w.ContextMenuArrangeForward,h.MCV],[C.w.ContextMenuArrangeGroupFront,h.Zcj],[C.w.ContextMenuArrangeForwardForward,h.V18],[C.w.ContextMenuArrangeBackward,h.Bss],[C.w.ContextMenuArrangeBackwardBack,h.VTQ],[C.w.ContextMenuArrangeBackwardBackward,h.UEr],[C.w.ContextMenuShapeStyle,h.ctl],[C.w.ContextMenuShapeFillColor,h.KpP],[C.w.ContextMenuShapeOutline,h.xQ6],[C.w.ContextMenuShapeEffect,h.qJu],[C.w.ContextMenuPictureSizeCrop,h.K0R],[C.w.ContextMenuPictureStyle,h.y3T],[C.w.ContextMenuPictureBorder,h.Olt]],d=new Map;c.forEach((function(e){d.set(e[0],e[1])}));var M=d,p=n(530624),w=n(981142),S=n(305054),f=n(204094),g=n(438481),x=n(258528),U=n(588567),v=n(768895),m=n(625477),b=n(360008),y=n(371266),T=n(820371),P=n(877703),E=n(815e3),O=n(229860),D=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"getUnits",value:function(){return(0,a.Z)((0,o.Z)(n.prototype),"getUnits",this).call(this),this.units.length>0||(this.contextMenuType===x.b9.SlideThumbnailItem?this.createThumbnailMenu():this.contextMenuType===x.b9.SlideThumbnailEmpty?this.createThumbnailEmptyMenu():this.objCtrlType===p.uq.eObjCtrEmpty?this.createEmptyMenu():this.objCtrlType===p.uq.eObjCtrVideo&&this.createVideoMenu()),this.units}},{key:"isRibbonUnitDisabled",value:function(e){var t=M.get(e);return!(0,l.isNil)(t)&&b.Z.getEnableState(t)===y.Z6Y.eES_DISABLE}},{key:"insertUnit",value:function(e){var t=S.Z.getObjectControlType(),n=this.isRibbonUnitDisabled(e),i=!1;if(!n)switch(e){case C.w.ContextMenuClipboardPasteOptionFormulas:case C.w.ContextMenuClipboardPasteOptionTransepose:case C.w.ContextMenuClipboardPasteOptionValue:case C.w.ContextMenuClipboardPasteOptionFormatting:!1===g.Z.getNavtiveMode()&&(n=!0);break;case C.w.ContextMenuArrangeGroup:!1===S.Z.isEnableGroupByRibbon()&&(n=!0);break;case C.w.ContextMenuArrangeForward:case C.w.ContextMenuArrangeBackward:S.Z.isGroupChild()&&(n=!0),t!==p.uq.eObjCtrSmtArtChildShape&&t!==p.uq.eObjCtrSmtArtChildLine||(n=!0);break;case C.w.ContextMenuMemoDeleteComment:n=!0;break;case C.w.ContextMenuSlideDesignCustomSlidesize43:var r=w.o.getPaperInfo(U.K29.BR_PAPER_MENU_NONE);r.nPaperSize===U.Cbg.BR_PPT_PAPER_TYPE_43&&r.nPageDirection===U.X6O.BR_PAPER_LANDSCAPE&&(i=!0);break;case C.w.ContextMenuSlideDesignCustomSlidesize169:var a=w.o.getPaperInfo(U.K29.BR_PAPER_MENU_NONE);(a.nPaperSize===U.Cbg.BR_PPT_PAPER_TYPE_169&&a.nPageDirection===U.X6O.BR_PAPER_LANDSCAPE||a.nPaperSize===U.Cbg.BR_PPT_PAPER_TYPE_WIDE&&a.nPageDirection===U.X6O.BR_PAPER_LANDSCAPE)&&(i=!0);break;case C.w.ContextMenuSlideViewShowRuler:i=!!(0,m.qm)(v.zL).isChecked;break;case C.w.ContextMenuSlideSlideGuide:i=w.o.isShowSlideGuide();break;case C.w.ContextMenuSlideSmartGuide:i=w.o.getSmartGuides().bShow;break;case C.w.ContextMenuSlideGuideline:i=w.o.getGridGuides().bShow}this.units.push({unitId:e,isDisabled:n,isChecked:i})}},{key:"addClipboardMenus",value:function(){!0!==E.ZP.get("removeClipboardMenu")&&(this.isSupportCopyCut()&&(this.insertUnit(C.w.ContextMenuClipboardCut),this.insertUnit(C.w.ContextMenuClipboardCopy)),this.isSupportDeleteMenu()&&this.insertUnit(C.w.ContextMenuDeleteKeyInput),this.isSupportPaste()&&(this.insertUnit(C.w.ContextMenuClipboardPaste),this.isSupportPasteOption()&&this.insertUnit(C.w.ContextMenuClipboardPasteOption)))}},{key:"addHyperLinkMenus",value:function(){if(!0!==E.ZP.get("removeHyperlinkMenu")){var e=this.isRibbonUnitDisabled(C.w.ContextMenuInsertHyperlink),t=w.o.getHyperlinkInfo(0,0),n=t.nLinkType!==U.Cuw.EV_LINK_RUNTYPE_NO_EXIST;n||this.objCtrlType===p.uq.eObjCtrVideo||this.objCtrlType===p.uq.eObjCtrAudio||t.nRunType!==U.Cuw.EV_LINK_RUNTYPE_MOUSE_OVER&&t.nRunType!==U.Cuw.EV_LINK_RUNTYPE_MOUSE_BOTH||(n=!0),!e&&n?(this.insertUnit(C.w.ContextMenuEditHyperlink),this.insertUnit(C.w.ContextMenuOpenHyperlink),this.insertUnit(C.w.ContextMenuRemoveHyperlink)):this.insertUnit(C.w.ContextMenuInsertHyperlink)}}},{key:"isSupportOtherTheme",value:function(){switch(this.objCtrlType){case p.uq.eObjCtrLine:case p.uq.eObjCtrLineInlineText:case p.uq.eObjCtrFLine:case p.uq.eObjCtrFLineInlineText:case p.uq.eObjCtrFLineTextCaret:case p.uq.eObjCtrFLineTextSelect:case p.uq.eObjCtrInfraPen:case p.uq.eObjCtrInfraPenInlineText:case p.uq.eObjCtrChart:case p.uq.eObjCtrChartInlineText:case p.uq.eObjCtrChartTextCaret:case p.uq.eObjCtrChartTextSelect:return!1}return!0}},{key:"isCurrentPageHide",value:function(){var e,t=(0,m.qm)(T.$T).currentPage;return!(null===(e=(0,m.qm)(P.Tb).thumbnails[t])||void 0===e||!e.isHide)}},{key:"createCaretMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider)}},{key:"createShapeCaretMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuParagraphBullet),this.insertUnit(C.w.ContextMenuParagraphNumbering),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createShapeMenu",value:function(e){var t=!1;t=e?this.objCtrlType===p.uq.eObjCtrFLine||this.objCtrlType===p.uq.eObjCtrFLineInlineText:this.objCtrlType!==p.uq.eObjCtrPargraphStrip&&this.objCtrlType!==p.uq.eObjCtrPargraphStripInline,this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),t&&(this.insertUnit(C.w.ContextMenuTextEdit),this.insertUnit(C.w.ContextMenuDivider)),this.insertUnit(C.w.ContextMenuShapeStyle),e||this.insertUnit(C.w.ContextMenuShapeFillColor),this.insertUnit(C.w.ContextMenuShapeOutline),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createImageMenu",value:function(){S.Z.isActiveLinkObject()||(this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuPictureSizeCrop),this.insertUnit(C.w.ContextMenuPictureStyle),this.insertUnit(C.w.ContextMenuPictureBorder),this.insertUnit(C.w.ContextMenuShapeEffect),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus())}},{key:"createChartMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuChartTypeChange),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuShapeStyle),this.insertUnit(C.w.ContextMenuShapeFillColor),this.insertUnit(C.w.ContextMenuShapeOutline),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward)}},{key:"createGroupMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createMultiObjectMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createTableCaretMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuParagraphBullet),this.insertUnit(C.w.ContextMenuParagraphNumbering),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideTableLayoutMergeCellMerge),this.insertUnit(C.w.ContextMenuSlideTableLayoutMergeCellSplit),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideTableSelect)}},{key:"createTableTextSelectMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuParagraphBullet),this.insertUnit(C.w.ContextMenuParagraphNumbering),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createTableCellMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuParagraphBullet),this.insertUnit(C.w.ContextMenuParagraphNumbering),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideTableLayoutRowColInsert),this.insertUnit(C.w.ContextMenuDeleteCol),this.insertUnit(C.w.ContextMenuDeleteRow),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideTableLayoutMergeCellMerge),this.insertUnit(C.w.ContextMenuSlideTableLayoutMergeCellSplit),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideTableSelect)}},{key:"createTableMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuParagraphBullet),this.insertUnit(C.w.ContextMenuParagraphNumbering),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider)}},{key:"createMemoMenu",value:function(){this.insertUnit(C.w.ContextMenuSlideMemoTextCopy),this.insertUnit(C.w.ContextMenuSlideReviewCommentsNewComment),this.insertUnit(C.w.ContextMenuSlideReviewCommentsDelete)}},{key:"createMemoCaretMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createThumbnailMenu",value:function(){this.insertUnit(C.w.ContextMenuSlideCutSlide),this.insertUnit(C.w.ContextMenuSlideCopySlide),this.insertUnit(C.w.ContextMenuSlidePasteSlide),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideInsertSlide),this.insertUnit(C.w.ContextMenuSlideDuplicateSlide),this.insertUnit(C.w.ContextMenuSlideDeleteSlide),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideInsertLayout),this.isCurrentPageHide()?this.insertUnit(C.w.ContextMenuSlideSlideShowSettingsUnhide):this.insertUnit(C.w.ContextMenuSlideSlideShowSettingsHide)}},{key:"createThumbnailEmptyMenu",value:function(){this.insertUnit(C.w.ContextMenuSlidePasteSlide),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideInsertSlide)}},{key:"createEmptyMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideViewShowRuler),this.insertUnit(C.w.ContextMenuSlideGridAndGuides);var e=(0,m.qm)(O.RW).currentHoveringType;e!==U.mel.BR_MOUSE_HOVERING_SLIDE_GUIDE_V&&e!==U.mel.BR_MOUSE_HOVERING_SLIDE_GUIDE_H||this.insertUnit(C.w.ContextMenuSlideDeleteGuide),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuSlideInsertLayout),this.insertUnit(C.w.ContextMenuSlideDesignCustomSlidesize)}},{key:"createVideoMenu",value:function(){this.addClipboardMenus(),this.insertUnit(C.w.ContextMenuDivider),this.insertUnit(C.w.ContextMenuArrangeGroup),this.insertUnit(C.w.ContextMenuArrangeForward),this.insertUnit(C.w.ContextMenuArrangeBackward),this.insertUnit(C.w.ContextMenuDivider),this.addHyperLinkMenus()}},{key:"createGroupSubmenu",value:function(){this.insertUnit(C.w.ContextMenuArrangeGroupGroup),this.insertUnit(C.w.ContextMenuArrangeGroupRegroup),this.insertUnit(C.w.ContextMenuArrangeGroupUngroup)}},{key:"createBringToFrontSubmenu",value:function(){this.insertUnit(C.w.ContextMenuArrangeGroupFront),this.insertUnit(C.w.ContextMenuArrangeForwardForward)}},{key:"createSendToBackwardSubmenu",value:function(){this.insertUnit(C.w.ContextMenuArrangeBackwardBack),this.insertUnit(C.w.ContextMenuArrangeBackwardBackward)}},{key:"createChangeChartSubmenu",value:function(){this.insertUnit(C.w.ContextMenuChangeChartVerticalSection),this.insertUnit(C.w.ContextMenuChangeChartHorizontalSection),this.insertUnit(C.w.ContextMenuChangeChartStockSection),this.insertUnit(C.w.ContextMenuChangeChartSurfaceSection),this.insertUnit(C.w.ContextMenuChangeChartRadialSection),this.insertUnit(C.w.ContextMenuChangeChartLineSection),this.insertUnit(C.w.ContextMenuChangeChartAreaSection),this.insertUnit(C.w.ContextMenuChangeChartPieSection),this.insertUnit(C.w.ContextMenuChangeChartDispersalSection)}},{key:"createParagraphBulletSubmenu",value:function(){this.insertUnit(C.w.ContextMenuParagraphBulletPalette)}},{key:"createParagraphNumberingSubmenu",value:function(){this.insertUnit(C.w.ContextMenuParagraphNumberingPalette)}},{key:"createShapeStyleSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeStyleStyle),this.isSupportOtherTheme()&&this.insertUnit(C.w.ContextMenuShapeStyleFillOtherTheme)}},{key:"createShpaStyleFillOthgerThemeSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeStyleFillOtherThemeStyle)}},{key:"createShapeFillColorSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeFillcolorNoColor),this.insertUnit(C.w.ContextMenuShapeFillcolorOtherColor)}},{key:"createShapeOutlineSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeOutlineNoColor),this.insertUnit(C.w.ContextMenuShapeOutlineOtherColor),this.insertUnit(C.w.ContextMenuShapeOutlineThickness),this.insertUnit(C.w.ContextMenuShapeOutlineDash),this.insertUnit(C.w.ContextMenuShapeOutlineArrow)}},{key:"createShapeOutlineThicknessSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeOutlineThickness01),this.insertUnit(C.w.ContextMenuShapeOutlineThickness02),this.insertUnit(C.w.ContextMenuShapeOutlineThickness03),this.insertUnit(C.w.ContextMenuShapeOutlineThickness04),this.insertUnit(C.w.ContextMenuShapeOutlineThickness05),this.insertUnit(C.w.ContextMenuShapeOutlineThickness06),this.insertUnit(C.w.ContextMenuShapeOutlineThickness07),this.insertUnit(C.w.ContextMenuShapeOutlineThickness08),this.insertUnit(C.w.ContextMenuShapeOutlineThickness09)}},{key:"createShapeOutlineDashSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeOutlineDash01),this.insertUnit(C.w.ContextMenuShapeOutlineDash02),this.insertUnit(C.w.ContextMenuShapeOutlineDash03),this.insertUnit(C.w.ContextMenuShapeOutlineDash04),this.insertUnit(C.w.ContextMenuShapeOutlineDash05),this.insertUnit(C.w.ContextMenuShapeOutlineDash06),this.insertUnit(C.w.ContextMenuShapeOutlineDash07),this.insertUnit(C.w.ContextMenuShapeOutlineDash08)}},{key:"createShapeOutlineArrowSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeOutlineArrow01),this.insertUnit(C.w.ContextMenuShapeOutlineArrow02),this.insertUnit(C.w.ContextMenuShapeOutlineArrow03),this.insertUnit(C.w.ContextMenuShapeOutlineArrow04),this.insertUnit(C.w.ContextMenuShapeOutlineArrow05),this.insertUnit(C.w.ContextMenuShapeOutlineArrow06),this.insertUnit(C.w.ContextMenuShapeOutlineArrow07),this.insertUnit(C.w.ContextMenuShapeOutlineArrow08),this.insertUnit(C.w.ContextMenuShapeOutlineArrow09),this.insertUnit(C.w.ContextMenuShapeOutlineArrow10),this.insertUnit(C.w.ContextMenuShapeOutlineArrow11)}},{key:"createPictureSizeCropSubmenu",value:function(){this.insertUnit(C.w.ContextMenuPictureSizeCropCrop),this.insertUnit(C.w.ContextMenuPictureSizeCropFill),this.insertUnit(C.w.ContextMenuPictureSizeCropFit)}},{key:"createPictureStyleSubmenu",value:function(){this.insertUnit(C.w.ContextMenuPictureStyleStyle)}},{key:"createPictureBorderSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeOutlineNoColor),this.insertUnit(C.w.ContextMenuShapeOutlineOtherColor),this.insertUnit(C.w.ContextMenuShapeOutlineThickness),this.insertUnit(C.w.ContextMenuShapeOutlineDash)}},{key:"createPictureEffectSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffectShadow),this.insertUnit(C.w.ContextMenuShapeEffectReflection),this.insertUnit(C.w.ContextMenuShapeEffectNeon),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge),this.insertUnit(C.w.ContextMenuShapeEffectBevel),this.insertUnit(C.w.ContextMenuShapeEffect3D)}},{key:"createPictureEffectShadowSubmenu",value:function(){S.Z.isShowVMLPanel()?(this.insertUnit(C.w.ContextMenuShapeEffectShadowNone),this.insertUnit(C.w.ContextMenuShapeEffectShadowOutside),S.Z.isSupportPerspectiveShadowForPPT()&&this.insertUnit(C.w.ContextMenuShapeEffectShadowPerspectiveVML)):(this.insertUnit(C.w.ContextMenuShapeEffectShadowNone),this.insertUnit(C.w.ContextMenuShapeEffectShadowOutside),this.insertUnit(C.w.ContextMenuShapeEffectShadowInner),this.insertUnit(C.w.ContextMenuShapeEffectShadowPerspective))}},{key:"createPictureEffectReflectionSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffectReflectionNone),this.insertUnit(C.w.ContextMenuShapeEffectReflectionModify)}},{key:"createPictureEffectNeonSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffectNeonNone),this.insertUnit(C.w.ContextMenuShapeEffectNeonModify)}},{key:"createPictureEffectSoftedgeSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffectSoftedgeNone),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge10),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge25),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge50),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge100),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge250),this.insertUnit(C.w.ContextMenuShapeEffectSoftedge500)}},{key:"createPictureEffectBevelSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffectBevelNone),this.insertUnit(C.w.ContextMenuShapeEffectBevel3doption)}},{key:"createPictureEffect3DSubmenu",value:function(){this.insertUnit(C.w.ContextMenuShapeEffect3DNone),this.insertUnit(C.w.ContextMenuShapeEffect3DParallel),this.insertUnit(C.w.ContextMenuShapeEffect3DPerspective)}},{key:"createSlideSizeSubmenu",value:function(){this.insertUnit(C.w.ContextMenuSlideDesignCustomSlidesize43),this.insertUnit(C.w.ContextMenuSlideDesignCustomSlidesize169)}},{key:"createSlideGridAndGuidesSubmenu",value:function(){this.insertUnit(C.w.ContextMenuSlideAddVerticalGuide),this.insertUnit(C.w.ContextMenuSlideAddHorizontalGuide),this.insertUnit(C.w.ContextMenuSlideSlideGuide),this.insertUnit(C.w.ContextMenuSlideSmartGuide),this.insertUnit(C.w.ContextMenuSlideGuideline)}},{key:"createSlideLayoutSubmenu",value:function(){this.insertUnit(C.w.ContextMenuSlideInsertLayout)}},{key:"createInsertCellSubmenu",value:function(){this.insertUnit(C.w.ContextMenuSlideTableLayoutRowColInsertTop),this.insertUnit(C.w.ContextMenuSlideTableLayoutRowColInsertBottom),this.insertUnit(C.w.ContextMenuSlideTableLayoutRowColInsertLeft),this.insertUnit(C.w.ContextMenuSlideTableLayoutRowColInsertRight)}}]),n}(f.ContextMenuUnitCreator)},46531:function(e,t,n){n.d(t,{FV:function(){return C},Gu:function(){return h}});var i=n(426373),r=n(135323),a=n(500811),o=n(101922),u=n(360008),s=n(371266),l=(0,i.oM)({name:"formCopy",initialState:{isChecked:!1,isDisabled:!1,isDisabledSubmenu:!1,currentIndex:3},reducers:{setFormCopyItem:function(e,t){e.currentIndex=t.payload}},extraReducers:function(e){e.addCase(o.He,(function(e){e.isDisabled=u.Z.isDisable(s.Gsz),e.isDisabledSubmenu=u.Z.isDisable(s.Gsz)})),e.addCase(a.$A,(function(e,t){e.isChecked=t.payload}))}}),h=(0,r.P1)((function(e){return e.command.clipboard.formCopy}),(function(e){return e})),C=l.actions.setFormCopyItem;t.ZP=l.reducer},820371:function(e,t,n){n.d(t,{$T:function(){return U},Be:function(){return x},DM:function(){return v},FK:function(){return P},KT:function(){return b},ce:function(){return m},oK:function(){return y}});var i=n(601413),r=n(426373),a=n(135323),o=n(981142),u=n(625477),s=n(877703),l=n(628264),h=n(101922),C=n(53110),c=n(416031),d={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},M=(0,r.oM)({name:"page",initialState:d,reducers:{setPageSize:function(e,t){var n=t.payload,i=n.pageWidth,r=n.pageHeight;e.pageWidth=i,e.pageHeight=r,e.pageRatio=r>0?r/i:0},setPageNumber:function(e,t){var n=t.payload,i=n.currentPage,r=n.totalPage;C.tq?(e.currentPage===i&&e.totalPage===r||(e.isShowingPageInfo=!0),T()):e.isShowingPageInfo=!0,e.currentPage=i,e.totalPage=r,e.isFirstPage=1===i,e.isLastPage=i===r},setIsShowPresentationEndingConfirm:function(e,t){e.isShowPresentationEndingConfirm=t.payload},setIsShowingPageInfo:function(e,t){e.isShowingPageInfo=t.payload},setIsShowingPageNavigation:function(e,t){e.isShowingPageNavigation=t.payload}},extraReducers:function(e){e.addCase(h.qp,(function(e){e.isShowingPageInfo=!C.tq})),e.addCase(l.FZ,(function(e,t){if(!t.payload)return(0,i.Z)({},d)}))}}),p=M.actions,w=p.setPageSize,S=p.setPageNumber,f=p.setIsShowPresentationEndingConfirm,g=p.setIsShowingPageInfo,x=p.setIsShowingPageNavigation;t.ZP=M.reducer;var U=(0,a.P1)((function(e){return e.page}),(function(e){return e})),v=function(){return(0,u.RU)("updatePageSizeThunk",(function(e){var t=o.o.getPageInfo(1),n=t.nPageWidth,i=t.nPageHeight;e(w({pageWidth:n,pageHeight:i}))}))},m=function(){return(0,u.RU)("updatePageNumberThunk",(function(e){var t=o.o.getConfig(),n=t.nCurPage,i=t.nTotalPages;e(S({currentPage:n,totalPage:i}))}))},b=function(e,t){return(0,u.RU)("updatePageMoveThunk",(function(n,i){var r=i().page.currentPage;n(S({currentPage:e,totalPage:t})),n((0,s.Ml)([r,e]))}))},y=function(e){return(0,u.RU)("setIsShowPresentationEndingConfirmThunk",(function(t){t(f(e))}))},T=(0,c.debounce)((function(){(0,u.Ce)(g(!1))}),2e3),P=(0,c.debounce)((function(){(0,u.Ce)(x(!1))}),2e3)},877703:function(e,t,n){n.d(t,{A7:function(){return O},Cq:function(){return m},Hq:function(){return g},Ml:function(){return E},Tb:function(){return y},Tz:function(){return x},XQ:function(){return U},ZB:function(){return b},Zm:function(){return _},aG:function(){return A},pL:function(){return D},yE:function(){return v},z_:function(){return I}});var i=n(601413),r=n(426373),a=n(135323),o=n(416031),u=n(625477),s=n(628264),l=n(981142),h=n(820371),C=n(588567),c=n(735622),d=n(995124),M=n(361688),p={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},w=(0,r.oM)({name:"slideThumbnail",initialState:p,reducers:{setThumbnailSize:function(e,t){var n=t.payload,i=n.width,r=n.height;e.width=i,e.height=r},setThumbnailItem:function(e,t){var n=t.payload,i=n.pageNumber,r=n.thumbnailItem;e.thumbnails[i]=r},unmountThumbnail:function(e,t){var n=t.payload;delete e.thumbnails[n]},clearThumbnails:function(e){},setIsResizing:function(e,t){e.isResizing=t.payload},setIsPageDrag:function(e,t){var n=t.payload;e.isPageDrag=n,!n&&(e.pageDropTarget=void 0)},setPageDropTarget:function(e,t){e.pageDropTarget=t.payload}},extraReducers:function(e){e.addCase(s.FZ,(function(e,t){if(!t.payload)return(0,i.Z)({},p)}))}}),S=w.actions.clearThumbnails,f=w.actions,g=f.setThumbnailSize,x=f.setThumbnailItem,U=f.unmountThumbnail,v=f.setIsResizing,m=f.setIsPageDrag,b=f.setPageDropTarget;t.ZP=w.reducer;var y=(0,a.P1)((function(e){return e.slideThumbnail}),(function(e){return e})),T=function(e,t,n,i){if(i||l.o.isPageModified(e)){var r=(0,u.qm)(M.CI),a=4*t*r,o=4*n*r;l.o.slideObjStartEx(a,o,e)}},P=function(e,t){return(0,u.RU)("requestSlideThumbnailFromToThunk",(function(n,i){var r=i(),a=r.slideThumbnail,o=a.width,u=a.height,s=r.page.totalPage;if(o&&u&&s>0&&e>=1&&t<=s)for(var l=e;l<=t;l+=1)T(l,o,u,!0)}))},E=function(e){return(0,u.RU)("requestSlideThumbnailListThunk",(function(t,n){var i=e.length;if(i>0){var r=n(),a=r.slideThumbnail,o=a.width,u=a.height,s=r.page.totalPage;if(o&&u)for(var l=0;l<i;l+=1){var h=e[l];h>=1&&h<=s&&T(h,o,u,!0)}}}))},O=function(e){return(0,u.RU)("requestSlideThumbnailAllThunk",(function(t,n){var i=n(),r=i.slideThumbnail,a=r.width,o=r.height,u=i.page.totalPage;if(e&&t(S()),a&&o&&u>0)for(var s=function(e){setTimeout((function(){T(e,a,o,!0)}))},l=1;l<=u;l+=1)s(l)}))},D=(0,o.debounce)((function(){var e=(0,u.qm)(h.$T).currentPage,t=(0,u.qm)(y),n=t.width,i=t.height;n&&i&&e>0&&T(e,n,i)}),500),I=function(e){var t=e.nAction,n=e.stListInfo,i=n.nPageCnt,r=n.pPageList;switch(t){case C.jar.eBR_UNREDO_ACTION_NONE:(0,u.Ce)((0,h.DM)()),(0,u.Ce)((0,h.ce)());break;case C.jar.eBR_UNREDO_ACTION_ADD:case C.jar.eBR_UNREDO_ACTION_DELETE:(0,u.Ce)((0,h.ce)());break;case C.jar.eBR_UNREDO_ACTION_MOVE:var a=i>0?r[0]:0,o=i>1?r[i-1]:a,s=Math.min(a,o),l=Math.max(a,o);(0,u.Ce)(P(s,l));break;case C.jar.eBR_UNREDO_ACTION_CHANGE:case C.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case C.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,u.Ce)(E(r));break;case C.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case C.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case C.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,u.Ce)(O());case C.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case C.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case C.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case C.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},A=function(){return(0,u.RU)("slidePageDropThunk",(function(e,t){var n=t(),r=n.page,a=n.slideThumbnail,u=r.currentPage,s=a.pageDropTarget;if(u>0&&!(0,o.isNil)(s)&&u!==s){var h=Math.min(s,u),c=Math.max(s,u);l.o.slideManageEx((0,i.Z)((0,i.Z)({},(0,C.zUw)()),{},{nType:C.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:s,nSectionIndex:0})),l.o.movePage(C.ZbX.eEV_MOVE_SETPAGE,s),e(P(h,c))}}))},_=function(){return(0,u.RU)("slidePageDeleteThunk",(function(e,t){var n=t().page,r=n.totalPage,a=n.currentPage;a>0&&(r>1?l.o.slideManageEx((0,i.Z)((0,i.Z)({},(0,C.zUw)()),{},{nType:C.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:a})):c.Z.showDialog({dialogId:d.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}}}]);