"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[402533,846775],{846775:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var o=t(215671),r=t(143144),i=t(957112),a=t(815e3),c=t(237683),u=t(977917),s=t(625477),l=t(361688),f=t(459551),d=t(159366),m=t(981142),g=t(588567),p=t(780386),h=t(735622),v=t(995124),C=t(652928),Z=t(53110),P=t(628264),D=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,d.mD)(e.name)?e.blob?O(e.name,e.blob).catch((function(e){return u.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):u.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):u.ZP.api.reject(n,"[Please include an extension in the name.]"):u.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):u.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return L()}},{key:"movePage",value:function(e){b(e)}},{key:"isReadOnlyDocument",value:function(){return y()}},{key:"getDocumentExtension",value:function(){return w()}}]),e}(),O=function(e,n){return new Promise((function(t,o){var r,i=(0,d.mD)(e);if(_(i)){c.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),t(),r=null,c.Z.removeListener("onOpenComplete")})),c.Z.setListener("onLoadFail",(function(n){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),o({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))}),r=null,c.Z.removeListener("onLoadFail")})),c.Z.setListener("onLoadForce",(function(){null!==r&&a(r,!0),r=null,c.Z.removeListener("onLoadForce")}));var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?p.Z.setOpenMode(g.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):p.Z.setOpenMode(g.ekp.ePRM_COMMON),p.Z.setDocData(n,i);var o=(0,s.qm)(l.LG),r=(0,s.qm)(l.CI);(0,Z.Vq)()?m.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,o.width*r,o.height*r):m.o.memoryOpen(".".concat(i),e,e.byteLength,o.width*r,o.height*r,t),(0,s.Ce)((0,P._j)(!1))},u=new FileReader;u.onload=function(){u.readyState===FileReader.DONE&&u.result instanceof ArrayBuffer&&(r=u.result,a(u.result))};var C=function(e){o({message:e,errorCode:-1,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})};u.onabort=function(){C("Reading the file is aborted. '".concat(u.error,"'."))},u.onerror=function(){C("Failed to read file. '".concat(u.error,"'."))},u.readAsArrayBuffer(n)}else h.Z.showDialog({dialogId:v.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){o({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},L=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},_=function(e){var n=(0,s.qm)(f.hz).docType,t=e.toLowerCase();if(n===C.n_.hwp){if(["hwp","hwpx"].includes(t))return!0}else if(n===C.n_.word){if(["doc","docx"].includes(t))return!0}else if(n===C.n_.sheet){if(["xls","xlsx","csv"].includes(t))return!0}else if(n===C.n_.slide&&["ppt","pptx"].includes(t))return!0;return!1},b=function(e){var n=e,t=m.o.getConfig().nTotalPages;n<1&&(n=1),n>t&&(n=t),m.o.movePage(g.ZbX.eEV_MOVE_SETPAGE,n)},y=function(){return p.Z.isProtectDoc()||p.Z.isReadOnlyDoc()},w=function(){return(0,s.qm)(f.hz).extension}},402533:function(e,n,t){t.r(n),t.d(n,{default:function(){return d}});var o=t(215671),r=t(143144),i=t(179340),a=t(432269),c=t(237683),u=t(846775),s=t(981142),l=t(588567),f=t(977917),d=function(e){(0,i.Z)(t,e);var n=(0,a.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"getDocumentInformation",value:function(){return m()}},{key:"exportAsImage",value:function(){return g().catch((function(e){return f.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}}]),t}(u.default),m=function(){var e=s.o.getSummaryData(),n=e.szTitle,t=e.szAuthor,o=e.szModifiedBy,r=e.nWords,i=s.o.getWordCountStatistic(!0),a=i.nPageCnt,c=i.nWordCnt,u=i.nCharCnt,l=i.nCharWithoutSpaceCnt,f=i.nParaCnt,d=i.nLineCnt;return{title:n,author:t,modifiedBy:o,characters:l.toString(),characterBlank:u.toString(),words:r?null===r||void 0===r?void 0:r.toString():"",wordsSelection:c.toString(),lines:d.toString(),paragraphs:f.toString(),pages:a.toString(),manuscript:Math.ceil(c/200).toString()}},g=function(){return new Promise((function(e,n){var t=s.o.getConfig().nTotalPages,o=[],r=setTimeout((function(){o.length!==t&&n(new Error("\n                        The file is too large to print."))}),1e4);c.Z.setListener("onExportAsImage",(function(n,i){i&&(o[n-1]=i),o.length===t&&(e({blobs:o}),c.Z.removeListener("onExportAsImage"),clearTimeout(r))})),s.o.setPrint(l.e_4.BR_PRINT_PAGESIZE_A4,1,t,l.nXZ.PRINT_JPG_IMG,l.AJA.BR_PRINT_150)}))}}}]);