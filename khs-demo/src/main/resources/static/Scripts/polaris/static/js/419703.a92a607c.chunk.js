"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[419703,161308,846775,498134],{161308:function(e,n,t){t.r(n),t.d(n,{default:function(){return b}});var o=t(215671),r=t(143144),i=t(237683),a=t(977917),u=t(625477),c=t(361688),s=t(459551),l=t(981142),d=t(588567),f=t(628264),m=t(769071),v=t(735622),g=t(995124),p=t(815e3),h=t(780386),y=t(159366),P=t(305054),w=t(382800),b=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"saveDocument",value:function(){return I().catch((function(e){return a.ZP.api.reject("The document could not be saved.","[".concat(e.message,"]"))}))}},{key:"isModified",value:function(){return D()}},{key:"getDocContentRect",value:function(){return k()}},{key:"getTitleBarRect",value:function(){return R()}},{key:"getRibbonTabMenuRect",value:function(){return Z()}},{key:"getRibbonBarRect",value:function(){return T()}},{key:"getViewMode",value:function(){return C()}},{key:"activeInput",value:function(){_()}},{key:"isProtectedDocument",value:function(){return h.Z.isPasswordDocument}},{key:"insertImage",value:function(e,n){}},{key:"insertHtmlData",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l.o.insertHtmlData(n?d.vlz.CLIPDATA_HTML:d.vlz.CLIPDATA_STR,e),m.Z.focus("DocInputField"),w.Z.updateDrawCaret()}},{key:"insertString",value:function(e){l.o.insertString(e,d.v$l.BR_IME_COMPOSITING_RESULT)}},{key:"getMarkString",value:function(){return l.o.getMarkString()}},{key:"getCaretInfo",value:function(){var e=l.o.getCaretInfoFromJson().nCaretStatus;return{status:(d.Bn1[e]||"").replaceAll("BR_","").toLowerCase(),objectType:P.Z.getObjectType(),objectCount:P.Z.getObjectCount()}}},{key:"getFrameToImageBlob",value:function(e){return O(e)}},{key:"downloadSelectFrame",value:function(e,n){S(e,n)}},{key:"getHtmlTextContent",value:function(e){return A(e)}}]),e}(),I=function(){return new Promise((function(e,n){var t=(0,u.qm)(s.hz),o=t.extension,r=t.docName;if(i.Z.setListener("onSaveDocument",(function(t,a){if(t===d.WbN.kPoProcessSucess&&a)if("hwpx"===o){var u="".concat(r.replace(new RegExp(".".concat(o,"$")),".hwp"));e({name:u,blob:a})}else e({name:r,blob:a});else n(new Error("Error ".concat(t)));i.Z.removeListener("onSaveDocument")})),o&&"csv"===o.toLowerCase()&&!0===p.ZP.get("isShowAlertDialogForCSVSaving"))v.Z.showDialog({dialogId:g.O.CONFIRM_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_CSV_SAVE_INFO"},currentTabIndex:0},(function(e){0===e?l.o.saveDocument(o):n(new Error("Canceled by user."))}));else{var a=o;"hwpx"===o&&(a="hwp"),l.o.saveDocument(a)}}))},D=function(){return l.o.isDocumentModified()},k=function(){return(0,u.qm)(c.SV)},R=function(){return(0,u.qm)(c.IU)},Z=function(){return(0,u.qm)(c.ms)},T=function(){return(0,u.qm)(c.qr)},C=function(){return(0,u.qm)(f.p_).viewMode},_=function(){m.Z.focus("DocInputField")},O=function(e){if(P.Z.isImageObject()&&1===P.Z.getObjectCount()){var n=(0,y.km)(e);return l.o.frameToImageBuffer(n)}return null},S=function(e,n){var t=(0,y.km)(n),o=l.o.frameToImageBuffer(t),r=document.createElement("a");r.style.display="none",document.body.appendChild(r);var i=window.URL.createObjectURL(o);r.href=i,r.download="".concat(e,".").concat(n),r.click(),window.URL.revokeObjectURL(i),document.body.removeChild(r)},A=function(e){var n=document.createElement("div");n.innerHTML=e;for(var t=n.children,o="",r=0;r<t.length;r+=1){var i;"STYLE"!==t[r].tagName&&(o+=null===(i=t[r].textContent)||void 0===i?void 0:i.replace(/\s\s+/g,"\n"))}return o}},846775:function(e,n,t){t.r(n),t.d(n,{default:function(){return b}});var o=t(215671),r=t(143144),i=t(957112),a=t(815e3),u=t(237683),c=t(977917),s=t(625477),l=t(361688),d=t(459551),f=t(159366),m=t(981142),v=t(588567),g=t(780386),p=t(735622),h=t(995124),y=t(652928),P=t(53110),w=t(628264),b=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,f.mD)(e.name)?e.blob?I(e.name,e.blob).catch((function(e){return c.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):c.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):c.ZP.api.reject(n,"[Please include an extension in the name.]"):c.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):c.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return D()}},{key:"movePage",value:function(e){R(e)}},{key:"isReadOnlyDocument",value:function(){return Z()}},{key:"getDocumentExtension",value:function(){return T()}}]),e}(),I=function(e,n){return new Promise((function(t,o){var r,i=(0,f.mD)(e);if(k(i)){u.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,d.RY)(e)),(0,s.Ce)((0,d.Js)(i)),t(),r=null,u.Z.removeListener("onOpenComplete")})),u.Z.setListener("onLoadFail",(function(n){(0,s.Ce)((0,d.RY)(e)),(0,s.Ce)((0,d.Js)(i)),o({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))}),r=null,u.Z.removeListener("onLoadFail")})),u.Z.setListener("onLoadForce",(function(){null!==r&&a(r,!0),r=null,u.Z.removeListener("onLoadForce")}));var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?g.Z.setOpenMode(v.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):g.Z.setOpenMode(v.ekp.ePRM_COMMON),g.Z.setDocData(n,i);var o=(0,s.qm)(l.LG),r=(0,s.qm)(l.CI);(0,P.Vq)()?m.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,o.width*r,o.height*r):m.o.memoryOpen(".".concat(i),e,e.byteLength,o.width*r,o.height*r,t),(0,s.Ce)((0,w._j)(!1))},c=new FileReader;c.onload=function(){c.readyState===FileReader.DONE&&c.result instanceof ArrayBuffer&&(r=c.result,a(c.result))};var y=function(e){o({message:e,errorCode:-1,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})};c.onabort=function(){y("Reading the file is aborted. '".concat(c.error,"'."))},c.onerror=function(){y("Failed to read file. '".concat(c.error,"'."))},c.readAsArrayBuffer(n)}else p.Z.showDialog({dialogId:h.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){o({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},D=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},k=function(e){var n=(0,s.qm)(d.hz).docType,t=e.toLowerCase();if(n===y.n_.hwp){if(["hwp","hwpx"].includes(t))return!0}else if(n===y.n_.word){if(["doc","docx"].includes(t))return!0}else if(n===y.n_.sheet){if(["xls","xlsx","csv"].includes(t))return!0}else if(n===y.n_.slide&&["ppt","pptx"].includes(t))return!0;return!1},R=function(e){var n=e,t=m.o.getConfig().nTotalPages;n<1&&(n=1),n>t&&(n=t),m.o.movePage(v.ZbX.eEV_MOVE_SETPAGE,n)},Z=function(){return g.Z.isProtectDoc()||g.Z.isReadOnlyDoc()},T=function(){return(0,s.qm)(d.hz).extension}},419703:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var o,r=t(601413),i=t(974165),a=t(115861),u=t(215671),c=t(143144),s=t(179340),l=t(432269),d=t(231881),f=t.n(d),m=t(237683),v=t(981142),g=t(159366),p=t(977917),h=t(625477),y=t(459551),P=t(445252),w=t(442113),b=t(416031),I=t(588567),D=t(498134),k=t(161308),R=t(628264),Z=t(53110),T=t(995124),C=t(407604);!function(e){e.all="all",e.current_slide="current_slide",e.custom_range="custom_range"}(o||(o={}));var _=function(e){(0,s.Z)(t,e);var n=(0,l.Z)(t);function t(){var e;return(0,u.Z)(this,t),(e=n.call(this)).commonAPI=void 0,e.commonAPI=new k.default,e}return(0,c.Z)(t,[{key:"saveDocument",value:function(){return this.commonAPI.saveDocument()}},{key:"isModified",value:function(){return this.commonAPI.isModified()}},{key:"getViewMode",value:function(){return this.commonAPI.getViewMode()}},{key:"activeInput",value:function(){return this.commonAPI.activeInput()}},{key:"getDocContentRect",value:function(){return this.commonAPI.getDocContentRect()}},{key:"getTitleBarRect",value:function(){return this.commonAPI.getTitleBarRect()}},{key:"getRibbonTabMenuRect",value:function(){return this.commonAPI.getRibbonTabMenuRect()}},{key:"getRibbonBarRect",value:function(){return this.commonAPI.getRibbonBarRect()}},{key:"isProtectedDocument",value:function(){return this.commonAPI.isProtectedDocument()}},{key:"insertHtmlData",value:function(e){return this.commonAPI.insertHtmlData(e)}},{key:"insertString",value:function(e){return this.commonAPI.insertString(e)}},{key:"getMarkString",value:function(){return this.commonAPI.getMarkString()}},{key:"getCaretInfo",value:function(){return this.commonAPI.getCaretInfo()}},{key:"getFrameToImageBlob",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"png";return this.commonAPI.getFrameToImageBlob(e)}},{key:"downloadSelectFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PoImage",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png";this.commonAPI.downloadSelectFrame(e,n)}},{key:"openNewDocument",value:function(){return O(this.openDocument).catch((function(e){return p.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"exportAsPDF",value:function(e){var n=e.target,t=e.isPdfAExport,r=e.customRange,i="The document could not be exported as pdf.";return(0,b.isNil)(n)||"string"!==typeof n||!(n in o)?p.ZP.api.reject(i,"['target' argument is invalid . Please set a valid 'target' argument and try again.]"):(0,b.isNil)(t)||"boolean"!==typeof t?p.ZP.api.reject(i,"['isPdfAExport' argument is invalid . Please set a valid 'target' argument and try again.]"):n!==o.custom_range||!(0,b.isNil)(r)&&"string"===typeof r?S(e).catch((function(e){return p.ZP.api.reject(i,"[".concat(e.message,"]"))})):p.ZP.api.reject(i,"['customRange' argument is invalid . Please set a valid 'customRange' argument and try again.]")}},{key:"insertImage",value:function(e,n){try{return A(e,n)}catch(t){return p.ZP.api.reject("","[".concat(t.message,"]"))}}},{key:"insertHyperlink",value:function(e,n){L(e,n)}},{key:"showOpenPasswordDialog",value:function(){x()}},{key:"showWritePasswordDialog",value:function(){E()}},{key:"setOpenPassword",value:function(e){M(e)}},{key:"setWritePassword",value:function(e){N(e)}},{key:"getHtmlTextContent",value:function(e){return this.commonAPI.getHtmlTextContent(e)}}]),t}(D.default),O=function(e){return new Promise(function(){var n=(0,a.Z)((0,i.Z)().mark((function n(t,o){var r,a,u,c,s,l,d,m,v,p,b;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,h.Ce)((0,y.ge)("pptx")),n.prev=1,r=(0,h.qm)(y.hz),a=r.docType,u=r.docName,c=r.extension,s=(0,h.qm)(P.Ce),l=s.currentLocale,"ko"!==(d=l)&&"en"!==d&&(d=w.Locale.en),m="".concat("/polaris","/static/media/").concat(a,"/template/").concat(d,"/blank.").concat(c),n.next=9,f().get(m,{responseType:"arraybuffer"});case 9:return v=n.sent,p=(0,g.ep)(c),b=new Blob([new Uint8Array(v.data)],{type:p}),n.next=14,e({name:u,blob:b});case 14:(0,h.Ce)((0,R._j)(!0)),t(),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(1),o(n.t0);case 21:case"end":return n.stop()}}),n,null,[[1,18]])})));return function(e,t){return n.apply(this,arguments)}}())},S=function(e){return new Promise((function(n,t){var r=e.target,i=e.isPdfAExport,a=e.customRange,u=(0,h.qm)(y.hz),c=u.docName,s=u.extension;m.Z.setListener("onSaveDocument",(function(e,o){if(e===I.WbN.kPoProcessSucess&&o){var r="".concat(c.replace(new RegExp(".".concat(s,"$")),".pdf"));n({name:r,blob:o})}else t(new Error("Error ".concat(e)));m.Z.removeListener("onSaveDocument")}));var l=0,d=[];switch(r){case o.all:break;case o.current_slide:var f=v.o.getConfig().nCurPage;l=1,d.push(f);break;case o.custom_range:if(!a)return;a.split(",").forEach((function(e){if(e.indexOf("-")>0){var n=e.split("-");if(2!==n.length)return;var t=parseInt(n[0]),o=parseInt(n[1]);if(isNaN(t)||isNaN(o))return;for(var r=t;r<=o;r+=1)d.push(r)}else{var i=parseInt(e);if(isNaN(i))return;d.push(i)}})),l=(d=Array.from(new Set(d))).length}v.o.saveDocument("pdf",I.dLw.BR_SAVE_OPTION_TEMP_SAVE,i,!1,l,d,!1,400)}))},A=function(e,n){return new Promise(function(){var t=(0,a.Z)((0,i.Z)().mark((function t(o,r){var a,u,c,s,l;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,Z.Cq)(e);case 3:if((a=t.sent)instanceof ArrayBuffer){t.next=6;break}return t.abrupt("return");case 6:u=(null===n||void 0===n?void 0:n.width)||0,c=(null===n||void 0===n?void 0:n.height)||0,0,s=(null===n||void 0===n?void 0:n.posX)||0,l=(null===n||void 0===n?void 0:n.posY)||0,v.o.imageInsert(a,u,c,0,s,l),o(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),r(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,n){return t.apply(this,arguments)}}())},L=function(e,n){if(!(0,b.isEmpty)(e)){var t=(0,r.Z)((0,r.Z)({},(0,I.Nuw)()),{},{nLinkType:I.QLl.EV_LINK_TO_URL,nRunType:I.Cuw.EV_LINK_RUNTYPE_MOUSE_CLICK,szHyperLink:e||"",szHyperText:n||""});v.o.setHyperLinkInfoFromJson(t)}},x=function(){var e=""===v.o.getPasswordStr().szOpenPassword?T.O.OPEN_PASSWORD_SETTING_DIALOG:T.O.OPEN_PASSWORD_CHANGE_DIALOG;(0,h.Ce)((0,C.vC)({dialogId:e,bModal:!0,currentTabIndex:0}))},E=function(){var e=""===v.o.getPasswordStr().szWritePassword?T.O.WRITE_PASSWORD_SETTING_DIALOG:T.O.WRITE_PASSWORD_CHANGE_DIALOG;(0,h.Ce)((0,C.vC)({dialogId:e,bModal:!0,currentTabIndex:0}))},M=function(e){var n=v.o.getPasswordStr(),t=v.o.isReadOnlyRecommendedDoc();v.o.setPasswordStr(e,n.szWritePassword,t)},N=function(e){var n=v.o.getPasswordStr(),t=v.o.isReadOnlyRecommendedDoc();v.o.setPasswordStr(n.szOpenPassword,e,t)}},498134:function(e,n,t){t.r(n),t.d(n,{default:function(){return p}});var o=t(215671),r=t(143144),i=t(611752),a=t(661120),u=t(179340),c=t(432269),s=t(237683),l=t(846775),d=t(981142),f=t(588567),m=t(977917),v=t(173470),g=t(625477),p=function(e){(0,u.Z)(t,e);var n=(0,c.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"getDocumentInformation",value:function(){return h()}},{key:"exportAsImage",value:function(){return y().catch((function(e){return m.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}},{key:"openDocument",value:function(e){return(0,g.Ce)((0,v.Wm)()),(0,i.Z)((0,a.Z)(t.prototype),"openDocument",this).call(this,e)}}]),t}(l.default),h=function(){var e=d.o.getSummaryData();return{title:e.szTitle,author:e.szAuthor,modifiedBy:e.szModifiedBy}},y=function(){return new Promise((function(e,n){var t=d.o.getConfig().nTotalPages,o=[],r=setTimeout((function(){o.length!==t&&n(new Error("\n                        The file is too large to print."))}),1e4);s.Z.setListener("onExportAsImage",(function(n,i){i&&(o[n-1]=i),o.length===t&&(e({blobs:o}),s.Z.removeListener("onExportAsImage"),clearTimeout(r))})),d.o.setPrint(f.e_4.BR_PRINT_PAGESIZE_A4,1,t,f.nXZ.PRINT_JPG_IMG,f.AJA.BR_PRINT_150)}))}},173470:function(e,n,t){t.d(n,{So:function(){return P},Wm:function(){return p},Z7:function(){return w},ZS:function(){return o},i0:function(){return y},wP:function(){return g}});var o,r=t(426373),i=t(135323),a=t(625477),u=t(981142),c=t(53110),s=t(305054),l=t(530624);!function(e){e.EmbedVideo="embed_video",e.OnlineVideo="online_video"}(o||(o={}));var d={x:0,y:0,width:0,height:0,isShowing:!1,autoPlay:!1,videoPath:"",videoType:void 0},f=(0,r.oM)({name:"videoPlayer",initialState:d,reducers:{setVideoData:function(e,n){var t=n.payload,o=t.x,r=t.y,i=t.width,a=t.height,u=t.videoPath,c=t.videoType;e.x=o,e.y=r,e.width=i,e.height=a,e.videoPath=u,e.videoType=c,e.isShowing=!1},showVideoPlayer:function(e,n){e.isShowing=!0,e.autoPlay=n.payload},hideVideoPlayer:function(){return d},setVideoSize:function(e,n){var t=n.payload,o=t.x,r=t.y,i=t.width,a=t.height;e.x=o,e.y=r,e.width=i,e.height=a}},extraReducers:function(e){e.addCase(s.j,(function(e){if(l.uq.eObjCtrVideo!==s.Z.getObjectControlType())return d}))}}),m=f.actions,v=m.setVideoData,g=m.showVideoPlayer,p=m.hideVideoPlayer,h=m.setVideoSize;n.ZP=f.reducer;var y=(0,i.P1)((function(e){return e.videoPlayer}),(function(e){return e})),P=function(){return(0,a.RU)("loadVideoDataThunk",(function(e,n){var t=n(),r=u.o.getVideoPath(),i=u.o.getVideoRect(),a=t.section.devicePixelRatio,s=i.left/a,l=i.top/a,d=(i.right-i.left)/a,f=(i.bottom-i.top)/a,m=(0,c.jv)(r);e(v({x:s,y:l,width:d,height:f,videoPath:r,videoType:m?o.OnlineVideo:o.EmbedVideo}))}))},w=function(){return(0,a.RU)("updateVideoSizeThunk",(function(e,n){var t=n(),o=u.o.getVideoRect(),r=t.section.devicePixelRatio,i=o.left/r,a=o.top/r,c=(o.right-o.left)/r,s=(o.bottom-o.top)/r;e(h({x:i,y:a,width:c,height:s}))}))}}}]);