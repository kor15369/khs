"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[194005],{194005:function(e,n,t){t.r(n),t.d(n,{HyperlinkTab:function(){return a},default:function(){return O}});var a,i=t(601413),r=t(870885),l=t(747313),u=t(180252),s=t(700936),c=t(837490),o=t(735622),g=t(448439),T=t(96001),_=t(827611),h=t(307360),E=t(407604),d=t(981142),p=t(588567),f=t(416031),I=t(305054),L=t(530624),b=t(820371),P=t(551261),C=t(346417);function O(e){var n="mailto:",t=(0,s.Z)().formatMessage,O=(0,u.I0)(),N=e.dialogId,m=e.tabs,x=e.commandName,S=g.Z.getCommandInstance(x),D=(0,u.v9)(b.$T).totalPage,j=(0,l.useState)(!1),R=(0,r.Z)(j,2),v=R[0],y=R[1],k=(0,l.useState)(""),A=(0,r.Z)(k,2),G=A[0],Z=A[1],q=(0,l.useState)(""),K=(0,r.Z)(q,2),U=K[0],H=K[1],w=(0,l.useState)(""),M=(0,r.Z)(w,2),V=M[0],B=M[1],z=(0,l.useState)(a.Web),Q=(0,r.Z)(z,2),W=Q[0],Y=Q[1],F=(0,l.useState)(!1),X=(0,r.Z)(F,2),$=X[0],J=X[1],ee=(0,l.useState)(!1),ne=(0,r.Z)(ee,2),te=ne[0],ae=ne[1],ie=(0,l.useState)(0),re=(0,r.Z)(ie,2),le=re[0],ue=re[1],se=m[W].buttons,ce="<<".concat(t({id:"DLG_HYPERLINK_SELECTED_ON_DOCUMENT"}),">>"),oe=(0,l.useMemo)((function(){var e=[];e.push({linkType:p.QLl.EV_LINK_TO_FIRSTPAGE,label:t({id:"DLG_HYPERLINK_FIRST_SLIDE"}),isActive:!1}),e.push({linkType:p.QLl.EV_LINK_TO_LASTPAGE,label:t({id:"DLG_HYPERLINK_LAST_SLIDE"}),isActive:!1}),e.push({linkType:p.QLl.EV_LINK_TO_NEXTPAGE,label:t({id:"DLG_HYPERLINK_NEXT_SLIDE"}),isActive:!1}),e.push({linkType:p.QLl.EV_LINK_TO_PREVPAGE,label:t({id:"DLG_HYPERLINK_PREVIOUS_SLIDE"}),isActive:!1}),e.push({linkType:p.QLl.EV_LINK_TO_SLIDE_GOTOPAGE,label:t({id:"DLG_HYPERLINK_SLIDE_PAGE"}),isActive:!1});for(var n=1;n<=D;n+=1)e.push({linkType:p.QLl.EV_LINK_TO_SLIDE_GOTOPAGE,pageNum:n,label:"".concat(n,". ").concat(t({id:"DLG_HYPERLINK_SLIDE"})," ").concat(n),isActive:!1});return e}),[t,D]),ge=(0,l.useCallback)((function(){S.invoke({actionType:P.U.DeleteHyperlink})}),[S]),Te=(0,l.useCallback)((function(){S.invoke({actionType:P.U.InsertHyperlink,displayText:v?"":G,isDisplayTextDisabled:v,hyperlink:W===a.Web?U:V,hyperLinkTab:W,selectedLinkType:W===a.CurrentDocument?oe[le].linkType:null,pageNum:oe[le].pageNum})}),[S,le,G,V,W,v,oe,U]),_e=(0,l.useCallback)((function(e){e.stopPropagation()}),[]),he=(0,l.useCallback)((function(e){"Enter"===e.key&&U.length>0&&(Te(),o.Z.hideDialog(N))}),[N,Te,U.length]),Ee=(0,l.useCallback)((function(e){ue(e)}),[]),de={tabIndex:W,tabs:m,onTabChange:(0,l.useCallback)((function(e){e===a.Web?ae(!!(G.length<1||U.length<1)):e===a.CurrentDocument?ae(!1):e===a.Email&&ae(!!(G.length<1||V.length<1)),Y(e)}),[V.length,G.length,U.length])},pe={buttonLabels:se,buttonDisableStates:[$,te,!1],onClick:(0,l.useCallback)((function(e){0===e?ge():1===e&&Te(),o.Z.hideDialog(N)}),[ge,N,Te])},fe=(0,l.useCallback)((function(e){Z(e.currentTarget.value),W===a.Web?ae(!!(U.length<1)):W===a.CurrentDocument?ae(!1):W===a.Email&&ae(!!(e.currentTarget.value.length<1||V.length<1))}),[W,V.length,U.length]),Ie=(0,l.useCallback)((function(e){H(e.currentTarget.value),ae(!!(e.currentTarget.value.length<1))}),[]),Le=(0,l.useCallback)((function(e){var t="";if(e.currentTarget.value.startsWith(n))t=e.currentTarget.value;else{for(var a=n.split(""),i=e.currentTarget.value.split(""),r=0;r<i.length&&!(a.length<=r)&&i[r]===a[r];r+=1)i[r]="";t=n+i.join("")}B(t),ae(!!(G.length<1||e.currentTarget.value.length<1))}),[G.length]),be=(0,l.useCallback)((function(e){var n="DLG_HYPERLINK_TITLE_EDIT_HYPERLINK";switch(e.nLinkType){case p.QLl.EV_LINK_TO_BOOKMARK:case p.QLl.EV_LINK_TO_FIRSTPAGE:case p.QLl.EV_LINK_TO_LASTPAGE:case p.QLl.EV_LINK_TO_NEXTPAGE:case p.QLl.EV_LINK_TO_PREVPAGE:case p.QLl.EV_LINK_TO_SLIDE_GOTOPAGE:return n;default:return(0,f.isEmpty)(e.szHyperLink)?"DLG_HYPERLINK_TITLE_INSERT_HYPERLINK":n}}),[]),Pe=(0,l.useCallback)((function(){switch(I.Z.getObjectControlType()){case L.uq.eObjCtrTemplate:case L.uq.eObjCtrShape:case L.uq.eObjCtrGroup:case L.uq.eObjCtrGroupInlineText:case L.uq.eObjCtrLine:case L.uq.eObjCtrLineInlineText:case L.uq.eObjCtrInfraPen:case L.uq.eObjCtrInfraPenInlineText:case L.uq.eObjCtrImageInlineText:case L.uq.eObjCtrImage:case L.uq.eObjCtrTextBox:case L.uq.eObjCtrTextBoxInlineText:case L.uq.eObjCtrChart:case L.uq.eObjCtrTemplateInlineText:case L.uq.eObjCtrFLine:case L.uq.eObjCtrFLineInlineText:case L.uq.eObjCtrSmtArtGroup:case L.uq.eObjCtrSmtArtGroupInlineText:case L.uq.eObjCtrSmtArtChildShape:case L.uq.eObjCtrSmtArtChildLine:case L.uq.eObjCtrPargraphStrip:case L.uq.eObjCtrPargraphStripInline:return!0}}),[]),Ce=(0,l.useCallback)((function(){switch(I.Z.getObjectControlType()){case L.uq.eObjCtrChartTextSelect:case L.uq.eObjCtrTableTextSelect:case L.uq.eObjCtrTextBoxTextSelect:case L.uq.eObjCtrTemplateTextSelect:case L.uq.eObjCtrMemoTextSelect:case L.uq.eObjCtrDropCapTextSelect:case L.uq.eObjCtrFLineTextSelect:case L.uq.eObjCtrSmtArtChildTextSelect:case L.uq.eObjCtrEquationTextSelect:case L.uq.eObjCtrHWPEquationTextSelect:return!0}return!1}),[]),Oe=(0,l.useCallback)((function(e){var n="",t="",a=!0,i=!1;return e.nLinkType!==p.QLl.EV_LINK_TO_URL&&e.nLinkType!==p.QLl.EV_LINK_TO_EMAIL||(i=!0),Pe()?(n=ce,a=!1,i&&(t=e.szHyperLink)):i?((0,f.isEmpty)(e.szHyperText)&&!(0,f.isEmpty)(e.szHyperLink)||Ce()&&(0,f.isEmpty)(e.szHyperText)?(n=ce,a=!1):n=e.szHyperText,t=e.szHyperLink):n=e.szHyperText,{hyperlinkText:n,hyperlinkUrl:t,isDisplayTextEnable:a}}),[Pe,Ce,ce]);return(0,l.useEffect)((function(){var e=d.o.getHyperlinkInfo(0,0,!0),i=Oe(e),r=i.hyperlinkText,l=i.hyperlinkUrl,u=i.isDisplayTextEnable,s=!!l.startsWith(n),c=t({id:be(e)});if(e.nLinkType===p.QLl.EV_LINK_TO_FIRSTPAGE||e.nLinkType===p.QLl.EV_LINK_TO_LASTPAGE||e.nLinkType===p.QLl.EV_LINK_TO_NEXTPAGE||e.nLinkType===p.QLl.EV_LINK_TO_PREVPAGE||e.nLinkType===p.QLl.EV_LINK_TO_SLIDE_GOTOPAGE){var o=oe.findIndex((function(n){if(n.linkType===e.nLinkType){if(n.linkType!==p.QLl.EV_LINK_TO_SLIDE_GOTOPAGE)return!0;if(n.pageNum===e.nPageNum)return!0}return!1}));Y(a.CurrentDocument),ae(!1),o<0&&J(!0),ue(Math.max(o,0))}else s?(Y(a.Email),B(l)):(Y(a.Web),H(l)),ae(!(r.length>0&&l.length>0)),J(!(r.length>0&&l.length>0));Z(r),y(!u),O((0,E.GV)({dialogId:N,dynamicTitle:c}))}),[t,S,N,O,be,Oe,oe]),(0,C.jsxs)(l.Fragment,{children:[(0,C.jsx)(T.Z,(0,i.Z)({},de)),(0,C.jsx)("div",{className:c.Z.popup_contents,onMouseUp:_e,onKeyDown:he,children:(0,C.jsxs)("table",{className:c.Z.form_table,children:[(0,C.jsx)("colgroup",{children:(0,C.jsx)("col",{style:{width:"auto"}})}),(0,C.jsxs)("tbody",{children:[(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:(0,C.jsx)(h.Z,{label:"DLG_HYPERLINK_TEXT_TO_DISPLAY"})})}),(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:c.Z.multi_select,children:(0,C.jsx)("div",{className:c.Z.i_txt,children:(0,C.jsx)("input",{type:"text",value:G,onChange:fe,spellCheck:!1,readOnly:!!v,className:v?c.Z.disabled:""})})})})}),W===a.Web?(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:(0,C.jsx)(h.Z,{label:"DLG_HYPERLINK_ADDRESS"})})}):null,W===a.Web?(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:c.Z.multi_select,children:(0,C.jsx)("div",{className:c.Z.i_txt,children:(0,C.jsx)("input",{type:"text",value:U,onChange:Ie,spellCheck:!1})})})})}):null,W===a.CurrentDocument?(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:(0,C.jsx)(h.Z,{label:"DLG_HYPERLINK_TAB_CURRENT_DOCUMENT"})})}):null,W===a.CurrentDocument?(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:c.Z.flex_box,children:(0,C.jsx)("div",{className:c.Z.inner_box,children:(0,C.jsx)("div",{className:c.Z.list_box,style:{height:"368px"},children:(0,C.jsx)("ul",{children:oe.map((function(e,n){var t=e.label,a=e.pageNum,i="";return n===le&&(i=c.Z.active),a&&(i+=" ".concat(c.Z.indent)),(0,C.jsx)("li",{children:(0,C.jsx)("button",{className:i,onClick:function(){return Ee(n)},children:t})},n)}))})})})})})}):null,W===a.Email?(0,C.jsx)("tr",{children:(0,C.jsx)("th",{children:(0,C.jsx)(h.Z,{label:"DLG_HYPERLINK_TAB_EMAIL"})})}):null,W===a.Email?(0,C.jsx)("tr",{children:(0,C.jsx)("td",{children:(0,C.jsx)("div",{className:c.Z.multi_select,children:(0,C.jsx)("div",{className:c.Z.i_txt,children:(0,C.jsx)("input",{type:"text",value:V,onChange:Le,spellCheck:!1})})})})}):null]})]})}),(0,C.jsx)(_.Z,(0,i.Z)({},pe))]})}!function(e){e[e.Web=0]="Web",e[e.CurrentDocument=1]="CurrentDocument",e[e.Email=2]="Email"}(a||(a={}))},820371:function(e,n,t){t.d(n,{$T:function(){return b},Be:function(){return L},DM:function(){return P},FK:function(){return x},KT:function(){return O},ce:function(){return C},oK:function(){return N}});var a=t(601413),i=t(426373),r=t(135323),l=t(981142),u=t(625477),s=t(877703),c=t(628264),o=t(101922),g=t(53110),T=t(416031),_={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},h=(0,i.oM)({name:"page",initialState:_,reducers:{setPageSize:function(e,n){var t=n.payload,a=t.pageWidth,i=t.pageHeight;e.pageWidth=a,e.pageHeight=i,e.pageRatio=i>0?i/a:0},setPageNumber:function(e,n){var t=n.payload,a=t.currentPage,i=t.totalPage;g.tq?(e.currentPage===a&&e.totalPage===i||(e.isShowingPageInfo=!0),m()):e.isShowingPageInfo=!0,e.currentPage=a,e.totalPage=i,e.isFirstPage=1===a,e.isLastPage=a===i},setIsShowPresentationEndingConfirm:function(e,n){e.isShowPresentationEndingConfirm=n.payload},setIsShowingPageInfo:function(e,n){e.isShowingPageInfo=n.payload},setIsShowingPageNavigation:function(e,n){e.isShowingPageNavigation=n.payload}},extraReducers:function(e){e.addCase(o.qp,(function(e){e.isShowingPageInfo=!g.tq})),e.addCase(c.FZ,(function(e,n){if(!n.payload)return(0,a.Z)({},_)}))}}),E=h.actions,d=E.setPageSize,p=E.setPageNumber,f=E.setIsShowPresentationEndingConfirm,I=E.setIsShowingPageInfo,L=E.setIsShowingPageNavigation;n.ZP=h.reducer;var b=(0,r.P1)((function(e){return e.page}),(function(e){return e})),P=function(){return(0,u.RU)("updatePageSizeThunk",(function(e){var n=l.o.getPageInfo(1),t=n.nPageWidth,a=n.nPageHeight;e(d({pageWidth:t,pageHeight:a}))}))},C=function(){return(0,u.RU)("updatePageNumberThunk",(function(e){var n=l.o.getConfig(),t=n.nCurPage,a=n.nTotalPages;e(p({currentPage:t,totalPage:a}))}))},O=function(e,n){return(0,u.RU)("updatePageMoveThunk",(function(t,a){var i=a().page.currentPage;t(p({currentPage:e,totalPage:n})),t((0,s.Ml)([i,e]))}))},N=function(e){return(0,u.RU)("setIsShowPresentationEndingConfirmThunk",(function(n){n(f(e))}))},m=(0,T.debounce)((function(){(0,u.Ce)(I(!1))}),2e3),x=(0,T.debounce)((function(){(0,u.Ce)(L(!1))}),2e3)},877703:function(e,n,t){t.d(n,{A7:function(){return D},Cq:function(){return C},Hq:function(){return I},Ml:function(){return S},Tb:function(){return N},Tz:function(){return L},XQ:function(){return b},ZB:function(){return O},Zm:function(){return y},aG:function(){return v},pL:function(){return j},yE:function(){return P},z_:function(){return R}});var a=t(601413),i=t(426373),r=t(135323),l=t(416031),u=t(625477),s=t(628264),c=t(981142),o=t(820371),g=t(588567),T=t(735622),_=t(995124),h=t(361688),E={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},d=(0,i.oM)({name:"slideThumbnail",initialState:E,reducers:{setThumbnailSize:function(e,n){var t=n.payload,a=t.width,i=t.height;e.width=a,e.height=i},setThumbnailItem:function(e,n){var t=n.payload,a=t.pageNumber,i=t.thumbnailItem;e.thumbnails[a]=i},unmountThumbnail:function(e,n){var t=n.payload;delete e.thumbnails[t]},clearThumbnails:function(e){},setIsResizing:function(e,n){e.isResizing=n.payload},setIsPageDrag:function(e,n){var t=n.payload;e.isPageDrag=t,!t&&(e.pageDropTarget=void 0)},setPageDropTarget:function(e,n){e.pageDropTarget=n.payload}},extraReducers:function(e){e.addCase(s.FZ,(function(e,n){if(!n.payload)return(0,a.Z)({},E)}))}}),p=d.actions.clearThumbnails,f=d.actions,I=f.setThumbnailSize,L=f.setThumbnailItem,b=f.unmountThumbnail,P=f.setIsResizing,C=f.setIsPageDrag,O=f.setPageDropTarget;n.ZP=d.reducer;var N=(0,r.P1)((function(e){return e.slideThumbnail}),(function(e){return e})),m=function(e,n,t,a){if(a||c.o.isPageModified(e)){var i=(0,u.qm)(h.CI),r=4*n*i,l=4*t*i;c.o.slideObjStartEx(r,l,e)}},x=function(e,n){return(0,u.RU)("requestSlideThumbnailFromToThunk",(function(t,a){var i=a(),r=i.slideThumbnail,l=r.width,u=r.height,s=i.page.totalPage;if(l&&u&&s>0&&e>=1&&n<=s)for(var c=e;c<=n;c+=1)m(c,l,u,!0)}))},S=function(e){return(0,u.RU)("requestSlideThumbnailListThunk",(function(n,t){var a=e.length;if(a>0){var i=t(),r=i.slideThumbnail,l=r.width,u=r.height,s=i.page.totalPage;if(l&&u)for(var c=0;c<a;c+=1){var o=e[c];o>=1&&o<=s&&m(o,l,u,!0)}}}))},D=function(e){return(0,u.RU)("requestSlideThumbnailAllThunk",(function(n,t){var a=t(),i=a.slideThumbnail,r=i.width,l=i.height,u=a.page.totalPage;if(e&&n(p()),r&&l&&u>0)for(var s=function(e){setTimeout((function(){m(e,r,l,!0)}))},c=1;c<=u;c+=1)s(c)}))},j=(0,l.debounce)((function(){var e=(0,u.qm)(o.$T).currentPage,n=(0,u.qm)(N),t=n.width,a=n.height;t&&a&&e>0&&m(e,t,a)}),500),R=function(e){var n=e.nAction,t=e.stListInfo,a=t.nPageCnt,i=t.pPageList;switch(n){case g.jar.eBR_UNREDO_ACTION_NONE:(0,u.Ce)((0,o.DM)()),(0,u.Ce)((0,o.ce)());break;case g.jar.eBR_UNREDO_ACTION_ADD:case g.jar.eBR_UNREDO_ACTION_DELETE:(0,u.Ce)((0,o.ce)());break;case g.jar.eBR_UNREDO_ACTION_MOVE:var r=a>0?i[0]:0,l=a>1?i[a-1]:r,s=Math.min(r,l),c=Math.max(r,l);(0,u.Ce)(x(s,c));break;case g.jar.eBR_UNREDO_ACTION_CHANGE:case g.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case g.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,u.Ce)(S(i));break;case g.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case g.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case g.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,u.Ce)(D());case g.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case g.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case g.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case g.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},v=function(){return(0,u.RU)("slidePageDropThunk",(function(e,n){var t=n(),i=t.page,r=t.slideThumbnail,u=i.currentPage,s=r.pageDropTarget;if(u>0&&!(0,l.isNil)(s)&&u!==s){var o=Math.min(s,u),T=Math.max(s,u);c.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,g.zUw)()),{},{nType:g.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:s,nSectionIndex:0})),c.o.movePage(g.ZbX.eEV_MOVE_SETPAGE,s),e(x(o,T))}}))},y=function(){return(0,u.RU)("slidePageDeleteThunk",(function(e,n){var t=n().page,i=t.totalPage,r=t.currentPage;r>0&&(i>1?c.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,g.zUw)()),{},{nType:g.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:r})):T.Z.showDialog({dialogId:_.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}}}]);