"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[899772],{827611:function(n,e,t){t.d(e,{Z:function(){return o}});t(747313);var a=t(837490),i=t(307360),r=t(346417);function o(n){var e=n.buttonLabels,t=n.onClick,o=n.buttonDisableStates;return(0,r.jsx)("div",{className:a.Z.popup_btn_wrap,children:e.map((function(n,e){var u=!!o&&o[e];return(0,r.jsx)("button",{className:"".concat(a.Z.p_btn," ").concat(a.Z.normal),onClick:function(){return t(e)},disabled:u,children:(0,r.jsx)(i.Z,{label:n})},e)}))})}},634077:function(n,e,t){t.d(e,{r:function(){return c}});var a=t(870885),i=t(747313),r=t(59199),o=t(837490),u=t(346417),c=(0,i.forwardRef)((function(n,e){var t=n.list,c=n.currentIndex,s=n.isDisable,l=n.inputWidth,g=n.canEditInput,d=void 0!==g&&g,f=n.scrollTop,h=(0,i.useState)(!1),p=(0,a.Z)(h,2),b=p[0],m=p[1],T=(0,i.useState)(""),P=(0,a.Z)(T,2),_=P[0],I=P[1];(0,i.useEffect)((function(){n.inputValue?I(n.inputValue||""):t[c]&&I(t[c].text)}),[c,t,n.inputValue]);var N=(0,i.useCallback)((function(){s||m(!b)}),[s,b]),E=(0,i.useCallback)((function(){m(!1)}),[]),C=(0,i.useCallback)((function(e){m(!1),I(t[e].text),n.onClickItem&&n.onClickItem(e)}),[t,n]),v=(0,i.useCallback)((function(e){var t=e.target.value;I(t),n.onChangeInput&&n.onChangeInput(t)}),[n]),R="".concat(o.Z.custom_select," ").concat(s?"".concat(o.Z.disabled):""),x="".concat(o.Z.current),S={},D={},O={display:b?"block":"none",marginTop:"".concat(2-(f||0),"px")};return l&&(S.minWidth="".concat(l,"px"),S.width="auto",d&&(D.minWidth="".concat(l,"px"),D.boxSizing="border-box"),O.minWidth="".concat(l,"px"),O.boxSizing="border-box"),(0,u.jsx)("div",{className:R,children:(0,u.jsxs)(r.default,{onOutsideClick:E,children:[d?(0,u.jsx)("div",{className:o.Z.multi_select,children:(0,u.jsxs)("div",{className:o.Z.i_txt,style:D,children:[(0,u.jsx)("input",{type:"text",ref:e,value:_,onChange:v}),(0,u.jsx)("button",{className:o.Z.toggle,onClick:N,children:(0,u.jsx)("span",{children:"toggle"})})]})}):(0,u.jsx)("button",{className:x,style:S,onClick:N,children:(0,u.jsx)("span",{children:_})}),!t||t.length<1?null:(0,u.jsx)("ul",{className:o.Z.list,style:O,children:t.map((function(n,e){var t=e===c?"".concat(o.Z.active):"";return(0,u.jsx)("li",{className:o.Z.list,onClick:function(){return C(e)},children:(0,u.jsx)("button",{className:t,children:(0,u.jsx)("span",{children:n.text})})},e)}))})]})})}))},899772:function(n,e,t){t.r(e),t.d(e,{default:function(){return _}});var a=t(601413),i=t(242982),r=t(870885),o=t(747313),u=t(180252),c=t(837490),s=t(827611),l=t(307360),g=t(735622),d=t(820371),f=t(104994),h=t(981142),p=t(634077),b=t(407604),m=t(346417),T=290,P=160;function _(n){var e=n.dialogIndex,t=n.dialogId,_=n.tabs,I=(0,u.I0)(),N=_[0].buttons,E=(0,u.v9)((0,b.R1)(e)),C=E.data,v=E.scrollTop,R=(0,u.v9)(d.$T).totalPage,x=(0,u.v9)(f.wN).pageThumbnail,S=(0,o.useState)(C||1),D=(0,r.Z)(S,2),O=D[0],j=D[1],Z=(0,o.useMemo)((function(){return x.pageNumber===O?x.url:""}),[O,x]);(0,o.useEffect)((function(){return h.o.getPageThumbnail(O,T,P),function(){I((0,f.BV)())}}),[I,O]);var A=(0,o.useCallback)((function(n){N.length-1===n?g.Z.clickButton(t,0):g.Z.clickButton(t,1,O),g.Z.hideDialog(t)}),[N,t,O]),k=(0,o.useCallback)((function(n){n+1!==O&&j(n+1)}),[O]),w=(0,o.useMemo)((function(){var n=[];return(0,i.Z)(new Array(R)).forEach((function(e,t){n.push({text:(t+1).toString()})})),{currentIndex:O-1,list:n,onClickItem:k,isDisable:!1,inputWidth:145,scrollTop:v}}),[k,O,R,v]),U=(0,o.useCallback)((function(n){URL.revokeObjectURL(n.currentTarget.src)}),[]);return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("div",{className:c.Z.popup_contents,children:(0,m.jsx)("table",{className:c.Z.form_table,children:(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,m.jsx)(l.Z,{label:"DLG_SLIDE_ACTIONSETTING_PREVIEW"})}),(0,m.jsx)("td",{children:(0,m.jsx)(p.r,(0,a.Z)({},w))})]}),(0,m.jsx)("tr",{children:(0,m.jsx)("td",{className:c.Z.thumbnail,colSpan:2,style:{height:"".concat(P,"px"),textAlign:"center",backgroundColor:"#dcdcdc"},children:(0,m.jsx)("img",{alt:"",src:Z,style:{objectFit:"contain"},onLoad:U,draggable:!1})})})]})})}),(0,m.jsx)(s.Z,{buttonLabels:N,onClick:A})]})}},820371:function(n,e,t){t.d(e,{$T:function(){return I},Be:function(){return _},DM:function(){return N},FK:function(){return x},KT:function(){return C},ce:function(){return E},oK:function(){return v}});var a=t(601413),i=t(426373),r=t(135323),o=t(981142),u=t(625477),c=t(877703),s=t(628264),l=t(101922),g=t(53110),d=t(416031),f={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},h=(0,i.oM)({name:"page",initialState:f,reducers:{setPageSize:function(n,e){var t=e.payload,a=t.pageWidth,i=t.pageHeight;n.pageWidth=a,n.pageHeight=i,n.pageRatio=i>0?i/a:0},setPageNumber:function(n,e){var t=e.payload,a=t.currentPage,i=t.totalPage;g.tq?(n.currentPage===a&&n.totalPage===i||(n.isShowingPageInfo=!0),R()):n.isShowingPageInfo=!0,n.currentPage=a,n.totalPage=i,n.isFirstPage=1===a,n.isLastPage=a===i},setIsShowPresentationEndingConfirm:function(n,e){n.isShowPresentationEndingConfirm=e.payload},setIsShowingPageInfo:function(n,e){n.isShowingPageInfo=e.payload},setIsShowingPageNavigation:function(n,e){n.isShowingPageNavigation=e.payload}},extraReducers:function(n){n.addCase(l.qp,(function(n){n.isShowingPageInfo=!g.tq})),n.addCase(s.FZ,(function(n,e){if(!e.payload)return(0,a.Z)({},f)}))}}),p=h.actions,b=p.setPageSize,m=p.setPageNumber,T=p.setIsShowPresentationEndingConfirm,P=p.setIsShowingPageInfo,_=p.setIsShowingPageNavigation;e.ZP=h.reducer;var I=(0,r.P1)((function(n){return n.page}),(function(n){return n})),N=function(){return(0,u.RU)("updatePageSizeThunk",(function(n){var e=o.o.getPageInfo(1),t=e.nPageWidth,a=e.nPageHeight;n(b({pageWidth:t,pageHeight:a}))}))},E=function(){return(0,u.RU)("updatePageNumberThunk",(function(n){var e=o.o.getConfig(),t=e.nCurPage,a=e.nTotalPages;n(m({currentPage:t,totalPage:a}))}))},C=function(n,e){return(0,u.RU)("updatePageMoveThunk",(function(t,a){var i=a().page.currentPage;t(m({currentPage:n,totalPage:e})),t((0,c.Ml)([i,n]))}))},v=function(n){return(0,u.RU)("setIsShowPresentationEndingConfirmThunk",(function(e){e(T(n))}))},R=(0,d.debounce)((function(){(0,u.Ce)(P(!1))}),2e3),x=(0,d.debounce)((function(){(0,u.Ce)(_(!1))}),2e3)},104994:function(n,e,t){t.d(e,{BV:function(){return c},Fq:function(){return u},wN:function(){return s}});var a=t(426373),i=t(135323),r=(0,a.oM)({name:"slideActionPage",initialState:{pageThumbnail:{}},reducers:{setActionThumbnail:function(n,e){n.pageThumbnail=e.payload},clearActionThumbnail:function(n){n.pageThumbnail={}}}}),o=r.actions,u=o.setActionThumbnail,c=o.clearActionThumbnail;e.ZP=r.reducer;var s=(0,i.P1)((function(n){return n.slideActionPage}),(function(n){return n}))},877703:function(n,e,t){t.d(e,{A7:function(){return D},Cq:function(){return E},Hq:function(){return P},Ml:function(){return S},Tb:function(){return v},Tz:function(){return _},XQ:function(){return I},ZB:function(){return C},Zm:function(){return A},aG:function(){return Z},pL:function(){return O},yE:function(){return N},z_:function(){return j}});var a=t(601413),i=t(426373),r=t(135323),o=t(416031),u=t(625477),c=t(628264),s=t(981142),l=t(820371),g=t(588567),d=t(735622),f=t(995124),h=t(361688),p={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},b=(0,i.oM)({name:"slideThumbnail",initialState:p,reducers:{setThumbnailSize:function(n,e){var t=e.payload,a=t.width,i=t.height;n.width=a,n.height=i},setThumbnailItem:function(n,e){var t=e.payload,a=t.pageNumber,i=t.thumbnailItem;n.thumbnails[a]=i},unmountThumbnail:function(n,e){var t=e.payload;delete n.thumbnails[t]},clearThumbnails:function(n){},setIsResizing:function(n,e){n.isResizing=e.payload},setIsPageDrag:function(n,e){var t=e.payload;n.isPageDrag=t,!t&&(n.pageDropTarget=void 0)},setPageDropTarget:function(n,e){n.pageDropTarget=e.payload}},extraReducers:function(n){n.addCase(c.FZ,(function(n,e){if(!e.payload)return(0,a.Z)({},p)}))}}),m=b.actions.clearThumbnails,T=b.actions,P=T.setThumbnailSize,_=T.setThumbnailItem,I=T.unmountThumbnail,N=T.setIsResizing,E=T.setIsPageDrag,C=T.setPageDropTarget;e.ZP=b.reducer;var v=(0,r.P1)((function(n){return n.slideThumbnail}),(function(n){return n})),R=function(n,e,t,a){if(a||s.o.isPageModified(n)){var i=(0,u.qm)(h.CI),r=4*e*i,o=4*t*i;s.o.slideObjStartEx(r,o,n)}},x=function(n,e){return(0,u.RU)("requestSlideThumbnailFromToThunk",(function(t,a){var i=a(),r=i.slideThumbnail,o=r.width,u=r.height,c=i.page.totalPage;if(o&&u&&c>0&&n>=1&&e<=c)for(var s=n;s<=e;s+=1)R(s,o,u,!0)}))},S=function(n){return(0,u.RU)("requestSlideThumbnailListThunk",(function(e,t){var a=n.length;if(a>0){var i=t(),r=i.slideThumbnail,o=r.width,u=r.height,c=i.page.totalPage;if(o&&u)for(var s=0;s<a;s+=1){var l=n[s];l>=1&&l<=c&&R(l,o,u,!0)}}}))},D=function(n){return(0,u.RU)("requestSlideThumbnailAllThunk",(function(e,t){var a=t(),i=a.slideThumbnail,r=i.width,o=i.height,u=a.page.totalPage;if(n&&e(m()),r&&o&&u>0)for(var c=function(n){setTimeout((function(){R(n,r,o,!0)}))},s=1;s<=u;s+=1)c(s)}))},O=(0,o.debounce)((function(){var n=(0,u.qm)(l.$T).currentPage,e=(0,u.qm)(v),t=e.width,a=e.height;t&&a&&n>0&&R(n,t,a)}),500),j=function(n){var e=n.nAction,t=n.stListInfo,a=t.nPageCnt,i=t.pPageList;switch(e){case g.jar.eBR_UNREDO_ACTION_NONE:(0,u.Ce)((0,l.DM)()),(0,u.Ce)((0,l.ce)());break;case g.jar.eBR_UNREDO_ACTION_ADD:case g.jar.eBR_UNREDO_ACTION_DELETE:(0,u.Ce)((0,l.ce)());break;case g.jar.eBR_UNREDO_ACTION_MOVE:var r=a>0?i[0]:0,o=a>1?i[a-1]:r,c=Math.min(r,o),s=Math.max(r,o);(0,u.Ce)(x(c,s));break;case g.jar.eBR_UNREDO_ACTION_CHANGE:case g.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case g.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,u.Ce)(S(i));break;case g.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case g.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case g.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,u.Ce)(D());case g.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case g.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case g.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case g.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},Z=function(){return(0,u.RU)("slidePageDropThunk",(function(n,e){var t=e(),i=t.page,r=t.slideThumbnail,u=i.currentPage,c=r.pageDropTarget;if(u>0&&!(0,o.isNil)(c)&&u!==c){var l=Math.min(c,u),d=Math.max(c,u);s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,g.zUw)()),{},{nType:g.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:c,nSectionIndex:0})),s.o.movePage(g.ZbX.eEV_MOVE_SETPAGE,c),n(x(l,d))}}))},A=function(){return(0,u.RU)("slidePageDeleteThunk",(function(n,e){var t=e().page,i=t.totalPage,r=t.currentPage;r>0&&(i>1?s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,g.zUw)()),{},{nType:g.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:r})):d.Z.showDialog({dialogId:f.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}}}]);