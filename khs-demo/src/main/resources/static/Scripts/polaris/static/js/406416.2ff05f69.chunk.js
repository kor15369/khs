(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[406416],{789589:function(t,e,n){"use strict";n.d(e,{Z:function(){return D}});var r,a=n(747313),i=n(180252),c=n(135323),o=n(837490),s=n(808643),u=n(652928),l=n(768895),f=n(601413),h=n(870885),g=n(944925),v=n(361688),p=n(711106),d=n(511173),m=n(246775),M=n(346417),L=["isMarginEditable"];function x(t){var e=t.type,n=(0,i.v9)(l.Y_),c=n.isMarginEditable,s=(0,g.Z)(n,L),u=(0,a.useMemo)((function(){switch(e){case r.left:return{width:"".concat(s.left,"px")};case r.right:return{width:"".concat(s.right,"px")};case r.top:return{height:"".concat(s.top,"px")};case r.bottom:return{height:"".concat(s.bottom,"px")}}}),[e,s]);return(0,M.jsx)("div",{className:"".concat(o.Z.page_margin," ").concat(o.Z[e]),style:u,children:c&&(0,M.jsx)(b,{type:e})})}!function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom"}(r||(r={}));var b=(0,m.Z)((function(t){var e=t.type,n=(0,i.I0)(),s=(0,i.v9)(v.LG),u=(0,i.v9)(function(t){switch(t){case r.left:case r.right:return(0,c.P1)(l.zL,(function(t){return{marginStart:t.margin.left,marginEnd:t.margin.right,pageStart:t.horizontal.pageLeft,pageEnd:t.horizontal.pageRight,scaleSize:t.horizontal.scale.size}}));case r.top:case r.bottom:return(0,c.P1)(l.zL,(function(t){return{marginStart:t.margin.top,marginEnd:t.margin.bottom,pageStart:t.vertical.pageTop,pageEnd:t.vertical.pageBottom,scaleSize:t.vertical.scale.size}}))}}(e)),g=u.marginStart,m=u.marginEnd,L=u.pageStart,x=u.pageEnd,b=u.scaleSize,w=(0,i.v9)(l.lZ).indentOffset,_=(0,a.useState)(!1),Z=(0,h.Z)(_,2),y=Z[0],z=Z[1];(0,a.useEffect)((function(){switch(e){case r.left:case r.right:n(y?(0,p.Gi)(o.Z.ruler_margin_horizontal_drag):(0,p.iQ)(o.Z.ruler_margin_horizontal_drag));break;case r.top:case r.bottom:n(y?(0,p.Gi)(o.Z.ruler_margin_vertical_drag):(0,p.iQ)(o.Z.ruler_margin_vertical_drag))}}),[n,y,e]);var S=(0,a.useCallback)((function(t,n){var a=x-L,i=a-(w.leftEnd+w.right+b);switch(e){case r.left:var c=t-(s.left+L);return c=Math.max(c,0),c=Math.min(c,a-m),c=Math.min(c,i-m);case r.right:var o=s.left+x-t;return o=Math.max(o,0),o=Math.min(o,a-g),o=Math.min(o,i-g);case r.top:var u=n-(s.top+L);return u=Math.max(u,0),u=Math.min(u,a-m);case r.bottom:var l=s.top+x-n;return l=Math.max(l,0),l=Math.min(l,a-g)}}),[e,s,L,x,g,m,w,b]),k=(0,a.useMemo)((function(){return{onMouseDrag:function(t){!y&&z(!0);var a=t.clientX,i=t.clientY,c=S(a,i);switch(e){case r.left:n((0,l.KY)({left:c}));break;case r.right:n((0,l.KY)({right:c}));break;case r.top:n((0,l.KY)({top:c}));break;case r.bottom:n((0,l.KY)({bottom:c}))}},onMouseDrop:function(){switch(y&&z(!1),e){case r.left:n((0,l.bg)({left:g}));break;case r.right:n((0,l.bg)({right:m}));break;case r.top:n((0,l.bg)({top:g}));break;case r.bottom:n((0,l.bg)({bottom:m}))}}}}),[n,y,e,S,g,m]),j=(0,d.Ek)(k),E=(0,h.Z)(j,2)[1];return(0,M.jsx)("div",(0,f.Z)({className:o.Z.indicator},E))}),(function(t){return t===u.n_.word||t===u.n_.hwp})),w=n(100457),_=function(t){return(0,c.P1)(l.zL,(function(e){return t?e.horizontal.scale:e.vertical.scale}))};function Z(t){var e=t.type,n="horizontal"===e,r=(0,i.v9)(_(n)),c=r.positive,s=r.negative,u=r.position,l=(0,a.useMemo)((function(){for(var t=[],n=s;n>0;n-=1)t.push((0,M.jsx)(z,{type:e,number:n},"negative_".concat(n)));for(var r=0;r<=c;r+=1)t.push((0,M.jsx)(z,{type:e,number:r},"positive_".concat(r)));return t}),[e,s,c]);return(0,M.jsx)("div",{className:o.Z.scale_bar,children:(0,M.jsx)("div",{className:o.Z.scale_inner,style:{left:n?"".concat(u,"px"):void 0,top:n?void 0:"".concat(u,"px")},children:l})})}var y=35;function z(t){var e=t.type,n=t.number,r="horizontal"===e,c=(0,i.v9)(_(r)).size,s=(0,i.v9)(w.Op).currentZoom,u=(0,a.useMemo)((function(){return s>=y}),[s]);return(0,M.jsx)("div",{className:o.Z.scale,style:{width:r?"".concat(c,"px"):void 0,height:r?void 0:"".concat(c,"px")},children:u&&(0,M.jsx)("span",{style:{lineHeight:r?void 0:"".concat(c,"px")},children:n})})}var S=n(459551);function k(){var t=(0,i.v9)(l.lZ),e=t.isIndentShow,n=t.dragTarget,r=(0,i.v9)(S.hz).docType,a=o.Z.ruler_indent_bar;return n&&(a="".concat(a," ").concat(o.Z[n])),e?(0,M.jsxs)("div",{className:a,children:[(0,M.jsx)(E,{type:l.L8.first}),(0,M.jsx)(E,{type:l.L8.left}),(0,M.jsx)(E,{type:l.L8.left_all}),r===u.n_.hwp||r===u.n_.word?(0,M.jsx)(E,{type:l.L8.right}):null]}):null}var j=function(t){return(0,c.P1)(l.zL,(function(t){return{pageLeft:t.horizontal.pageLeft,pageRight:t.horizontal.pageRight,scaleSize:t.horizontal.scale.size,marginLeft:t.margin.left,marginRight:t.margin.right}}))};function E(t){var e=t.type,n=(0,i.I0)(),r=(0,i.v9)(v.LG),c=(0,i.v9)(l.lZ),s=c.indentOffset,u=c.firstLine,g=c.leftMargin,m=c.rightMargin,L=(0,i.v9)(j(!0)),x=L.pageLeft,b=L.pageRight,w=L.marginLeft,_=L.marginRight,Z=L.scaleSize,y=(0,a.useRef)(),z=(0,a.useState)(!1),S=(0,h.Z)(z,2),k=S[0],E=S[1];(0,a.useEffect)((function(){k?(n((0,p.Gi)(o.Z.ruler_indent_drag)),n((0,l.cc)(e))):(n((0,p.iQ)(o.Z.ruler_indent_drag)),n((0,l.cc)(void 0)))}),[n,e,k]);var T=(0,a.useCallback)((function(t){var n=b-x,a=s.leftStart,i=s.leftEnd,c=s.first,o=s.right,u=n-(w+_+Z);switch(e){case l.L8.first:case l.L8.left:var f=t-(r.left+x+w);return f=Math.max(f,-w),f=Math.min(f,n-w),f=Math.min(f,u-o);case l.L8.left_all:var h=t-(r.left+x+w),g=i-a;return a===c?(h=Math.max(h,-(w-g)),h=Math.min(h,n-w),h=Math.min(h,u-o)):(h=Math.max(h,-w),h=Math.min(h,n-w),h=Math.min(h,u-o-g)),h;case l.L8.right:var v=r.left+b-_-t;return v=Math.max(v,-_),v=Math.min(v,n-_),v=Math.min(v,u-i)}}),[e,r,x,b,w,_,s,Z]),D=(0,a.useMemo)((function(){return{onMouseDown:function(){!k&&E(!0),y.current={firstLine:u,leftMargin:g,rightMargin:m,offsetFirst:s.first,offsetLeft:s.left}},onMouseDrag:function(t){var r=y.current;if(r){var a=T(t.clientX);switch(e){case l.L8.first:var i=a-r.offsetLeft;n((0,l.Bm)({firstLine:i,leftMargin:i>0?a-i:a,rightMargin:r.rightMargin}));break;case l.L8.left:var c=a-r.offsetFirst;n((0,l.Bm)({firstLine:-c,leftMargin:c>0?a-c:a,rightMargin:r.rightMargin}));break;case l.L8.left_all:var o=a-r.offsetLeft;n((0,l.Bm)({firstLine:r.firstLine,leftMargin:r.leftMargin+o,rightMargin:r.rightMargin}));break;case l.L8.right:n((0,l.Bm)({firstLine:r.firstLine,leftMargin:r.leftMargin,rightMargin:a}))}}},onMouseDrop:function(){switch(k&&E(!1),y.current=void 0,e){case l.L8.first:case l.L8.left:case l.L8.left_all:n((0,l.CU)({firstLine:u,leftMargin:g}));break;case l.L8.right:n((0,l.CU)({rightMargin:m}))}},onMouseUp:function(){k&&E(!1),y.current=void 0}}}),[n,k,e,T,s,u,g,m]),R=(0,d.Ek)(D),U=(0,h.Z)(R,2)[1],N=(0,a.useMemo)((function(){switch(e){case l.L8.first:return{left:"".concat(w+s.first,"px")};case l.L8.left:case l.L8.left_all:return{left:"".concat(w+s.left,"px")};case l.L8.right:return{right:"".concat(_+s.right,"px")}}}),[e,w,_,s]);return(0,M.jsx)("div",(0,f.Z)({className:"".concat(o.Z.indent," ").concat(o.Z[e]),style:N},U))}function T(){var t=(0,i.v9)(v.LG),e=(0,i.v9)(l.lZ),n=e.dragTarget,r=e.indentOffset,c=(0,i.v9)(j(!0)),s=c.pageLeft,u=c.pageRight,f=c.marginLeft,h=c.marginRight,g=(0,a.useMemo)((function(){switch(n){case l.L8.first:return"".concat(s+f+r.first,"px");case l.L8.left:case l.L8.left_all:return"".concat(s+f+r.left,"px");case l.L8.right:return"".concat(u-h-r.right+1,"px");default:return}}),[n,s,u,f,h,r]);return(0,M.jsx)("div",{className:o.Z.ruler_guideline,style:{display:n?void 0:"none",height:"".concat(t.height,"px"),left:g}})}function D(t){return(0,M.jsxs)("div",{className:o.Z.section_ruler_vertical,children:[(0,M.jsx)(R,{type:"vertical"}),(0,M.jsxs)("div",{className:o.Z.section_ruler_horizontal,children:[(0,M.jsx)(R,{type:"horizontal"}),(0,M.jsx)(T,{}),t.children]})]})}var R=(0,s.Z)((function(t){var e=t.type,n="horizontal"===e,a=(0,i.v9)(function(t){return(0,c.P1)(l.zL,(function(e){return{isRulerShow:e.isChecked,position:(t?e.horizontal.pageLeft:e.vertical.pageTop)-1,size:t?e.horizontal.pageWidth:e.vertical.pageHeight}}))}(n)),s=a.isRulerShow,u=a.position,f=a.size,h="".concat(o.Z.ruler_area," ").concat(o.Z[e]);return!s&&(h="".concat(h," ").concat(o.Z.hidden)),(0,M.jsx)("div",{className:h,children:(0,M.jsxs)("div",{className:o.Z.ruler_bar,style:{left:n?"".concat(u,"px"):void 0,width:n?"".concat(f,"px"):void 0,top:n?void 0:"".concat(u,"px"),height:n?void 0:"".concat(f,"px")},children:[(0,M.jsx)(x,{type:n?r.left:r.top}),(0,M.jsx)(x,{type:n?r.right:r.bottom}),(0,M.jsx)(Z,{type:e}),n&&(0,M.jsx)(k,{})]})})}),(function(t){return t===u.wO.edit}))},23719:function(t,e,n){!function(t,e){function n(){return n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n.apply(this,arguments)}var r="Left",a="Right",i="Up",c="Down",o={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},s={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},u="mousemove",l="mouseup",f="touchend",h="touchmove",g="touchstart";function v(t,e,n,o){return t>e?n>0?a:r:o>0?c:i}function p(t,e){if(0===e)return t;var n=Math.PI/180*e;return[t[0]*Math.cos(n)+t[1]*Math.sin(n),t[1]*Math.cos(n)-t[0]*Math.sin(n)]}function d(t,e){var r=function(e){e&&"touches"in e&&e.touches.length>1||t((function(t,r){r.trackMouse&&(document.addEventListener(u,a),document.addEventListener(l,o));var i="touches"in e?e.touches[0]:e,c=p([i.clientX,i.clientY],r.rotationAngle);return n({},t,s,{initial:[].concat(c),xy:c,start:e.timeStamp||0})}))},a=function(e){t((function(t,r){if("touches"in e&&e.touches.length>1)return t;var a="touches"in e?e.touches[0]:e,i=p([a.clientX,a.clientY],r.rotationAngle),c=i[0],o=i[1],s=c-t.xy[0],u=o-t.xy[1],l=Math.abs(s),f=Math.abs(u),h=(e.timeStamp||0)-t.start,g=Math.sqrt(l*l+f*f)/(h||1),d=[s/(h||1),u/(h||1)];if(l<r.delta&&f<r.delta&&!t.swiping)return t;var m=v(l,f,s,u),M={absX:l,absY:f,deltaX:s,deltaY:u,dir:m,event:e,first:t.first,initial:t.initial,velocity:g,vxvy:d};M.first&&r.onSwipeStart&&r.onSwipeStart(M),r.onSwiping&&r.onSwiping(M);var L=!1;return(r.onSwiping||r.onSwiped||"onSwiped"+m in r)&&(L=!0),L&&r.preventDefaultTouchmoveEvent&&r.trackTouch&&e.cancelable&&e.preventDefault(),n({},t,{first:!1,eventData:M,swiping:!0})}))},i=function(e){t((function(t,r){var a;if(t.swiping&&t.eventData){a=n({},t.eventData,{event:e}),r.onSwiped&&r.onSwiped(a);var i="onSwiped"+a.dir;i in r&&r[i](a)}else r.onTap&&r.onTap({event:e});return n({},t,s,{eventData:a})}))},c=function(){document.removeEventListener(u,a),document.removeEventListener(l,o)},o=function(t){c(),i(t)},d=function(t,e){var n=function(){};if(t&&t.addEventListener){var c=[[g,r],[h,a],[f,i]];c.forEach((function(n){var r=n[0],a=n[1];return t.addEventListener(r,a,{passive:e})})),n=function(){return c.forEach((function(e){var n=e[0],r=e[1];return t.removeEventListener(n,r)}))}}return n},m={ref:function(e){null!==e&&t((function(t,r){if(t.el===e)return t;var a={};return t.el&&t.el!==e&&t.cleanUpTouch&&(t.cleanUpTouch(),a.cleanUpTouch=void 0),r.trackTouch&&e&&(a.cleanUpTouch=d(e,!r.preventDefaultTouchmoveEvent)),n({},t,{el:e},a)}))}};return e.trackMouse&&(m.onMouseDown=r),[m,d]}function m(t,e,r){var a={};return!e.trackTouch&&t.cleanUpTouch?(t.cleanUpTouch(),a.cleanUpTouch=void 0):e.trackTouch&&!t.cleanUpTouch&&t.el&&(a.cleanUpTouch=r(t.el,!e.preventDefaultTouchmoveEvent)),n({},t,a)}function M(t){var r=t.trackMouse,a=e.useRef(n({},s)),i=e.useRef(n({},o));i.current=n({},o,t);var c=e.useMemo((function(){return d((function(t){return a.current=t(a.current,i.current)}),{trackMouse:r})}),[r]),u=c[0],l=c[1];return a.current=m(a.current,i.current,l),u}t.DOWN=c,t.LEFT=r,t.RIGHT=a,t.UP=i,t.useSwipeable=M}(e,n(747313))}}]);