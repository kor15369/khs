"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[419958],{827611:function(e,t,n){n.d(t,{Z:function(){return l}});n(747313);var r=n(837490),i=n(307360),o=n(346417);function l(e){var t=e.buttonLabels,n=e.onClick,l=e.buttonDisableStates;return(0,o.jsx)("div",{className:r.Z.popup_btn_wrap,children:t.map((function(e,t){var s=!!l&&l[t];return(0,o.jsx)("button",{className:"".concat(r.Z.p_btn," ").concat(r.Z.normal),onClick:function(){return n(t)},disabled:s,children:(0,o.jsx)(i.Z,{label:e})},t)}))})}},419958:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var r=n(601413),i=n(747313),o=n(242982),l=n(870885),s=n(180252),a=n(837490),u=n(827611),c=n(260861),d=n(202265),h=n(700936),f=n(416031),p=n(392457),_=n(544477),m=n(346417);function b(e){var t=e.unitId,n=(0,s.I0)(),b=(0,h.Z)().formatMessage,v=(0,i.useRef)(null),y=(0,s.v9)((0,c.g)(0)),C=d.Z.getCurrentFilterMenu(),g=(0,i.useState)([]),k=(0,l.Z)(g,2),F=k[0],I=k[1],A=(0,i.useMemo)((function(){return(0,f.countBy)(F,(function(e){return e.bChecked}))}),[F]);(0,i.useEffect)((function(){var e=v.current;if(e&&!y&&n((0,c.iR)({depth:0,height:e.offsetHeight})),C){var t=[];t.push({filter:b({id:"AUTOFILTER_ALL"}),bChecked:C.checkedArray[0]>0});for(var r=4;r<C.titleArray.length;r+=1){var i=C.titleArray[r];i.length>0?t.push({filter:i,bChecked:C.checkedArray[r]>0}):t.push({filter:b({id:"AUTOFILTER_BLANK"}),bChecked:C.checkedArray[r]>0})}I([].concat(t))}return function(){y&&d.Z.setSheetAutoFilterButtonRelease()}}),[C,I,b,n,y]);var Z=(0,i.useCallback)((function(e,t){var n=(0,o.Z)(F),i=e.currentTarget.checked;if(n.splice(t,1,(0,r.Z)((0,r.Z)({},n[t]),{},{bChecked:i})),0===t)n=n.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{bChecked:i})}));else if(i){(0,f.countBy)(n,(function(e){return e.bChecked})).true===n.length-1&&n.splice(0,1,(0,r.Z)((0,r.Z)({},n[0]),{},{bChecked:!0}))}else n.splice(0,1,(0,r.Z)((0,r.Z)({},n[0]),{},{bChecked:!1}));I((0,o.Z)(n))}),[F]),S=(0,i.useCallback)((function(e){if(0===e)if(F[0].bChecked)d.Z.setSheetFilterCommand(1,["All"],A.true);else{for(var t=[],r=1;r<F.length;r+=1)if(0!==r&&F[r].bChecked){var i=b({id:"AUTOFILTER_BLANK"});t.push(F[r].filter===i?"":F[r].filter)}d.Z.setSheetFilterCommand(0,t,A.true)}n((0,c.kp)())}),[n,F,A.true,b]),T=[{innerType:p.eE.List,itemUnitId:"auto_filter_sort_asc",displayType:p.np.Small},{innerType:p.eE.List,itemUnitId:"auto_filter_sort_desc",displayType:p.np.Small},{innerType:p.eE.List,itemUnitId:"auto_filter_clear",displayType:p.np.Small,hasDivider:!0}];"Ascending"!==C.titleArray[1]&&(T[0].itemUnitId="auto_filter_sort_asc_n"),"Descending"!==C.titleArray[2]&&(T[1].itemUnitId="auto_filter_sort_desc_n");var x={parentUnitId:t,unitList:T},w={buttonLabels:["MSG_BOX_OK","MSG_BOX_CANCEL"],buttonDisableStates:[void 0===A.true,!1],onClick:S};return(0,m.jsx)(i.Fragment,{children:(0,m.jsxs)("div",{ref:v,children:[(0,m.jsxs)("div",{className:a.Z.popup_contents,children:[(0,m.jsx)("div",{className:"".concat(a.Z.sub_box," ").concat(a.Z.type02),style:{display:"flex",flexFlow:"column nowrap",width:""},children:(0,m.jsx)(_.Z,(0,r.Z)({},x))}),(0,m.jsx)("div",{className:a.Z.left_margin,children:(0,m.jsx)("div",{className:"".concat(a.Z.scroll_box," ").concat(a.Z.chk_list," ").concat(a.Z.mt5),children:F.map((function(e,t){var n=e.filter,r=e.bChecked;return(0,m.jsxs)("label",{className:"".concat(a.Z.chk_label),children:[(0,m.jsx)("input",{type:"checkbox",checked:r,onChange:function(e){return Z(e,t)}}),(0,m.jsx)("span",{children:n})]},t)}))})})]}),(0,m.jsx)(u.Z,(0,r.Z)({},w))]})})}function v(e){return"auto_filter"===e.unitId?(0,m.jsx)(b,(0,r.Z)({},e)):null}},202265:function(e,t,n){var r=n(974165),i=n(115861),o=n(215671),l=n(143144),s=n(416031),a=n(977917),u=n(981142),c=n(735622),d=n(625477),h=n(260861),f=n(494638),p=n(361688),_=n(53110),m=n(995124),b=n(588567),v=n(740918).Buffer,y=function(){function e(){(0,o.Z)(this,e),this.filterIconPosition=void 0,this.currentFilterMenu=void 0,this.filterIcons=["sheet_btn_filter_more_normal.png","sheet_btn_filter_more_pressed.png","sheet_btn_filter_sort_normal.png","sheet_btn_filter_sort_pressed.png","sheet_btn_filter_sortup_normal.png","sheet_btn_filter_sortup_pressed.png","sheet_btn_filter_sortdown_normal.png","sheet_btn_filter_sortdown_pressed.png","sheet_btn_sortup_normal.png","sheet_btn_sortup_pressed.png","sheet_btn_sortdown_normal.png","sheet_btn_sortdown_pressed.png"],this.filterIconPosition=null,this.currentFilterMenu={handleId:0,focusIndex:0,titleArray:[],fixedItemArray:[],checkedArray:[],secondMainType:0,firstFilterType:0,secondFilterType:0}}return(0,l.Z)(e,[{key:"initFilterIcon",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(this.filterIcons.map((function(e){return n(624099)("./".concat(e))})));case 3:t=e.sent,i=t.map((function(e){return v.from(e.default.replace(/.*base64,/,""),"base64")})),u.o.setAutofilterButtonConfigurationEx(i,this.filterIcons),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a.ZP.error("Filter icon load Error","[".concat(e.t0.message,"]"));case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentFilterMenu",value:function(){return this.currentFilterMenu}},{key:"sheetAutoFilter",value:function(){if(!u.o.isRunningAutoFilter()){var e="",t=u.o.getSortRange(!1).result;if(t===b.nCv.kPoErrInternal?e="IDS_DLG_EDIT_ERROR_SORT_RANGE":t===b.nCv.kPoErrSheetUnusedCommandAsCellMultiselection&&(e="IDS_MSG_SHEET_MULTISELECTION_CUT_ERROR"),""!==e)return void this.showAlert(e)}u.o.sheetFilter()}},{key:"sheetClearFilter",value:function(){var e=u.o.getCurrentSheetIndex();1===u.o.sheetIsEnableClearAdvancedFilter(e)?(u.o.sheetSetClearAdvancedFilter(e),u.o.reDraw()):this.setFilterClearReapply(["clear"])}},{key:"setFilterClearReapply",value:function(e){u.o.sheetFilterCommand(this.getCurrentFilterMenu().handleId,-1,1,e,1)}},{key:"setSheetFilterCommand",value:function(e,t,n){var r=this.currentFilterMenu,i=r.handleId,o=r.focusIndex;u.o.getAutoFilterFilteringAble(o)?u.o.sheetFilterCommand(i,o,e,t,n):this.showAlert("IDS_MSG_SHEET_FIND_REPLACE_SHEET_PROTECT")}},{key:"setSheetAutoFilterButtonRelease",value:function(){u.o.setSheetAutoFilterButtonRelease(),u.o.reDraw()}},{key:"onSheetAutoFilterMenu",value:function(e){var t=e.nHandleId,n=e.nFocusIndex,r=e.titleArray,i=e.isFixedItemArray,o=e.isCheckedArray,l=(e.nItemCount,e.nLeft),s=e.nTop,a=e.nRight,u=e.nBottom,c=e.nSecondMainType,f=e.nFirstFilterType,_=e.nSecondFilterType;this.currentFilterMenu={handleId:t,focusIndex:n,titleArray:r,fixedItemArray:i,checkedArray:o,secondMainType:c,firstFilterType:f,secondFilterType:_};var m=(0,d.qm)(p.CI);this.filterIconPosition={top:s/m,left:l/m,right:a/m,bottom:u/m},(0,d.Ce)((0,h.kp)())}},{key:"isShowAutoFilter",value:function(){var e=(0,d.qm)(h.vd),t=e.isShow,n=e.menuList;return t&&(0,s.some)(n,["id","auto_filter"])}},{key:"existSheetAutoFilterBtn",value:function(e,t){var n=u.o.getVisibleFilterButtonCount();if(n<=0)return!1;for(var r=u.o.getVisibleFilterButtonRange(n),i=0;i<n;i+=1)if(e>=r[i].left&&e<=r[i].right&&t>=r[i].top&&t<=r[i].bottom)return!0;return!1}},{key:"showAutoFilterDropdown",value:function(){var e=this.isShowAutoFilter();if(this.filterIconPosition&&!e){var t=_.UL.calculateAppBounding((0,d.qm)(p.LG)),n=t.top,r=260,i=f.M.getDropdownConfig("auto_filter");i&&i.dropdownWidth.length>0&&(r=Number.parseInt(i.dropdownWidth));var o=this.filterIconPosition.right-r-2;o<0&&(o=0);var l=n+this.filterIconPosition.bottom;return l>n+t.height/2&&(l=this.filterIconPosition.top-n-10),(0,d.Ce)((0,h.SP)({id:"auto_filter",commandName:"DummyCommand",top:l,left:o,depth:0})),this.filterIconPosition=null,!0}return!1}},{key:"showAlert",value:function(e){c.Z.showDialog({dialogId:m.O.COMMON_ALERT,bModal:!0,alertMsg:{label:e}})}}]),e}(),C=new y;t.Z=C}}]);