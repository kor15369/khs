"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[524834,846775],{846775:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});var r=t(215671),o=t(143144),a=t(957112),i=t(815e3),c=t(237683),u=t(977917),s=t(625477),l=t(361688),f=t(459551),p=t(159366),d=t(981142),m=t(588567),h=t(780386),g=t(735622),v=t(995124),w=t(652928),Z=t(53110),b=t(628264),P=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,p.mD)(e.name)?e.blob?x(e.name,e.blob).catch((function(e){return u.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):u.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):u.ZP.api.reject(n,"[Please include an extension in the name.]"):u.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):u.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return C()}},{key:"movePage",value:function(e){D(e)}},{key:"isReadOnlyDocument",value:function(){return y()}},{key:"getDocumentExtension",value:function(){return O()}}]),e}(),x=function(e,n){return new Promise((function(t,r){var o,a=(0,p.mD)(e);if(_(a)){c.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(a)),t(),o=null,c.Z.removeListener("onOpenComplete")})),c.Z.setListener("onLoadFail",(function(n){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(a)),r({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))}),o=null,c.Z.removeListener("onLoadFail")})),c.Z.setListener("onLoadForce",(function(){null!==o&&i(o,!0),o=null,c.Z.removeListener("onLoadForce")}));var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===a?h.Z.setOpenMode(m.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):h.Z.setOpenMode(m.ekp.ePRM_COMMON),h.Z.setDocData(n,a);var r=(0,s.qm)(l.LG),o=(0,s.qm)(l.CI);(0,Z.Vq)()?d.o.memoryOpenForViewerSDK(".".concat(a),e,e.byteLength,r.width*o,r.height*o):d.o.memoryOpen(".".concat(a),e,e.byteLength,r.width*o,r.height*o,t),(0,s.Ce)((0,b._j)(!1))},u=new FileReader;u.onload=function(){u.readyState===FileReader.DONE&&u.result instanceof ArrayBuffer&&(o=u.result,i(u.result))};var w=function(e){r({message:e,errorCode:-1,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})};u.onabort=function(){w("Reading the file is aborted. '".concat(u.error,"'."))},u.onerror=function(){w("Failed to read file. '".concat(u.error,"'."))},u.readAsArrayBuffer(n)}else g.Z.showDialog({dialogId:v.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(a,")")}},currentTabIndex:0},(function(){r({message:"This document format is not supported. '(.".concat(a,")'"),closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},C=function(){return{version:i.i8,formats:i.bd,licenseKey:a.C}},_=function(e){var n=(0,s.qm)(f.hz).docType,t=e.toLowerCase();if(n===w.n_.hwp){if(["hwp","hwpx"].includes(t))return!0}else if(n===w.n_.word){if(["doc","docx"].includes(t))return!0}else if(n===w.n_.sheet){if(["xls","xlsx","csv"].includes(t))return!0}else if(n===w.n_.slide&&["ppt","pptx"].includes(t))return!0;return!1},D=function(e){var n=e,t=d.o.getConfig().nTotalPages;n<1&&(n=1),n>t&&(n=t),d.o.movePage(m.ZbX.eEV_MOVE_SETPAGE,n)},y=function(){return h.Z.isProtectDoc()||h.Z.isReadOnlyDoc()},O=function(){return(0,s.qm)(f.hz).extension}},524834:function(e,n,t){t.r(n),t.d(n,{default:function(){return Z}});var r=t(974165),o=t(115861),a=t(215671),i=t(143144),c=t(179340),u=t(432269),s=t(237683),l=t(846775),f=t(981142),p=t(588567),d=t(735622),m=t(995124),h=t(977917),g=t(53110),v=t(442113),w=t(416031),Z=function(e){(0,c.Z)(t,e);var n=(0,u.Z)(t);function t(){return(0,a.Z)(this,t),n.apply(this,arguments)}return(0,i.Z)(t,[{key:"getDocumentInformation",value:function(){return b()}},{key:"exportAsImage",value:function(){return P().catch((function(e){return h.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}},{key:"printDocument",value:function(e,n){return x(e,n).catch((function(e){return h.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}}]),t}(l.default),b=function(){var e=f.o.getSummaryData(),n=e.szTitle,t=e.szAuthor,r=e.szModifiedBy,o=e.nWords,a=f.o.getWordCountStatistic(!0),i=a.nPageCnt,c=a.nWordCnt,u=a.nCharCnt,s=a.nCharWithoutSpaceCnt,l=a.nParaCnt,p=a.nLineCnt;return{title:n,author:t,modifiedBy:r,characters:s.toString(),characterBlank:u.toString(),words:o?null===o||void 0===o?void 0:o.toString():"",wordsSelection:c.toString(),lines:p.toString(),paragraphs:l.toString(),pages:i.toString(),manuscript:Math.ceil(c/200).toString()}},P=function(){return new Promise((function(e,n){var t=f.o.getConfig().nTotalPages,r=[],o=setTimeout((function(){r.length!==t&&n(new Error("\n                        The file is too large to print."))}),1e4);s.Z.setListener("onExportAsImage",(function(n,a){a&&(r[n-1]=a),r.length===t&&(e({blobs:r}),s.Z.removeListener("onExportAsImage"),clearTimeout(o))})),f.o.setPrint(p.e_4.BR_PRINT_PAGESIZE_A4,1,t,p.nXZ.PRINT_JPG_IMG,p.AJA.BR_PRINT_150)}))},x=function(e,n){return new Promise(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(o,a){var i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=function(){C(n).then((function(){o()})).catch((function(){a()}))},e?d.Z.showDialog({dialogId:m.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_PRINT_LAYOUT_ALERT_MESSAGE"},currentTabIndex:0},(function(){return i()})):i();case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},C=function(e){return new Promise(function(){var n=(0,o.Z)((0,r.Z)().mark((function n(t,a){var i,c,u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P();case 2:i=n.sent,c=i.blobs,Array.isArray(c)||a("Can't print pages."),(u=window.open(".".concat("/polaris","/print.html")))||a("Can't open new window for print"),(0,g.vP)(u,"load",(0,o.Z)((0,r.Z)().mark((function n(){var o,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=c.length,a=0;case 2:if(!(a<o)){n.next=8;break}return n.next=5,_(u,c[a],a+1,o,e);case 5:a+=1,n.next=2;break;case 8:t();case 9:case"end":return n.stop()}}),n)}))));case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},_=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n,t,a,i,c){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(o,u){var s,l,f,p,d,m,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=v.localeIntl.formatMessage,l=document.createElement("canvas"),f=l.getContext("2d"),p=793,d=1122,e.next=8,(0,g.hR)(t);case 8:if(m=e.sent,l.width=m.width,l.height=m.height,h=m.height>m.width,null===f||void 0===f||f.drawImage(m,0,0),!f||!c){e.next=16;break}return e.next=16,D(f,a,c);case 16:n.postMessage({status:"progress",image:l.toDataURL(),totalPage:i,curPage:a,width:h?p:d,height:h?d:p,waitingMsg:s({id:"PREPARING_TO_PRINT_MESSAGE"}),cancelText:s({id:"MSG_BOX_CANCEL"})},window.location.origin),a===i?setTimeout((function(){n.postMessage({status:"end"},window.location.origin),o()}),10):setTimeout((function(){o()}),10),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),u(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(n,t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(n,t,r,o,a){return e.apply(this,arguments)}}(),D=function(e,n,t){return new Promise(function(){var a=(0,o.Z)((0,r.Z)().mark((function o(a,i){var c,u,s,l,f,p,d,m;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t){r.next=3;break}return r.abrupt("return",a());case 3:c=0;case 4:if(!(c<t.length)){r.next=18;break}if(u=t[c],s=u.imageBlob,l=u.text,f=u.textSize,p=u.posX,d=u.posY,u.pageNumberToPrint.includes(n)){r.next=9;break}return r.abrupt("continue",15);case 9:if((0,w.isEmpty)(l)||(f&&(e.font="".concat(f,"px sans-serif")),e.fillText(l||"",p,d)),!(s&&s instanceof Blob)){r.next=15;break}return r.next=13,(0,g.hR)(s);case 13:m=r.sent,e.drawImage(m,p,d,m.width,m.height);case 15:c+=1,r.next=4;break;case 18:a(),r.next=24;break;case 21:r.prev=21,r.t0=r.catch(0),i(r.t0);case 24:case"end":return r.stop()}}),o,null,[[0,21]])})));return function(e,n){return a.apply(this,arguments)}}())}}}]);