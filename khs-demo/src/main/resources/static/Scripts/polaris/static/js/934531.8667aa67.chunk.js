"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[934531],{350169:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var i=t(870885),a=t(747313),o=t(180252),s=t(837490),u=t(494638),r=t(544477),f=t(448439),c=t(145729),d=t(392457),l=t(361688),p=t(346417);function h(e){var n=e.unitId,t=e.depth,h=e.posTop,v=(0,o.I0)(),m=(0,a.useRef)(null),g=(0,a.useState)(0),w=(0,i.Z)(g,2),b=w[0],y=w[1],I=(0,o.v9)(l.mP).height-h-3,C=!!(b>I),x={display:"flex",flexFlow:"column nowrap",width:"",overflow:C?"auto":"hidden",height:C?"".concat(I,"px"):""};(0,a.useEffect)((function(){var e=m.current;e&&y(e.offsetHeight);var t=u.M.getDropdownUnitConfig(n),i=t&&t.commandName||"",a=f.Z.getCommandInstance(i);a instanceof c.$Y&&(a.initUnitList(),a.initSelectedValue())}),[v,t,I,n]);var L=(0,a.useMemo)((function(){var e=u.M.getDropdownConfig(n);if(!e)return null;var t=u.M.getRibbonUnitConfig(n);if(t){var i=f.Z.getCommandInstance(t.commandName);if(i instanceof c.Py){var a=i.getValues(),o=[];a.forEach((function(e){o.push({innerType:d.eE.List,itemUnitId:e.unitId,displayType:e.displayType,hasDivider:e.hasDivider,isActivate:e.isActivate})})),e.unitList=o}}return e}),[n]);return L?(0,p.jsx)("div",{ref:m,className:s.Z.sub_box,style:x,children:(0,p.jsx)(r.Z,{unitList:L.unitList,parentUnitId:L.unitId})}):null}}}]);