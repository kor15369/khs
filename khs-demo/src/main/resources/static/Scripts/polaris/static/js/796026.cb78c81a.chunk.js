"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[796026,161308,846775,524834],{161308:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(215671),o=n(143144),i=n(237683),a=n(977917),u=n(625477),c=n(361688),s=n(459551),l=n(981142),f=n(588567),d=n(628264),m=n(769071),p=n(735622),g=n(995124),v=n(815e3),h=n(780386),w=n(159366),P=n(305054),C=n(382800),y=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"saveDocument",value:function(){return k().catch((function(e){return a.ZP.api.reject("The document could not be saved.","[".concat(e.message,"]"))}))}},{key:"isModified",value:function(){return I()}},{key:"getDocContentRect",value:function(){return b()}},{key:"getTitleBarRect",value:function(){return Z()}},{key:"getRibbonTabMenuRect",value:function(){return A()}},{key:"getRibbonBarRect",value:function(){return x()}},{key:"getViewMode",value:function(){return T()}},{key:"activeInput",value:function(){S()}},{key:"isProtectedDocument",value:function(){return h.Z.isPasswordDocument}},{key:"insertImage",value:function(e,t){}},{key:"insertHtmlData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l.o.insertHtmlData(t?f.vlz.CLIPDATA_HTML:f.vlz.CLIPDATA_STR,e),m.Z.focus("DocInputField"),C.Z.updateDrawCaret()}},{key:"insertString",value:function(e){l.o.insertString(e,f.v$l.BR_IME_COMPOSITING_RESULT)}},{key:"getMarkString",value:function(){return l.o.getMarkString()}},{key:"getCaretInfo",value:function(){var e=l.o.getCaretInfoFromJson().nCaretStatus;return{status:(f.Bn1[e]||"").replaceAll("BR_","").toLowerCase(),objectType:P.Z.getObjectType(),objectCount:P.Z.getObjectCount()}}},{key:"getFrameToImageBlob",value:function(e){return R(e)}},{key:"downloadSelectFrame",value:function(e,t){_(e,t)}},{key:"getHtmlTextContent",value:function(e){return M(e)}}]),e}(),k=function(){return new Promise((function(e,t){var n=(0,u.qm)(s.hz),r=n.extension,o=n.docName;if(i.Z.setListener("onSaveDocument",(function(n,a){if(n===f.WbN.kPoProcessSucess&&a)if("hwpx"===r){var u="".concat(o.replace(new RegExp(".".concat(r,"$")),".hwp"));e({name:u,blob:a})}else e({name:o,blob:a});else t(new Error("Error ".concat(n)));i.Z.removeListener("onSaveDocument")})),r&&"csv"===r.toLowerCase()&&!0===v.ZP.get("isShowAlertDialogForCSVSaving"))p.Z.showDialog({dialogId:g.O.CONFIRM_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_CSV_SAVE_INFO"},currentTabIndex:0},(function(e){0===e?l.o.saveDocument(r):t(new Error("Canceled by user."))}));else{var a=r;"hwpx"===r&&(a="hwp"),l.o.saveDocument(a)}}))},I=function(){return l.o.isDocumentModified()},b=function(){return(0,u.qm)(c.SV)},Z=function(){return(0,u.qm)(c.IU)},A=function(){return(0,u.qm)(c.ms)},x=function(){return(0,u.qm)(c.qr)},T=function(){return(0,u.qm)(d.p_).viewMode},S=function(){m.Z.focus("DocInputField")},R=function(e){if(P.Z.isImageObject()&&1===P.Z.getObjectCount()){var t=(0,w.km)(e);return l.o.frameToImageBuffer(t)}return null},_=function(e,t){var n=(0,w.km)(t),r=l.o.frameToImageBuffer(n),o=document.createElement("a");o.style.display="none",document.body.appendChild(o);var i=window.URL.createObjectURL(r);o.href=i,o.download="".concat(e,".").concat(t),o.click(),window.URL.revokeObjectURL(i),document.body.removeChild(o)},M=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=t.children,r="",o=0;o<n.length;o+=1){var i;"STYLE"!==n[o].tagName&&(r+=null===(i=n[o].textContent)||void 0===i?void 0:i.replace(/\s\s+/g,"\n"))}return r}},846775:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(215671),o=n(143144),i=n(957112),a=n(815e3),u=n(237683),c=n(977917),s=n(625477),l=n(361688),f=n(459551),d=n(159366),m=n(981142),p=n(588567),g=n(780386),v=n(735622),h=n(995124),w=n(652928),P=n(53110),C=n(628264),y=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"openDocument",value:function(e){var t="The document could not be opened.";return e?e.name?(0,d.mD)(e.name)?e.blob?k(e.name,e.blob).catch((function(e){return c.ZP.api.rejectOpenDocument("".concat(t," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):c.ZP.api.reject(t,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):c.ZP.api.reject(t,"[Please include an extension in the name.]"):c.ZP.api.reject(t,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):c.ZP.api.reject(t,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return I()}},{key:"movePage",value:function(e){Z(e)}},{key:"isReadOnlyDocument",value:function(){return A()}},{key:"getDocumentExtension",value:function(){return x()}}]),e}(),k=function(e,t){return new Promise((function(n,r){var o,i=(0,d.mD)(e);if(b(i)){u.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),n(),o=null,u.Z.removeListener("onOpenComplete")})),u.Z.setListener("onLoadFail",(function(t){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),r({message:"Loading failed '".concat(e,"'."),errorCode:t,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))}),o=null,u.Z.removeListener("onLoadFail")})),u.Z.setListener("onLoadForce",(function(){null!==o&&a(o,!0),o=null,u.Z.removeListener("onLoadForce")}));var a=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?g.Z.setOpenMode(p.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):g.Z.setOpenMode(p.ekp.ePRM_COMMON),g.Z.setDocData(t,i);var r=(0,s.qm)(l.LG),o=(0,s.qm)(l.CI);(0,P.Vq)()?m.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,r.width*o,r.height*o):m.o.memoryOpen(".".concat(i),e,e.byteLength,r.width*o,r.height*o,n),(0,s.Ce)((0,C._j)(!1))},c=new FileReader;c.onload=function(){c.readyState===FileReader.DONE&&c.result instanceof ArrayBuffer&&(o=c.result,a(c.result))};var w=function(e){r({message:e,errorCode:-1,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})};c.onabort=function(){w("Reading the file is aborted. '".concat(c.error,"'."))},c.onerror=function(){w("Failed to read file. '".concat(c.error,"'."))},c.readAsArrayBuffer(t)}else v.Z.showDialog({dialogId:h.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){r({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},I=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},b=function(e){var t=(0,s.qm)(f.hz).docType,n=e.toLowerCase();if(t===w.n_.hwp){if(["hwp","hwpx"].includes(n))return!0}else if(t===w.n_.word){if(["doc","docx"].includes(n))return!0}else if(t===w.n_.sheet){if(["xls","xlsx","csv"].includes(n))return!0}else if(t===w.n_.slide&&["ppt","pptx"].includes(n))return!0;return!1},Z=function(e){var t=e,n=m.o.getConfig().nTotalPages;t<1&&(t=1),t>n&&(t=n),m.o.movePage(p.ZbX.eEV_MOVE_SETPAGE,t)},A=function(){return g.Z.isProtectDoc()||g.Z.isReadOnlyDoc()},x=function(){return(0,s.qm)(f.hz).extension}},796026:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r,o=n(601413),i=n(974165),a=n(115861),u=n(215671),c=n(143144),s=n(179340),l=n(432269),f=n(416031),d=n(237683),m=n(161308),p=n(828387),g=n(981142),v=n(588567),h=n(442113),w=n(735622),P=n(995124),C=n(977917),y=n(780386),k=n(53110),I=n(625477),b=n(628264),Z=n(459551),A=n(361688),x=n(524834),T=n(815e3);!function(e){e.all="all",e.current_page="current_page",e.custom_range="custom_range"}(r||(r={}));var S=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).commonAPI=void 0,e.wordControlAPI=void 0,e.commonAPI=new m.default,e.wordControlAPI=new p.default,e}return(0,c.Z)(n,[{key:"saveDocument",value:function(){return this.commonAPI.saveDocument()}},{key:"isModified",value:function(){return this.commonAPI.isModified()}},{key:"getViewMode",value:function(){return this.commonAPI.getViewMode()}},{key:"activeInput",value:function(){return this.commonAPI.activeInput()}},{key:"getDocContentRect",value:function(){return this.commonAPI.getDocContentRect()}},{key:"getTitleBarRect",value:function(){return this.commonAPI.getTitleBarRect()}},{key:"getRibbonTabMenuRect",value:function(){return this.commonAPI.getRibbonTabMenuRect()}},{key:"getRibbonBarRect",value:function(){return this.commonAPI.getRibbonBarRect()}},{key:"isProtectedDocument",value:function(){return this.commonAPI.isProtectedDocument()}},{key:"insertHtmlData",value:function(e){return this.commonAPI.insertHtmlData(e)}},{key:"insertString",value:function(e){return this.commonAPI.insertString(e)}},{key:"getMarkString",value:function(){return this.commonAPI.getMarkString()}},{key:"getCaretInfo",value:function(){return this.commonAPI.getCaretInfo()}},{key:"getFrameToImageBlob",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"png";return this.commonAPI.getFrameToImageBlob(e)}},{key:"downloadSelectFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PoImage",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png";this.commonAPI.downloadSelectFrame(e,t)}},{key:"openNewDocument",value:function(){return R().catch((function(e){return C.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"getDocumentInformation",value:function(){return _()}},{key:"exportAsImage",value:function(){return M()}},{key:"printDocument",value:function(e,t){return O(e,t).catch((function(e){return C.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"exportAsPDF",value:function(e){var t=e.target,n=e.isPdfAExport,o=e.customRange,i="The document could not be exported as pdf.";return(0,f.isNil)(t)||"string"!==typeof t||!(t in r)?C.ZP.api.reject(i,"['target' argument is invalid . Please set a valid 'target' argument and try again.]"):(0,f.isNil)(n)||"boolean"!==typeof n?C.ZP.api.reject(i,"['isPdfAExport' argument is invalid . Please set a valid 'target' argument and try again.]"):t!==r.custom_range||!(0,f.isNil)(o)&&"string"===typeof o?E(e).catch((function(e){return C.ZP.api.reject(i,"[".concat(e.message,"]"))})):C.ZP.api.reject(i,"['customRange' argument is invalid . Please set a valid 'customRange' argument and try again.]")}},{key:"SetCurFieldProtectCell",value:function(e){var t=g.o.getTableAtt();return t.bProtected=e?1:0,(0,k.ft)(t,"nMask",v.$Nl.BR_TABLE_PROPERTY_PROTECTED),g.o.setUndoContinue(!0),g.o.setTableAtt(t),g.o.setUndoContinue(!1),!0}},{key:"insertImage",value:function(e,t){try{return D(e,t)}catch(n){return C.ZP.api.reject("","[".concat(n.message,"]"))}}},{key:"insertHyperlink",value:function(e,t){L(e,t)}},{key:"CreateAction",value:function(e){return this.wordControlAPI.CreateAction(e)}},{key:"CreateSet",value:function(e){return this.wordControlAPI.CreateSet(e)}},{key:"Run",value:function(e){return this.wordControlAPI.Run(e)}},{key:"Clear",value:function(){return this.wordControlAPI.Clear()}},{key:"FieldExist",value:function(e){return this.wordControlAPI.FieldExist(e)}},{key:"GetCurFieldName",value:function(e){return this.wordControlAPI.GetCurFieldName(e)}},{key:"SetCurFieldName",value:function(e,t,n,r){return this.wordControlAPI.SetCurFieldName(e,t,n,r)}},{key:"GetFieldList",value:function(e,t){return this.wordControlAPI.GetFieldList(e,t)}},{key:"GetFieldText",value:function(e){return this.wordControlAPI.GetFieldText(e)}},{key:"PutFieldText",value:function(e,t){return this.wordControlAPI.PutFieldText(e,t)}},{key:"RenameField",value:function(e,t){return this.wordControlAPI.RenameField(e,t)}},{key:"CreateField",value:function(e,t,n){return this.wordControlAPI.CreateField(e,t,n)}},{key:"MoveToField",value:function(e,t,n,r){return this.wordControlAPI.MoveToField(e,t,n,r)}},{key:"MoveToFieldEx",value:function(e,t,n,r){return this.wordControlAPI.MoveToFieldEx(e,t,n,r)}},{key:"MovePos",value:function(e,t,n){return this.wordControlAPI.MovePos(e,t,n)}},{key:"InsertPicture",value:function(e,t,n,r,o,i,a,u){return this.wordControlAPI.InsertPicture(e,t,n,r,o,i,a,u)}},{key:"GetTextFile",value:function(e,t){return this.wordControlAPI.GetTextFile(e,t)}},{key:"GetPosBySet",value:function(){return this.wordControlAPI.GetPosBySet()}},{key:"GetTextBySet",value:function(e){return this.wordControlAPI.GetTextBySet(e)}},{key:"InitScan",value:function(e,t,n,r,o,i){return this.wordControlAPI.InitScan(e,t,n,r,o,i)}},{key:"ReleaseScan",value:function(){return this.wordControlAPI.ReleaseScan()}},{key:"CellShape",get:function(){return this.wordControlAPI.CellShape},set:function(e){this.wordControlAPI.CellShape=e}},{key:"CharShape",get:function(){return this.wordControlAPI.CharShape},set:function(e){this.wordControlAPI.CharShape=e}},{key:"EditMode",get:function(){return this.wordControlAPI.EditMode},set:function(e){this.wordControlAPI.EditMode=e}},{key:"CurFieldState",get:function(){return this.wordControlAPI.CurFieldState},set:function(e){this.wordControlAPI.CurFieldState=e}},{key:"ViewProperties",get:function(){return this.wordControlAPI.ViewProperties},set:function(e){this.wordControlAPI.ViewProperties=e}},{key:"setActiveLinkDomainList",value:function(e){T.ZP.setActiveLinkDomainList(e)}},{key:"getHtmlTextContent",value:function(e){return this.commonAPI.getHtmlTextContent(e)}}]),n}(x.default),R=function(){return new Promise(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,o,a,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,I.Ce)((0,Z.ge)("hwp"));try{r=(0,I.qm)(Z.hz),o=r.extension,a=(0,I.qm)(A.LG),u=(0,I.qm)(A.CI),d.Z.setListener("onOpenComplete",(function(){t(),d.Z.removeListener("onOpenComplete")})),y.Z.setOpenMode(v.ekp.ePRM_COMMON),g.o.newDocument(".".concat("hwpx"===o.toLowerCase()?"hwp":o),a.width*u,a.height*u),(0,I.Ce)((0,b._j)(!0))}catch(i){n(i)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},_=function(){var e=g.o.getSummaryData(),t=e.szTitle,n=e.szAuthor,r=e.szModifiedBy,o=e.nWords,i=g.o.getWordCountStatistic(!0),a=i.nPageCnt,u=i.nWordCnt,c=i.nCharCnt,s=i.nCharWithoutSpaceCnt,l=i.nParaCnt,f=i.nLineCnt;return{title:t,author:n,modifiedBy:r,characters:s.toString(),characterBlank:c.toString(),words:o?null===o||void 0===o?void 0:o.toString():"",wordsSelection:u.toString(),lines:f.toString(),paragraphs:l.toString(),pages:a.toString(),manuscript:Math.ceil(u/200).toString()}},M=function(){return new Promise((function(e,t){var n=g.o.getConfig().nTotalPages,r=[],o=setTimeout((function(){r.length!==n&&t(new Error("\n                        The file is too large to print."))}),1e4);d.Z.setListener("onExportAsImage",(function(t,i){i&&(r[t-1]=i),r.length===n&&(e({blobs:r}),d.Z.removeListener("onExportAsImage"),clearTimeout(o))})),g.o.setPrint(v.e_4.BR_PRINT_PAGESIZE_A4,1,n,v.nXZ.PRINT_JPG_IMG,v.AJA.BR_PRINT_150)}))},E=function(e){return new Promise((function(t,n){var o=e.target,i=e.isPdfAExport,a=e.customRange,u=(0,I.qm)(Z.hz),c=u.docName,s=u.extension;d.Z.setListener("onSaveDocument",(function(e,r){if(e===v.WbN.kPoProcessSucess&&r){var o="".concat(c.replace(new RegExp(".".concat(s,"$")),".pdf"));t({name:o,blob:r})}else n(new Error("Error ".concat(e)));d.Z.removeListener("onSaveDocument")}));var l=0,f=[];switch(o){case r.all:break;case r.current_page:var m=g.o.getConfig().nCurPage;l=1,f.push(m);break;case r.custom_range:if(!a)return;a.split(",").forEach((function(e){if(e.indexOf("-")>0){var t=e.split("-");if(2!==t.length)return;var n=parseInt(t[0]),r=parseInt(t[1]);if(isNaN(n)||isNaN(r))return;for(var o=n;o<=r;o+=1)f.push(o)}else{var i=parseInt(e);if(isNaN(i))return;f.push(i)}})),l=(f=Array.from(new Set(f))).length}g.o.saveDocument("pdf",v.dLw.BR_SAVE_OPTION_TEMP_SAVE,i,!1,l,f,!1,400)}))},D=function(e,t){return new Promise(function(){var n=(0,a.Z)((0,i.Z)().mark((function n(r,o){var a,u,c,s,l;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,k.Cq)(e);case 3:if((a=n.sent)instanceof ArrayBuffer){n.next=6;break}return n.abrupt("return");case 6:u=(null===t||void 0===t?void 0:t.width)||0,c=(null===t||void 0===t?void 0:t.height)||0,0,s=(null===t||void 0===t?void 0:t.posX)||0,l=(null===t||void 0===t?void 0:t.posY)||0,g.o.imageInsert(a,u,c,0,s,l),r(),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),o(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},L=function(e,t){if(!(0,f.isEmpty)(e)){var n=(0,o.Z)((0,o.Z)({},(0,v.Nuw)()),{},{nLinkType:v.QLl.EV_LINK_TO_URL,nRunType:v.Cuw.EV_LINK_RUNTYPE_MOUSE_CLICK,szHyperLink:e||"",szHyperText:t||""});g.o.setHyperLinkInfoFromJson(n)}},O=function(e,t){return new Promise(function(){var n=(0,a.Z)((0,i.Z)().mark((function n(r,o){var a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=function(){N(t).then((function(){r()})).catch((function(){o()}))},e?w.Z.showDialog({dialogId:P.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_PRINT_LAYOUT_ALERT_MESSAGE"},currentTabIndex:0},(function(){return a()})):a();case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},N=function(e){return new Promise(function(){var t=(0,a.Z)((0,i.Z)().mark((function t(n,r){var o,u,c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M();case 2:o=t.sent,u=o.blobs,Array.isArray(u)||r("Can't print pages."),(c=window.open(".".concat("/polaris","/print.html")))||r("Can't open new window for print"),(0,k.vP)(c,"load",(0,a.Z)((0,i.Z)().mark((function t(){var r,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=u.length,o=0;case 2:if(!(o<r)){t.next=8;break}return t.next=5,F(c,u[o],o+1,r,e);case 5:o+=1,t.next=2;break;case 8:n();case 9:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},F=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n,r,o,u){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(a,c){var s,l,f,d,m,p,g;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=h.localeIntl.formatMessage,l=document.createElement("canvas"),f=l.getContext("2d"),d=793,m=1122,e.next=8,(0,k.hR)(n);case 8:if(p=e.sent,l.width=p.width,l.height=p.height,g=p.height>p.width,null===f||void 0===f||f.drawImage(p,0,0),!f||!u){e.next=16;break}return e.next=16,B(f,r,u);case 16:t.postMessage({status:"progress",image:l.toDataURL(),totalPage:o,curPage:r,width:g?d:m,height:g?m:d,waitingMsg:s({id:"PREPARING_TO_PRINT_MESSAGE"}),cancelText:s({id:"MSG_BOX_CANCEL"})},window.location.origin),r===o?setTimeout((function(){t.postMessage({status:"end"},window.location.origin),a()}),10):setTimeout((function(){a()}),10),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),c(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),B=function(e,t,n){return new Promise(function(){var r=(0,a.Z)((0,i.Z)().mark((function r(o,a){var u,c,s,l,d,m,p,g;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n){r.next=3;break}return r.abrupt("return",o());case 3:u=0;case 4:if(!(u<n.length)){r.next=18;break}if(c=n[u],s=c.imageBlob,l=c.text,d=c.textSize,m=c.posX,p=c.posY,c.pageNumberToPrint.includes(t)){r.next=9;break}return r.abrupt("continue",15);case 9:if((0,f.isEmpty)(l)||(d&&(e.font="".concat(d,"px sans-serif")),e.fillText(l||"",m,p)),!(s&&s instanceof Blob)){r.next=15;break}return r.next=13,(0,k.hR)(s);case 13:g=r.sent,e.drawImage(g,m,p,g.width,g.height);case 15:u+=1,r.next=4;break;case 18:o(),r.next=24;break;case 21:r.prev=21,r.t0=r.catch(0),a(r.t0);case 24:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(e,t){return r.apply(this,arguments)}}())}},524834:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var r=n(974165),o=n(115861),i=n(215671),a=n(143144),u=n(179340),c=n(432269),s=n(237683),l=n(846775),f=n(981142),d=n(588567),m=n(735622),p=n(995124),g=n(977917),v=n(53110),h=n(442113),w=n(416031),P=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"getDocumentInformation",value:function(){return C()}},{key:"exportAsImage",value:function(){return y().catch((function(e){return g.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}},{key:"printDocument",value:function(e,t){return k(e,t).catch((function(e){return g.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}}]),n}(l.default),C=function(){var e=f.o.getSummaryData(),t=e.szTitle,n=e.szAuthor,r=e.szModifiedBy,o=e.nWords,i=f.o.getWordCountStatistic(!0),a=i.nPageCnt,u=i.nWordCnt,c=i.nCharCnt,s=i.nCharWithoutSpaceCnt,l=i.nParaCnt,d=i.nLineCnt;return{title:t,author:n,modifiedBy:r,characters:s.toString(),characterBlank:c.toString(),words:o?null===o||void 0===o?void 0:o.toString():"",wordsSelection:u.toString(),lines:d.toString(),paragraphs:l.toString(),pages:a.toString(),manuscript:Math.ceil(u/200).toString()}},y=function(){return new Promise((function(e,t){var n=f.o.getConfig().nTotalPages,r=[],o=setTimeout((function(){r.length!==n&&t(new Error("\n                        The file is too large to print."))}),1e4);s.Z.setListener("onExportAsImage",(function(t,i){i&&(r[t-1]=i),r.length===n&&(e({blobs:r}),s.Z.removeListener("onExportAsImage"),clearTimeout(o))})),f.o.setPrint(d.e_4.BR_PRINT_PAGESIZE_A4,1,n,d.nXZ.PRINT_JPG_IMG,d.AJA.BR_PRINT_150)}))},k=function(e,t){return new Promise(function(){var n=(0,o.Z)((0,r.Z)().mark((function n(o,i){var a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=function(){I(t).then((function(){o()})).catch((function(){i()}))},e?m.Z.showDialog({dialogId:p.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_PRINT_LAYOUT_ALERT_MESSAGE"},currentTabIndex:0},(function(){return a()})):a();case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},I=function(e){return new Promise(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n,i){var a,u,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y();case 2:a=t.sent,u=a.blobs,Array.isArray(u)||i("Can't print pages."),(c=window.open(".".concat("/polaris","/print.html")))||i("Can't open new window for print"),(0,v.vP)(c,"load",(0,o.Z)((0,r.Z)().mark((function t(){var o,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=u.length,i=0;case 2:if(!(i<o)){t.next=8;break}return t.next=5,b(c,u[i],i+1,o,e);case 5:i+=1,t.next=2;break;case 8:n();case 9:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},b=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,i,a,u){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(o,c){var s,l,f,d,m,p,g;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=h.localeIntl.formatMessage,l=document.createElement("canvas"),f=l.getContext("2d"),d=793,m=1122,e.next=8,(0,v.hR)(n);case 8:if(p=e.sent,l.width=p.width,l.height=p.height,g=p.height>p.width,null===f||void 0===f||f.drawImage(p,0,0),!f||!u){e.next=16;break}return e.next=16,Z(f,i,u);case 16:t.postMessage({status:"progress",image:l.toDataURL(),totalPage:a,curPage:i,width:g?d:m,height:g?m:d,waitingMsg:s({id:"PREPARING_TO_PRINT_MESSAGE"}),cancelText:s({id:"MSG_BOX_CANCEL"})},window.location.origin),i===a?setTimeout((function(){t.postMessage({status:"end"},window.location.origin),o()}),10):setTimeout((function(){o()}),10),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),c(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),Z=function(e,t,n){return new Promise(function(){var i=(0,o.Z)((0,r.Z)().mark((function o(i,a){var u,c,s,l,f,d,m,p;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n){r.next=3;break}return r.abrupt("return",i());case 3:u=0;case 4:if(!(u<n.length)){r.next=18;break}if(c=n[u],s=c.imageBlob,l=c.text,f=c.textSize,d=c.posX,m=c.posY,c.pageNumberToPrint.includes(t)){r.next=9;break}return r.abrupt("continue",15);case 9:if((0,w.isEmpty)(l)||(f&&(e.font="".concat(f,"px sans-serif")),e.fillText(l||"",d,m)),!(s&&s instanceof Blob)){r.next=15;break}return r.next=13,(0,v.hR)(s);case 13:p=r.sent,e.drawImage(p,d,m,p.width,p.height);case 15:u+=1,r.next=4;break;case 18:i(),r.next=24;break;case 21:r.prev=21,r.t0=r.catch(0),a(r.t0);case 24:case"end":return r.stop()}}),o,null,[[0,21]])})));return function(e,t){return i.apply(this,arguments)}}())}}}]);