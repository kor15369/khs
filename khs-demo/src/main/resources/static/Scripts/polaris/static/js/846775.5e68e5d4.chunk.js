"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[846775],{846775:function(e,n,o){o.r(n),o.d(n,{default:function(){return C}});var t=o(215671),r=o(143144),i=o(957112),a=o(815e3),c=o(237683),s=o(977917),u=o(625477),l=o(361688),f=o(459551),d=o(159366),m=o(981142),p=o(588567),h=o(780386),g=o(735622),D=o(995124),O=o(652928),v=o(53110),Z=o(628264),C=function(){function e(){(0,t.Z)(this,e)}return(0,r.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,d.mD)(e.name)?e.blob?L(e.name,e.blob).catch((function(e){return s.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):s.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):s.ZP.api.reject(n,"[Please include an extension in the name.]"):s.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):s.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return b()}},{key:"movePage",value:function(e){w(e)}},{key:"isReadOnlyDocument",value:function(){return y()}},{key:"getDocumentExtension",value:function(){return _()}}]),e}(),L=function(e,n){return new Promise((function(o,t){var r,i=(0,d.mD)(e);if(P(i)){c.Z.setListener("onOpenComplete",(function(){(0,u.Ce)((0,f.RY)(e)),(0,u.Ce)((0,f.Js)(i)),o(),r=null,c.Z.removeListener("onOpenComplete")})),c.Z.setListener("onLoadFail",(function(n){(0,u.Ce)((0,f.RY)(e)),(0,u.Ce)((0,f.Js)(i)),t({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))}),r=null,c.Z.removeListener("onLoadFail")})),c.Z.setListener("onLoadForce",(function(){null!==r&&a(r,!0),r=null,c.Z.removeListener("onLoadForce")}));var a=function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?h.Z.setOpenMode(p.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):h.Z.setOpenMode(p.ekp.ePRM_COMMON),h.Z.setDocData(n,i);var t=(0,u.qm)(l.LG),r=(0,u.qm)(l.CI);(0,v.Vq)()?m.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,t.width*r,t.height*r):m.o.memoryOpen(".".concat(i),e,e.byteLength,t.width*r,t.height*r,o),(0,u.Ce)((0,Z._j)(!1))},s=new FileReader;s.onload=function(){s.readyState===FileReader.DONE&&s.result instanceof ArrayBuffer&&(r=s.result,a(s.result))};var O=function(e){t({message:e,errorCode:-1,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})};s.onabort=function(){O("Reading the file is aborted. '".concat(s.error,"'."))},s.onerror=function(){O("Failed to read file. '".concat(s.error,"'."))},s.readAsArrayBuffer(n)}else g.Z.showDialog({dialogId:D.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){t({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},b=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},P=function(e){var n=(0,u.qm)(f.hz).docType,o=e.toLowerCase();if(n===O.n_.hwp){if(["hwp","hwpx"].includes(o))return!0}else if(n===O.n_.word){if(["doc","docx"].includes(o))return!0}else if(n===O.n_.sheet){if(["xls","xlsx","csv"].includes(o))return!0}else if(n===O.n_.slide&&["ppt","pptx"].includes(o))return!0;return!1},w=function(e){var n=e,o=m.o.getConfig().nTotalPages;n<1&&(n=1),n>o&&(n=o),m.o.movePage(p.ZbX.eEV_MOVE_SETPAGE,n)},y=function(){return h.Z.isProtectDoc()||h.Z.isReadOnlyDoc()},_=function(){return(0,u.qm)(f.hz).extension}}}]);