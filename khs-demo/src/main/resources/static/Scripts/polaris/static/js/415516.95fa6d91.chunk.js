"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[415516],{233474:function(e,n,t){t.d(n,{Z:function(){return c}});var a=t(215671),r=t(143144),i=t(179340),o=t(432269),l=t(145729),u=t(735622),s=t(995124),c=function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(){return(0,a.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"invoke",value:function(){u.Z.showDialog({dialogId:s.O.GOTO,bModal:!0,currentTabIndex:0})}}]),t}(l.mY)},415516:function(e,n,t){t.r(n),t.d(n,{default:function(){return Q}});var a=t(601413),r={GotoCommand:t(233474).Z},i=t(458345),o=t(215671),l=t(143144),u=t(179340),s=t(432269),c=t(145729),m=t(588567),d=t(981142),_=t(135323),f=t(473303),h=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;switch((0,o.Z)(this,t),a=n.call(this,e),e){case"FrameGroupCommand":a.storeSelector=f.w;break;case"FrameMakeGroupCommand":a.storeSelector=(0,_.P1)(f.w,(function(e){return{isDisabled:e.isDisabledMakeGroup}}));break;case"FrameReGroupCommand":a.storeSelector=(0,_.P1)(f.w,(function(e){return{isDisabled:e.isDisabledReGroup}}));break;case"FrameUnGroupCommand":a.storeSelector=(0,_.P1)(f.w,(function(e){return{isDisabled:e.isDisabledUnGroup}}))}return a}return(0,l.Z)(t,[{key:"invoke",value:function(e){switch(e.unitId){case"frame_group_group":case"context_menu_arrange_group_group":d.o.setFrameGroup(m.gST.BR_EDITOR_FRAME_GROUP);break;case"frame_group_regroup":case"context_menu_arrange_group_regroup":d.o.setFrameGroup(m.gST.BR_EDITOR_FRAME_REGROUP);break;case"frame_group_ungroup":case"context_menu_arrange_group_unregroup":d.o.setFrameGroup(m.gST.BR_EDITOR_FRAME_UNGROUP)}}}]),t}(c.mY),g=t(651440),C=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;if((0,o.Z)(this,t),a=n.call(this,e),"FrameBringForwardCommand"===e)a.storeSelector=g.l;return a}return(0,l.Z)(t,[{key:"invoke",value:function(e){switch(e&&e.unitId){case"frame_moveforward_front":case"context_menu_arrange_forward_front":d.o.setObjPos(m.sc0.eBRING_TO_FIRST);break;case"frame_moveforward_forward_text":d.o.setObjPos(m.sc0.eINFRONT_OF_TEXT);break;default:d.o.setObjPos(m.sc0.eBRING_TO_FRONT)}}}]),t}(c.mY),p=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;if((0,o.Z)(this,t),a=n.call(this,e),"FrameSendBackwardCommand"===e)a.storeSelector=g.l;return a}return(0,l.Z)(t,[{key:"invoke",value:function(e){switch(e&&e.unitId){case"frame_movebackward_back":case"context_menu_arrange_backward_back":d.o.setObjPos(m.sc0.eSEND_TO_LAST);break;case"frame_movebackward_backward_text":d.o.setObjPos(m.sc0.eBEHIND_TEXT);break;default:d.o.setObjPos(m.sc0.eSEND_TO_BACK)}}}]),t}(c.mY),T=t(295884),v=t(53110),I=t(305054),S=t(530624),b=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;if((0,o.Z)(this,t),a=n.call(this,e),"FrameRotateCommand"===e)a.storeSelector=T.v;return a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=e&&e.unitId,t=d.o.getShapeSize();switch(n){case"frame_roatate_left":t.nRotationPreset=m.qCS.BR_ROTATION_LEFT_90_DEGREE;break;case"frame_roatate_flipvertiacal":t.nRotationPreset=m.qCS.BR_ROTATION_FLIP;break;case"frame_roatate_fliphorizontal":t.nRotationPreset=m.qCS.BR_ROTATION_MIRROR;break;default:t.nRotationPreset=m.qCS.BR_ROTATION_RIGHT_90_DEGREE}I.Z.getDocumentType()===S.kB.eFILE_SHEET&&(0,v.ft)(t,"nUseMask",m.KPo.BR_FRAMESIZE_MODIFY_ROTATION),d.o.setShapeSize(t)}}]),t}(c.mY),O=t(584401),R=t(392457),k=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;switch((0,o.Z)(this,t),a=n.call(this,e),e){case"FrameAlignLeftCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignLeft}}));break;case"FrameAlignCenterCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignCenter}}));break;case"FrameAlignRightCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignRight}}));break;case"FrameAlignTopCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignTop}}));break;case"FrameAlignMiddleCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignMiddle}}));break;case"FrameAlignBottomCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignBottom}}));break;case"FrameAlignDistributeHorizontalCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignHorizon}}));break;case"FrameAlignDistributeVerticalCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignVertical}}));break;case"FrameSubAlignSlideCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignSlide}}));break;case"FrameSubAlignObjectCommand":a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabledAlignObject}}));break;default:a.storeSelector=(0,_.P1)(O.k,(function(e){return{isDisabled:e.isDisabled}}))}return a}return(0,l.Z)(t,[{key:"initSlideMenu",value:function(){this.values=[{unitId:"frame_alignment_left",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_center",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_right",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_top",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_middle",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_bottom",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_distributehorizontal",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_distributevertical",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_slide",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_objects",displayType:R.np.Small,hasDivider:!1,isActivate:!1}];var e=I.Z.getFrameSubAlignType();this.values[8].isActivate=e===m.dvE.BR_EDITOR_FRAME_SUBALIGN_SLIDE,this.values[9].isActivate=e===m.dvE.BR_EDITOR_FRAME_SUBALIGN_SELECTED_OBJECTS}},{key:"initWordMenu",value:function(){this.values=[{unitId:"frame_alignment_left",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_center",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_right",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_top",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_middle",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_bottom",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_distributehorizontal",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_distributevertical",displayType:R.np.Small,hasDivider:!1,isActivate:!1}]}},{key:"initHwpMenu",value:function(){this.values=[{unitId:"frame_alignment_left",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_center",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_right",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_top",displayType:R.np.Small,hasDivider:!0,isActivate:!1},{unitId:"frame_alignment_middle",displayType:R.np.Small,hasDivider:!1,isActivate:!1},{unitId:"frame_alignment_bottom",displayType:R.np.Small,hasDivider:!1,isActivate:!1}]}},{key:"initValues",value:function(){var e=d.o.getDocType();e===m.VrN.eDOCTYPE_PPTX||e===m.VrN.eDOCTYPE_PPT?this.initSlideMenu():e===m.VrN.eDOCTYPE_DOC||e===m.VrN.eDOCTYPE_DOCX?this.initWordMenu():this.initHwpMenu()}},{key:"getValues",value:function(){return this.initValues(),this.values}},{key:"invoke",value:function(e){var n=e.unitId,t=I.Z.getFrameSubAlignType();switch(n){case"frame_alignment_left":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_LEFT,t);break;case"frame_alignment_center":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_CENTER,t);break;case"frame_alignment_right":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_RIGHT,t);break;case"frame_alignment_top":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_TOP,t);break;case"frame_alignment_middle":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_MIDDLE,t);break;case"frame_alignment_bottom":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_ALIGN_BOTTOM,t);break;case"frame_alignment_distributehorizontal":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_DISTRIBUTE_HORIZONTALLY,t);break;case"frame_alignment_distributevertical":d.o.setMultiObjectAlign(m.yu.BR_EDITOR_FRAME_DISTRIBUTE_VERTICALLY,t);break;case"frame_alignment_slide":I.Z.setFrameSubAlignType(m.dvE.BR_EDITOR_FRAME_SUBALIGN_SLIDE);break;case"frame_alignment_objects":I.Z.setFrameSubAlignType(m.dvE.BR_EDITOR_FRAME_SUBALIGN_SELECTED_OBJECTS)}}}]),t}(c.Py),E=t(441406),P=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=E.o,a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=e.sectionIndex,t=e.itemIndex;if(0===n)d.o.setTextWrapEvent(m.l5k.BR_TEXT_WRAP_INLINE_WITH_LINE);else{var a=d.o.getShapeLocationInfo();a.bPreset=t+1,d.o.setShapeLocation(a)}}}]),t}(c.mY),D=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,l.Z)(t,[{key:"invoke",value:function(e){Z()}}]),t}(c.mY),A=t(59127),y={FrameGroupCommand:h,FrameMakeGroupCommand:h,FrameReGroupCommand:h,FrameUnGroupCommand:h,FrameBringForwardCommand:C,FrameBringForwardForwardCommand:C,FrameBringForwardFirstCommand:C,FrameBringForwardTextCommand:C,FrameSendBackwardCommand:p,FrameSendBackwardBackwardCommand:p,FrameSendBackwardLastCommand:p,FrameSendBackwardTextCommand:p,FrameRotateCommand:b,FrameRotateLeftCommand:b,FrameRotateRightCommand:b,FrameRotateVerticalCommand:b,FrameRotateHorizontalCommand:b,FrameAlignCommand:k,FrameAlignBottomCommand:k,FrameAlignCenterCommand:k,FrameAlignLeftCommand:k,FrameAlignMiddleCommand:k,FrameAlignRightCommand:k,FrameAlignTopCommand:k,FrameAlignDistributeHorizontalCommand:k,FrameAlignDistributeVerticalCommand:k,FrameSubAlignSlideCommand:k,FrameSubAlignObjectCommand:k,DeleteKeyInputCommand:D,PositionMenuCommand:P},Z=function(){d.o.charInsert(A.S.Delete,!1,!1,!1);var e=d.o.getConfig().nZoomRatio;d.o.setZoom(e)},F=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,l.Z)(t,[{key:"invoke",value:function(){}}]),t}(c.mY),N={GotoDialogCommand:F},L=t(625477),M=t(507277),w=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=M.cU,a}return(0,l.Z)(t,[{key:"prepareShowDropdown",value:function(e){e()}},{key:"invoke",value:function(e){e.currentIndex;var n=e.unitId;e.currentValue;"shape_fillcolor_no_color"!==n&&"context_menu_shape_fillcolor_no_color"!==n||this.selectColor("no-color")}},{key:"selectColor",value:function(e){switch(I.Z.getObjectControlType()){case S.uq.eObjCtrShape:case S.uq.eObjCtrShapeInlineText:case S.uq.eObjCtrTextBox:case S.uq.eObjCtrTextBoxInlineText:case S.uq.eObjCtrTemplate:case S.uq.eObjCtrTemplateInlineText:case S.uq.eObjCtrTemplateTextCaret:case S.uq.eObjCtrTemplateTextSelect:case S.uq.eObjCtrChart:case S.uq.eObjCtrChartInlineText:case S.uq.eObjCtrChartTextCaret:case S.uq.eObjCtrChartTextSelect:case S.uq.eObjCtrMultiObject:case S.uq.eObjCtrFLine:case S.uq.eObjCtrFLineInlineText:case S.uq.eObjCtrGroup:case S.uq.eObjCtrGroupInlineText:case S.uq.eObjCtrSmtArtChildShape:case S.uq.eObjCtrTextBoxTextCaret:case S.uq.eObjCtrTextBoxTextSelect:case S.uq.eObjCtrTable:case S.uq.eObjCtrTableCell:case S.uq.eObjCtrTableTextCaret:case S.uq.eObjCtrTableTextSelect:var n="no-color"===e?16579836:v.Il.rgbToHex(e),t=(0,a.Z)((0,a.Z)({},(0,m.WSJ)()),{},{nThemePaletteIndex:m.CGh.BR_THEMECOLOR_PALETTE_NONE,nColor:n,bAutoColor:!1}),r=(0,a.Z)((0,a.Z)({},(0,m.FoN)()),{},{nFillSelector:m.mgF.BR_FILL_SOLID,nSolidColor:t,fSolidTransparency:-1});d.o.setShapeProperty(m.mtQ.BR_FRAME_FORMAT_FILL,null,r,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!0)}(0,L.Ce)((0,M.kF)(e))}}]),t}(c.vD),B=t(856904),x=t(317747),j={ShapeFillColorCommand:w,ShapeOutlineColorCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.De,a}return(0,l.Z)(t,[{key:"prepareShowDropdown",value:function(e){e()}},{key:"invoke",value:function(e){e.currentIndex;var n=e.unitId;e.currentValue;"shape_outline_no_color"!==n&&"context_menu_shape_outline_no_color"!==n||this.selectColor("no-color")}},{key:"selectColor",value:function(e){switch(I.Z.getObjectControlType()){case S.uq.eObjCtrShape:case S.uq.eObjCtrShapeInlineText:case S.uq.eObjCtrTextBox:case S.uq.eObjCtrTextBoxInlineText:case S.uq.eObjCtrTemplate:case S.uq.eObjCtrTemplateTextCaret:case S.uq.eObjCtrTemplateTextSelect:case S.uq.eObjCtrTemplateInlineText:case S.uq.eObjCtrChart:case S.uq.eObjCtrChartTextCaret:case S.uq.eObjCtrChartTextSelect:case S.uq.eObjCtrChartInlineText:case S.uq.eObjCtrMultiObject:case S.uq.eObjCtrFLine:case S.uq.eObjCtrFLineInlineText:case S.uq.eObjCtrGroup:case S.uq.eObjCtrGroupInlineText:case S.uq.eObjCtrSmtArtChildShape:case S.uq.eObjCtrTextBoxTextCaret:case S.uq.eObjCtrTextBoxTextSelect:case S.uq.eObjCtrLine:case S.uq.eObjCtrLineInlineText:case S.uq.eObjCtrImage:case S.uq.eObjCtrImageInlineText:var n=(0,m.H8u)();if("no-color"!==e){var t=v.Il.rgbToHex(e),r=(0,a.Z)((0,a.Z)({},(0,m.WSJ)()),{},{nThemePaletteIndex:m.CGh.BR_THEMECOLOR_PALETTE_NONE,nColor:t,bAutoColor:!1});if(n.nLineColorSelector=m.KA1.BR_LINE_COLOR_SOLID,n.nSolidColor=r,n.fSolidTransparency=-1,d.o.getShapeLineColorInfo().nLineColorSelector===m.KA1.BR_LINE_COLOR_NO){var i=d.o.getShapeLineStyleInfo();if(i.nWidth>0){var o=(0,x.bq)(i);this.setOutlineColorWithStyle(n,o);break}}}this.setOutlineColorWithStyle(n,null)}(0,L.Ce)((0,B.cq)(e))}},{key:"setOutlineColorWithStyle",value:function(e,n){var t=m.mtQ.BR_FRAME_FORMAT_LINE_COLOR;n&&(t|=m.mtQ.BR_FRAME_FORMAT_LINE_STYLE),d.o.setShapeProperty(t,null,null,e,n,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!0)}}]),t}(c.vD),ShapeOutlineArrowCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.sh,a}return(0,l.Z)(t,[{key:"initSelectedValue",value:function(){(0,L.Ce)((0,B.HG)())}},{key:"invoke",value:function(e){}}]),t}(c.$Y),ShapeOutlineArrowItemCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.N4,a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=e.currentIndex,t=(e.unitId,d.o.getShapeLineColorInfo());t.nLineColorSelector===m.KA1.BR_LINE_COLOR_NO&&(t.nLineColorSelector=m.KA1.BR_LINE_COLOR_SOLID,t.nSolidColor.nColor=16777215);var r=d.o.getShapeLineStyleInfo(),i=(0,x._U)(n);r.stArrow=(0,a.Z)((0,a.Z)({},i),{},{nBeginSize:m.vUp.BR_ARROW_SIZE_5,nEndSize:m.vUp.BR_ARROW_SIZE_5});var o=(0,x.bq)(r);d.o.setShapeProperty(m.mtQ.BR_FRAME_FORMAT_LINE_STYLE,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!0)}}]),t}(c.mY),ShapeOutlineThicknessCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.HJ,a}return(0,l.Z)(t,[{key:"initSelectedValue",value:function(){(0,L.Ce)((0,B.ll)())}},{key:"invoke",value:function(e){}}]),t}(c.$Y),ShapeOutlineThicknessItemCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.xo,a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=e.currentIndex,t=(e.unitId,(0,x.bq)(d.o.getShapeLineStyleInfo())),a=I.Z.getDocumentType()===S.kB.eFILE_HWP;t.nWidth=(0,x.Oj)(a,n,!0),d.o.setShapeProperty(m.mtQ.BR_FRAME_FORMAT_LINE_STYLE,null,null,null,t,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!0)}}]),t}(c.mY),ShapeOutlineDashCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.Lt,a}return(0,l.Z)(t,[{key:"initSelectedValue",value:function(){(0,L.Ce)((0,B.RA)())}},{key:"invoke",value:function(e){}}]),t}(c.$Y),ShapeOutlineDashItemCommand:function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=B.Ix,a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=e.currentIndex,t=(e.unitId,(0,x.bq)(d.o.getShapeLineStyleInfo()));I.Z.getDocumentType()===S.kB.eFILE_HWP?(0,x.s9)(n,t):t.nDashType=n+1,d.o.setShapeProperty(m.mtQ.BR_FRAME_FORMAT_LINE_STYLE,null,null,null,t,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!0)}}]),t}(c.mY)},q=t(974165),H=t(115861),G=t(455784),U=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=G.i,a}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,a=t.width,r=t.height;a>e||r>n;)a>e?(r*=e/a,a=e):r>n&&(a*=n/r,r=n);var i=document.createElement("canvas");i.width=a,i.height=r;var o=i.getContext("2d");o&&(o.drawImage(t,0,0,a,r),i.toBlob(function(){var e=(0,H.Z)((0,q.Z)().mark((function e(n){var t;return(0,q.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,(0,v.Cq)(n);case 3:(t=e.sent)instanceof ArrayBuffer&&d.o.imageInsert(t,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(e)}}]),t}(c.mY),Y=t(735622),z=t(995124),V=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).storeSelector=G.i,a}return(0,l.Z)(t,[{key:"invoke",value:function(){Y.Z.showDialog({dialogId:z.O.INSERT_ONLINE_PICTURE,bModal:!0,currentTabIndex:0})}}]),t}(c.mY),W=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,l.Z)(t,[{key:"invoke",value:function(e){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,a=t.width,r=t.height;a>e||r>n;)a>e?(r*=e/a,a=e):r>n&&(a*=n/r,r=n);var i=document.createElement("canvas");i.width=a,i.height=r;var o=i.getContext("2d");o&&(o.drawImage(t,0,0,a,r),i.toBlob(function(){var e=(0,H.Z)((0,q.Z)().mark((function e(n){var t;return(0,q.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,(0,v.Cq)(n);case 3:(t=e.sent)instanceof ArrayBuffer&&d.o.imageInsert(t,0,0,1,0,0);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(e)}}]),t}(c.mY),K={InsertPictureCommand:U,InsertOnlinePictureCommand:V,ChangePictureCommand:W},X={CustomContextMenuCommand:t(496959).Z},Q=(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},r),i.Z),y),N),j),K),X)},458345:function(e,n,t){t.d(n,{Z:function(){return f}});var a=t(215671),r=t(143144),i=t(179340),o=t(432269),l=t(135323),u=t(145729),s=t(851574),c=t(625477),m=function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;switch((0,a.Z)(this,t),r=n.call(this,e),e){case"PenInkModeHighlighterCommand":r.storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:!1,isChecked:e.selectPentType===s.aH.Highlighter}}));break;case"PenInkModePenCommand":r.storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:!1,isChecked:e.selectPentType===s.aH.Pen}}));break;case"PenInkModeRulerCommand":r.storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:!1,isChecked:e.selectPentType===s.aH.Ruler}}));break;case"PenInkModeEraserCommand":r.storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:!1,isChecked:e.selectPentType===s.aH.Eraser}}));break;case"PenSelectTrapCommand":r.storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:!1,isChecked:e.selectPentType===s.aH.Lasso}}))}return r}return(0,r.Z)(t,[{key:"invoke",value:function(){var e=s.aH.Normal;switch(this.commandName){case"PenInkModeHighlighterCommand":e=s.aH.Highlighter;break;case"PenInkModePenCommand":e=s.aH.Pen;break;case"PenInkModeRulerCommand":e=s.aH.Ruler;break;case"PenInkModeEraserCommand":e=s.aH.Eraser;break;case"PenSelectTrapCommand":e=s.aH.Lasso}"PenInkModeEraserCommand"===this.commandName?(0,c.Ce)((0,s.nt)()):"PenSelectTrapCommand"===this.commandName?(0,c.Ce)((0,s.DH)()):(0,c.Ce)((0,s.E2)(e)),(0,c.qm)(s.te).isCheckedShowInk||(0,c.Ce)((0,s.vZ)())}}]),t}(u.mY),d=t(981142),_=t(877703),f={PenInkModeHighlighterCommand:m,PenInkModePenCommand:m,PenInkModeRulerCommand:m,PenInkModeEraserCommand:m,PenInkModeAllDeleteCommand:function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,a.Z)(this,t),(r=n.call(this,e)).storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:e.isDisabledShowInk||!e.isCheckedShowInk}})),r}return(0,r.Z)(t,[{key:"invoke",value:function(){d.o.infraPenAllErase(0,!0),(0,c.Ce)((0,s.v4)()),(0,c.Ce)((0,_.A7)())}}]),t}(u.mY),PenInkStyleColorCommand:function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,a.Z)(this,t),(r=n.call(this,e)).storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:e.selectPentType!==s.aH.Highlighter&&e.selectPentType!==s.aH.Pen&&e.selectPentType!==s.aH.Ruler}})),r}return(0,r.Z)(t,[{key:"prepareShowDropdown",value:function(e){e()}},{key:"invoke",value:function(e){"pen_inkstyle_color"===e.unitId&&this.selectColor("no-color")}},{key:"selectColor",value:function(e){(0,c.Ce)((0,s.FZ)(e))}}]),t}(u.vD),PenInkStyleThicknessCommand:function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,a.Z)(this,t),(r=n.call(this,e)).storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:e.selectPentType!==s.aH.Highlighter&&e.selectPentType!==s.aH.Pen&&e.selectPentType!==s.aH.Ruler,currentIndex:e.penThicknessIndex}})),r}return(0,r.Z)(t,[{key:"invoke",value:function(e){var n=e.currentIndex;(0,c.Ce)((0,s.x7)(n))}}]),t}(u.mY),PenInkOptionShowinkCommand:function(e){(0,i.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,a.Z)(this,t),(r=n.call(this,e)).storeSelector=(0,l.P1)(s.te,(function(e){return{isDisabled:e.isDisabledShowInk,isChecked:e.isCheckedShowInk}})),r}return(0,r.Z)(t,[{key:"invoke",value:function(){(0,c.Ce)((0,s.v4)()),(0,c.Ce)((0,s.vZ)()),(0,c.Ce)((0,_.A7)())}}]),t}(u.mY),PenSelectTrapCommand:m}},820371:function(e,n,t){t.d(n,{$T:function(){return I},Be:function(){return v},DM:function(){return S},FK:function(){return E},KT:function(){return O},ce:function(){return b},oK:function(){return R}});var a=t(601413),r=t(426373),i=t(135323),o=t(981142),l=t(625477),u=t(877703),s=t(628264),c=t(101922),m=t(53110),d=t(416031),_={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},f=(0,r.oM)({name:"page",initialState:_,reducers:{setPageSize:function(e,n){var t=n.payload,a=t.pageWidth,r=t.pageHeight;e.pageWidth=a,e.pageHeight=r,e.pageRatio=r>0?r/a:0},setPageNumber:function(e,n){var t=n.payload,a=t.currentPage,r=t.totalPage;m.tq?(e.currentPage===a&&e.totalPage===r||(e.isShowingPageInfo=!0),k()):e.isShowingPageInfo=!0,e.currentPage=a,e.totalPage=r,e.isFirstPage=1===a,e.isLastPage=a===r},setIsShowPresentationEndingConfirm:function(e,n){e.isShowPresentationEndingConfirm=n.payload},setIsShowingPageInfo:function(e,n){e.isShowingPageInfo=n.payload},setIsShowingPageNavigation:function(e,n){e.isShowingPageNavigation=n.payload}},extraReducers:function(e){e.addCase(c.qp,(function(e){e.isShowingPageInfo=!m.tq})),e.addCase(s.FZ,(function(e,n){if(!n.payload)return(0,a.Z)({},_)}))}}),h=f.actions,g=h.setPageSize,C=h.setPageNumber,p=h.setIsShowPresentationEndingConfirm,T=h.setIsShowingPageInfo,v=h.setIsShowingPageNavigation;n.ZP=f.reducer;var I=(0,i.P1)((function(e){return e.page}),(function(e){return e})),S=function(){return(0,l.RU)("updatePageSizeThunk",(function(e){var n=o.o.getPageInfo(1),t=n.nPageWidth,a=n.nPageHeight;e(g({pageWidth:t,pageHeight:a}))}))},b=function(){return(0,l.RU)("updatePageNumberThunk",(function(e){var n=o.o.getConfig(),t=n.nCurPage,a=n.nTotalPages;e(C({currentPage:t,totalPage:a}))}))},O=function(e,n){return(0,l.RU)("updatePageMoveThunk",(function(t,a){var r=a().page.currentPage;t(C({currentPage:e,totalPage:n})),t((0,u.Ml)([r,e]))}))},R=function(e){return(0,l.RU)("setIsShowPresentationEndingConfirmThunk",(function(n){n(p(e))}))},k=(0,d.debounce)((function(){(0,l.Ce)(T(!1))}),2e3),E=(0,d.debounce)((function(){(0,l.Ce)(v(!1))}),2e3)},877703:function(e,n,t){t.d(n,{A7:function(){return D},Cq:function(){return b},Hq:function(){return T},Ml:function(){return P},Tb:function(){return R},Tz:function(){return v},XQ:function(){return I},ZB:function(){return O},Zm:function(){return F},aG:function(){return Z},pL:function(){return A},yE:function(){return S},z_:function(){return y}});var a=t(601413),r=t(426373),i=t(135323),o=t(416031),l=t(625477),u=t(628264),s=t(981142),c=t(820371),m=t(588567),d=t(735622),_=t(995124),f=t(361688),h={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},g=(0,r.oM)({name:"slideThumbnail",initialState:h,reducers:{setThumbnailSize:function(e,n){var t=n.payload,a=t.width,r=t.height;e.width=a,e.height=r},setThumbnailItem:function(e,n){var t=n.payload,a=t.pageNumber,r=t.thumbnailItem;e.thumbnails[a]=r},unmountThumbnail:function(e,n){var t=n.payload;delete e.thumbnails[t]},clearThumbnails:function(e){},setIsResizing:function(e,n){e.isResizing=n.payload},setIsPageDrag:function(e,n){var t=n.payload;e.isPageDrag=t,!t&&(e.pageDropTarget=void 0)},setPageDropTarget:function(e,n){e.pageDropTarget=n.payload}},extraReducers:function(e){e.addCase(u.FZ,(function(e,n){if(!n.payload)return(0,a.Z)({},h)}))}}),C=g.actions.clearThumbnails,p=g.actions,T=p.setThumbnailSize,v=p.setThumbnailItem,I=p.unmountThumbnail,S=p.setIsResizing,b=p.setIsPageDrag,O=p.setPageDropTarget;n.ZP=g.reducer;var R=(0,i.P1)((function(e){return e.slideThumbnail}),(function(e){return e})),k=function(e,n,t,a){if(a||s.o.isPageModified(e)){var r=(0,l.qm)(f.CI),i=4*n*r,o=4*t*r;s.o.slideObjStartEx(i,o,e)}},E=function(e,n){return(0,l.RU)("requestSlideThumbnailFromToThunk",(function(t,a){var r=a(),i=r.slideThumbnail,o=i.width,l=i.height,u=r.page.totalPage;if(o&&l&&u>0&&e>=1&&n<=u)for(var s=e;s<=n;s+=1)k(s,o,l,!0)}))},P=function(e){return(0,l.RU)("requestSlideThumbnailListThunk",(function(n,t){var a=e.length;if(a>0){var r=t(),i=r.slideThumbnail,o=i.width,l=i.height,u=r.page.totalPage;if(o&&l)for(var s=0;s<a;s+=1){var c=e[s];c>=1&&c<=u&&k(c,o,l,!0)}}}))},D=function(e){return(0,l.RU)("requestSlideThumbnailAllThunk",(function(n,t){var a=t(),r=a.slideThumbnail,i=r.width,o=r.height,l=a.page.totalPage;if(e&&n(C()),i&&o&&l>0)for(var u=function(e){setTimeout((function(){k(e,i,o,!0)}))},s=1;s<=l;s+=1)u(s)}))},A=(0,o.debounce)((function(){var e=(0,l.qm)(c.$T).currentPage,n=(0,l.qm)(R),t=n.width,a=n.height;t&&a&&e>0&&k(e,t,a)}),500),y=function(e){var n=e.nAction,t=e.stListInfo,a=t.nPageCnt,r=t.pPageList;switch(n){case m.jar.eBR_UNREDO_ACTION_NONE:(0,l.Ce)((0,c.DM)()),(0,l.Ce)((0,c.ce)());break;case m.jar.eBR_UNREDO_ACTION_ADD:case m.jar.eBR_UNREDO_ACTION_DELETE:(0,l.Ce)((0,c.ce)());break;case m.jar.eBR_UNREDO_ACTION_MOVE:var i=a>0?r[0]:0,o=a>1?r[a-1]:i,u=Math.min(i,o),s=Math.max(i,o);(0,l.Ce)(E(u,s));break;case m.jar.eBR_UNREDO_ACTION_CHANGE:case m.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case m.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,l.Ce)(P(r));break;case m.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case m.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case m.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,l.Ce)(D());case m.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case m.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case m.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case m.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},Z=function(){return(0,l.RU)("slidePageDropThunk",(function(e,n){var t=n(),r=t.page,i=t.slideThumbnail,l=r.currentPage,u=i.pageDropTarget;if(l>0&&!(0,o.isNil)(u)&&l!==u){var c=Math.min(u,l),d=Math.max(u,l);s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,m.zUw)()),{},{nType:m.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:u,nSectionIndex:0})),s.o.movePage(m.ZbX.eEV_MOVE_SETPAGE,u),e(E(c,d))}}))},F=function(){return(0,l.RU)("slidePageDeleteThunk",(function(e,n){var t=n().page,r=t.totalPage,i=t.currentPage;i>0&&(r>1?s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,m.zUw)()),{},{nType:m.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:i})):d.Z.showDialog({dialogId:_.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}}}]);