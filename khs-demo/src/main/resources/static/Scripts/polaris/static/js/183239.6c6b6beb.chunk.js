"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[183239],{202265:function(e,t,n){var i=n(974165),r=n(115861),o=n(215671),a=n(143144),u=n(416031),l=n(977917),s=n(981142),c=n(735622),d=n(625477),f=n(260861),h=n(494638),p=n(361688),m=n(53110),b=n(995124),T=n(588567),S=n(740918).Buffer,v=function(){function e(){(0,o.Z)(this,e),this.filterIconPosition=void 0,this.currentFilterMenu=void 0,this.filterIcons=["sheet_btn_filter_more_normal.png","sheet_btn_filter_more_pressed.png","sheet_btn_filter_sort_normal.png","sheet_btn_filter_sort_pressed.png","sheet_btn_filter_sortup_normal.png","sheet_btn_filter_sortup_pressed.png","sheet_btn_filter_sortdown_normal.png","sheet_btn_filter_sortdown_pressed.png","sheet_btn_sortup_normal.png","sheet_btn_sortup_pressed.png","sheet_btn_sortdown_normal.png","sheet_btn_sortdown_pressed.png"],this.filterIconPosition=null,this.currentFilterMenu={handleId:0,focusIndex:0,titleArray:[],fixedItemArray:[],checkedArray:[],secondMainType:0,firstFilterType:0,secondFilterType:0}}return(0,a.Z)(e,[{key:"initFilterIcon",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(this.filterIcons.map((function(e){return n(624099)("./".concat(e))})));case 3:t=e.sent,r=t.map((function(e){return S.from(e.default.replace(/.*base64,/,""),"base64")})),s.o.setAutofilterButtonConfigurationEx(r,this.filterIcons),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),l.ZP.error("Filter icon load Error","[".concat(e.t0.message,"]"));case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentFilterMenu",value:function(){return this.currentFilterMenu}},{key:"sheetAutoFilter",value:function(){if(!s.o.isRunningAutoFilter()){var e="",t=s.o.getSortRange(!1).result;if(t===T.nCv.kPoErrInternal?e="IDS_DLG_EDIT_ERROR_SORT_RANGE":t===T.nCv.kPoErrSheetUnusedCommandAsCellMultiselection&&(e="IDS_MSG_SHEET_MULTISELECTION_CUT_ERROR"),""!==e)return void this.showAlert(e)}s.o.sheetFilter()}},{key:"sheetClearFilter",value:function(){var e=s.o.getCurrentSheetIndex();1===s.o.sheetIsEnableClearAdvancedFilter(e)?(s.o.sheetSetClearAdvancedFilter(e),s.o.reDraw()):this.setFilterClearReapply(["clear"])}},{key:"setFilterClearReapply",value:function(e){s.o.sheetFilterCommand(this.getCurrentFilterMenu().handleId,-1,1,e,1)}},{key:"setSheetFilterCommand",value:function(e,t,n){var i=this.currentFilterMenu,r=i.handleId,o=i.focusIndex;s.o.getAutoFilterFilteringAble(o)?s.o.sheetFilterCommand(r,o,e,t,n):this.showAlert("IDS_MSG_SHEET_FIND_REPLACE_SHEET_PROTECT")}},{key:"setSheetAutoFilterButtonRelease",value:function(){s.o.setSheetAutoFilterButtonRelease(),s.o.reDraw()}},{key:"onSheetAutoFilterMenu",value:function(e){var t=e.nHandleId,n=e.nFocusIndex,i=e.titleArray,r=e.isFixedItemArray,o=e.isCheckedArray,a=(e.nItemCount,e.nLeft),u=e.nTop,l=e.nRight,s=e.nBottom,c=e.nSecondMainType,h=e.nFirstFilterType,m=e.nSecondFilterType;this.currentFilterMenu={handleId:t,focusIndex:n,titleArray:i,fixedItemArray:r,checkedArray:o,secondMainType:c,firstFilterType:h,secondFilterType:m};var b=(0,d.qm)(p.CI);this.filterIconPosition={top:u/b,left:a/b,right:l/b,bottom:s/b},(0,d.Ce)((0,f.kp)())}},{key:"isShowAutoFilter",value:function(){var e=(0,d.qm)(f.vd),t=e.isShow,n=e.menuList;return t&&(0,u.some)(n,["id","auto_filter"])}},{key:"existSheetAutoFilterBtn",value:function(e,t){var n=s.o.getVisibleFilterButtonCount();if(n<=0)return!1;for(var i=s.o.getVisibleFilterButtonRange(n),r=0;r<n;r+=1)if(e>=i[r].left&&e<=i[r].right&&t>=i[r].top&&t<=i[r].bottom)return!0;return!1}},{key:"showAutoFilterDropdown",value:function(){var e=this.isShowAutoFilter();if(this.filterIconPosition&&!e){var t=m.UL.calculateAppBounding((0,d.qm)(p.LG)),n=t.top,i=260,r=h.M.getDropdownConfig("auto_filter");r&&r.dropdownWidth.length>0&&(i=Number.parseInt(r.dropdownWidth));var o=this.filterIconPosition.right-i-2;o<0&&(o=0);var a=n+this.filterIconPosition.bottom;return a>n+t.height/2&&(a=this.filterIconPosition.top-n-10),(0,d.Ce)((0,f.SP)({id:"auto_filter",commandName:"DummyCommand",top:a,left:o,depth:0})),this.filterIconPosition=null,!0}return!1}},{key:"showAlert",value:function(e){c.Z.showDialog({dialogId:b.O.COMMON_ALERT,bModal:!0,alertMsg:{label:e}})}}]),e}(),Z=new v;t.Z=Z},412574:function(e,t,n){n.d(t,{$k:function(){return l},uT:function(){return s}});var i=n(426373),r=n(135323),o=n(416031),a=(0,i.oM)({name:"cellStatus",initialState:{average:{isVisible:!0,value:""},count:{isVisible:!0,value:""},numerical:{isVisible:!0,value:""},min:{isVisible:!0,value:""},max:{isVisible:!0,value:""},sum:{isVisible:!0,value:""}},reducers:{setCellStatusVisibles:function(e,t){var n=t.payload,i=n.average,r=n.count,a=n.numerical,u=n.min,l=n.max,s=n.sum;!(0,o.isNil)(i)&&(e.average.isVisible=i),!(0,o.isNil)(r)&&(e.count.isVisible=r),!(0,o.isNil)(a)&&(e.numerical.isVisible=a),!(0,o.isNil)(u)&&(e.min.isVisible=u),!(0,o.isNil)(l)&&(e.max.isVisible=l),!(0,o.isNil)(s)&&(e.sum.isVisible=s)},setCellStatusValues:function(e,t){var n=t.payload,i=n.average,r=n.count,o=n.numerical,a=n.min,u=n.max,l=n.sum;e.average.value=i,e.count.value=r,e.numerical.value=o,e.min.value=a,e.max.value=u,e.sum.value=l}}}),u=a.actions,l=(u.setCellStatusVisibles,u.setCellStatusValues);t.ZP=a.reducer;var s=(0,r.P1)((function(e){return e.cellStatus}),(function(e){return e}))},465055:function(e,t,n){n.d(t,{k8:function(){return l},pl:function(){return c},vc:function(){return s}});var i=n(426373),r=n(135323),o={left:0,top:0,width:0,itemCount:0,selectedIndex:0,titles:[],isShow:!1},a=(0,i.oM)({name:"dataValidationDropdown",initialState:o,reducers:{showDataValidationDropdown:function(e,t){var n=t.payload,i=n.left,r=n.top,o=n.width,a=n.itemCount,u=n.selectedIndex,l=n.titles;e.left=i,e.width=o,e.top=r,e.itemCount=a,e.selectedIndex=u,e.titles=l,e.isShow=!0},hideDataValidationDropdown:function(){return o}}}),u=a.actions,l=u.showDataValidationDropdown,s=u.hideDataValidationDropdown;t.ZP=a.reducer;var c=(0,r.P1)((function(e){return e.dataValidationDropdown}),(function(e){return e}))},6087:function(e,t,n){n.d(t,{P7:function(){return m},Tw:function(){return S},Wg:function(){return T},iv:function(){return Z},rW:function(){return v},rb:function(){return b}});var i=n(601413),r=n(426373),o=n(135323),a=n(625477),u=n(305054),l=n(588567),s=n(981142),c={fieldText:"",fieldSelection:{start:0,end:0}},d=(0,i.Z)((0,i.Z)({},c),{},{isFieldDisabled:!1,isCellEditing:!1,isExtended:!1}),f=(0,r.oM)({name:"formulaBar",initialState:d,reducers:{setFormulaFieldText:function(e,t){e.fieldText=t.payload},setFormulaFieldSelection:function(e,t){e.fieldSelection=t.payload},setIsCellEditing:function(e,t){e.isCellEditing=t.payload},setIsExtended:function(e,t){e.isExtended=t.payload},initFormulaField:function(e,t){var n=t.payload,i=n.fieldText,r=n.fieldSelection;e.fieldText=i,e.fieldSelection=r}},extraReducers:function(e){e.addCase(u.j,(function(e){if(e.isCellEditing)e.isFieldDisabled=!1;else if(0!==s.o.getInfraPenType())e.isFieldDisabled=!0;else switch(u.Z.getObjectType()){case l.lkc.BR_OBJECT_CELL:case l.lkc.BR_OBJECT_HEADER_COLUMN:case l.lkc.BR_OBJECT_HEADER_ROW:e.isFieldDisabled=!1;break;default:e.isFieldDisabled=!0}}))}}),h=f.actions.initFormulaField,p=f.actions,m=p.setFormulaFieldText,b=p.setFormulaFieldSelection,T=p.setIsCellEditing,S=p.setIsExtended;t.ZP=f.reducer;var v=(0,o.P1)((function(e){return e.formulaBar}),(function(e){return e})),Z=function(){return(0,a.RU)("initFormulaBarThunk",(function(e){e(h(c))}))}},631724:function(e,t,n){n.d(t,{kV:function(){return l},uo:function(){return s},wt:function(){return d},wx:function(){return c}});var i=n(426373),r=n(135323),o={posX:0,posY:0,limitPosX:0,limitPosY:0,cellHeight:0,currentIndex:0,functionNames:[],isShow:!1},a=(0,i.oM)({name:"functionAutoCompleteList",initialState:o,reducers:{showFunctionAutoCompleteList:function(e,t){var n=t.payload,i=n.posX,r=n.posY,o=n.limitPosX,a=n.limitPosY,u=n.functionNames,l=n.cellHeight;e.posX=i,e.posY=r,e.limitPosX=o,e.limitPosY=a,e.functionNames=u,e.cellHeight=l,e.isShow=!0},changeCurrentIndex:function(e,t){e.currentIndex=t.payload},hideFunctionAutoCompleteList:function(){return o}}}),u=a.actions,l=u.showFunctionAutoCompleteList,s=u.changeCurrentIndex,c=u.hideFunctionAutoCompleteList;t.ZP=a.reducer;var d=(0,r.P1)((function(e){return e.functionAutoCompleteList}),(function(e){return e}))},649861:function(e,t,n){n.d(t,{H4:function(){return c},Vt:function(){return l},th:function(){return s}});var i=n(426373),r=n(135323),o={isShow:!1,posX:0,posY:0,limitPosX:0,limitPosY:0,tooltipText:"",tooltipHeight:20},a=(0,i.oM)({name:"functionTooltip",initialState:o,reducers:{showFunctionTooltip:function(e,t){var n=t.payload,i=n.posX,r=n.posY,o=n.limitPosX,a=n.limitPosY,u=n.tooltipText,l=n.cellHeight;e.posX=i,e.posY=r,e.limitPosX=o,e.limitPosY=a,e.tooltipText=u,e.cellHeight=l,e.isShow=!0},hideFunctionTooltip:function(){return o}}}),u=a.actions,l=u.showFunctionTooltip,s=u.hideFunctionTooltip;t.ZP=a.reducer;var c=(0,r.P1)((function(e){return e.functionTooltip}),(function(e){return e}))},720984:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ne}});var i=n(409038),r=n(700459),o=n(451546),a=n(352308),u=n(426373),l=n(135323),s=(n(625477),n(981142)),c=n(305054),d=(0,u.oM)({name:"strikelineDouble",initialState:{isChecked:!1,isDisabled:!1},reducers:{setStrikelineDouble:function(e,t){e.isChecked=t.payload}},extraReducers:function(e){e.addCase(c.j,(function(e){e.isChecked=s.o.isDoubleStrikelineFont()}))}}),f=((0,l.P1)((function(e){return e.command.font.strikelineDouble}),(function(e){return e})),d.reducer),h=n(981881),p=n(574165),m=n(844014),b=n(269672),T=n(21190),S=n(352506),v=n(890205),Z=(0,i.UY)({color:r.ZP,italic:o.Z,strikeline:a.Z,strikelineDouble:f,subscript:b.Z,superscript:T.Z,size:h.ZP,name:p.ZP,style:m.ZP,underLine:S.ZP,bold:v.Z}),_=n(986037),g=(0,i.UY)({hyperlink:_.Z}),F=n(9528),E=n(568739),P=(0,i.UY)({pictureReset:F.Z,pictureCrop:E.ZP}),C=n(697558),w=n(339990),R=n(647492),I=n(651536),y=(0,i.UY)({alignvertical:C.Z,alignhorizontal:w.Z,mergeCells:R.Z,wrapText:I.Z}),B=n(277237),k=n(843987),D=(0,i.UY)({numberFormat:B.Z,numberFormatComma:k.Z}),A=n(723596),x=n(598462),L=n(937444),M=n(499801),H=(0,i.UY)({cellInsert:A.Z,cellDelete:x.Z,cellFormat:L.Z,cellFillColor:M.ZP}),U=n(338131),N=n(989641),Y=n(227808),V=n(380357),O=(0,i.UY)({shapeTextColor:U.ZP,shapeStyle:N.ZP,shapeEffect:Y.ZP,changeShape:V.Z}),X=n(981273),G=(0,i.UY)({bordertypelist:X.ZP}),z=n(213950),W=n(3756),q=n(380642),$=n(342114),j=n(974398),J=(0,i.UY)({newMemo:z.Z,deleteMemo:W.Z,memoPrevNext:q.Z,showAndHideMemo:$.ZP,showAndHideAllMemo:j.Z}),Q=n(67422),K=n(418530),ee=n(273150),te=n(260807),ne=(0,i.UY)({paste:Q.ZP,copyFormat:K.Z,copy:ee.Z,cut:te.Z}),ie=n(391062),re=n(908461),oe=n(384109),ae=n(846063),ue=(0,i.UY)({undo:re.Z,redo:ie.Z,findReplace:oe.ZP,editClear:ae.Z}),le=n(27595),se=n(765124),ce=(0,i.UY)({autoFilter:se.ZP,filterDelete:le.Z}),de=n(25163),fe=n(812781),he=n(191522),pe=n(293280),me=n(754603),be=n(797926),Te=n(55445),Se=n(726349),ve=n(842306),Ze=n(778268),_e=n(235061),ge=(0,i.UY)({ribbonFind:de.Z,ribbonSort:fe.Z,ribbonHomeFilter:he.Z,ribbonDataFilter:pe.Z,ribbonChart:me.Z,ribbonTextBox:be.Z,ribbonFunctions:Te.Z,ribbonFunctionAutoSum:Se.Z,ribbonEquationCalculate:ve.ZP,ribbonSortFilter:Ze.Z,ribbonDataValidation:_e.Z}),Fe=n(78742),Ee=(0,i.UY)({workSheetUnHide:Fe.Z}),Pe=n(473519),Ce=n(287564),we=n(423333),Re=n(291214),Ie=(0,i.UY)({showGridLineSlice:Ce.ZP,showHeaderFooterSlice:we.ZP,freezePane:Pe.Z,zoomMenu:Re.Z}),ye=n(10064),Be=(0,i.UY)({size:ye.ZP}),ke=(0,i.UY)({font:Z,hyperlink:g,picture:P,alignment:y,number:D,cell:H,shape:O,border:G,clipboard:ne,edit:ue,memo:J,filter:ce,others:ge,workSHeet:Ee,view:Ie,frame:Be}),De=n(480594),Ae=n(6087),xe=n(649861),Le=n(631724),Me=n(519370),He=n(465055),Ue=n(412574),Ne={command:ke,scrollBar:De.Z,formulaBar:Ae.ZP,functionTooltip:xe.ZP,functionAutoCompleteList:Le.ZP,sheetTabBar:Me.ZP,dataValidationDropdown:He.ZP,cellStatus:Ue.ZP}},480594:function(e,t,n){n.d(t,{p:function(){return c}});var i=n(601413),r=n(426373),o=n(135323),a=n(101922),u=n(588567),l=n(981142),s=(0,r.oM)({name:"scrollBar",initialState:(0,u.D5z)(),reducers:{},extraReducers:function(e){e.addCase(a.zv,(function(e){var t=l.o.getSheetScrollInfo();return(0,i.Z)({},t)}))}});t.Z=s.reducer;var c=(0,o.P1)((function(e){return e.scrollBar}),(function(e){return e}))},519370:function(e,t,n){n.d(t,{$I:function(){return Z},Ac:function(){return R},BV:function(){return C},EY:function(){return _},Hf:function(){return T},Lw:function(){return m},Lz:function(){return w},TN:function(){return k},Zh:function(){return g},hN:function(){return B},ho:function(){return I},kl:function(){return P},oc:function(){return S},qY:function(){return E},rs:function(){return v},te:function(){return y},u9:function(){return F},wX:function(){return b}});var i=n(426373),r=n(135323),o=n(416031),a=n(625477),u=n(981142),l=n(588567),s=n(735622),c=n(995124),d={left:0,right:0},f={current:0,tabList:[],scrollBarLeftRight:d,tabBarLeftRight:d,tabBarPositionLeft:0,isSheeTabRenaming:!1,isSheeTabDrag:!1},h=(0,i.oM)({name:"sheetTabBar",initialState:f,reducers:{setCurrentTab:function(e,t){e.current=t.payload},setTabList:function(e,t){e.tabList=t.payload},setScrollBarLeftRight:function(e,t){e.scrollBarLeftRight=t.payload},setTabBarLeftRight:function(e,t){e.tabBarLeftRight=t.payload},setTabBarPositionLeft:function(e,t){e.tabBarPositionLeft=t.payload},setIsSheeTabRenaming:function(e,t){e.isSheeTabRenaming=t.payload},setIsSheeTabDrag:function(e,t){var n=t.payload;e.isSheeTabDrag=n,!n&&(e.sheetTabDropTarget=void 0)},setSheetTabDropTarget:function(e,t){e.sheetTabDropTarget=t.payload}}}),p=h.actions,m=p.setCurrentTab,b=p.setTabList,T=p.setScrollBarLeftRight,S=p.setTabBarLeftRight,v=p.setTabBarPositionLeft,Z=p.setIsSheeTabRenaming,_=p.setIsSheeTabDrag,g=p.setSheetTabDropTarget;t.ZP=h.reducer;var F=(0,r.P1)((function(e){return e.sheetTabBar}),(function(e){return e})),E=function(){return(0,a.RU)("updateSheetTabThunk",(function(e){var t=u.o.getSheetNameList(l.dZ$.BR_SHEET_SHOW,!1),n=u.o.getCurrentSheetIndex();e(b(t)),e(m(n))}))},P=function(){return(0,a.RU)("addSheetTabThunk",(function(e,t){var n=t().sheetTabBar.current+1;u.o.sheetEdit(l.ZcN.BR_SHEET_INSERT,null,n,0,0,null,0,!1)&&e(E())}))},C=function(){return(0,a.RU)("removeSheetTabThunk",(function(e,t){var n=t().sheetTabBar.current;u.o.sheetEdit(l.ZcN.BR_SHEET_DELETE,null,n,0,0,null,0,!1)&&e(E())}))},w=function(){return(0,a.RU)("sheetTabDropThunk",(function(e,t){var n=t().sheetTabBar,i=n.current,r=n.sheetTabDropTarget;(0,o.isNil)(r)||i===r||e(R(r>i?r+1:r))}))},R=function(e){return(0,a.RU)("moveSheetTabThunk",(function(t,n){var i=n().sheetTabBar.current;u.o.sheetEdit(l.ZcN.BR_SHEET_MOVE,null,i,1,e,null,0,!1)&&t(E())}))},I=function(e){return(0,a.RU)("moveSheetTabThunk",(function(t,n){var i=n().sheetTabBar.current;u.o.sheetEdit(l.ZcN.BR_SHEET_INSERT,null,i,1,e,null,0,!0)&&t(E())}))},y=function(e,t){return(0,a.RU)("renameSheetTabThunk",(function(n,i){i().sheetTabBar.tabList.includes(t)||u.o.getSheetNameList(l.dZ$.BR_SHEET_HIDE,!1).includes(t)?s.Z.showDialog({dialogId:c.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_SHEET_TAB_RENAME_EQUALS"},currentTabIndex:0},(function(){n(m(e)),n(Z(!0))})):u.o.sheetEdit(l.ZcN.BR_SHEET_RENAME,t,e,0,0,null,0,!1)&&n(E())}))},B=function(){return(0,a.RU)("hideSheetTabThunk",(function(e,t){var n=t(),i=[],r=n.sheetTabBar.tabList[n.sheetTabBar.current],o=u.o.sheetGetPosition(r);i.push(o),u.o.sheetHideShow(0,o,i,1),e(E())}))},k=function(e){return(0,a.RU)("unHideSheetTabThunk",(function(t){var n=u.o.sheetGetPosition(e);u.o.sheetHideShow(l.dZ$.BR_SHEET_SHOW,n,[n],1),t(E())}))}}}]);