"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[965514],{827611:function(e,n,t){t.d(n,{Z:function(){return i}});t(747313);var s=t(837490),l=t(307360),a=t(346417);function i(e){var n=e.buttonLabels,t=e.onClick,i=e.buttonDisableStates;return(0,a.jsx)("div",{className:s.Z.popup_btn_wrap,children:n.map((function(e,n){var r=!!i&&i[n];return(0,a.jsx)("button",{className:"".concat(s.Z.p_btn," ").concat(s.Z.normal),onClick:function(){return t(n)},disabled:r,children:(0,a.jsx)(l.Z,{label:e})},n)}))})}},96001:function(e,n,t){t.d(n,{Z:function(){return i}});t(747313);var s=t(837490),l=t(307360),a=t(346417);function i(e){var n=e.tabs,t=e.onTabChange,i=e.tabIndex;return(0,a.jsx)("div",{className:s.Z.popup_tab,children:(0,a.jsx)("ul",{children:n.map((function(e,n){return(0,a.jsx)("li",{children:(0,a.jsx)("button",{className:i===n?s.Z.on:"",onClick:function(){return t(n)},children:(0,a.jsx)(l.Z,{label:e.label})})},n)}))})})}},965514:function(e,n,t){t.r(n),t.d(n,{default:function(){return g}});var s=t(601413),l=t(870885),a=t(747313),i=t(180252),r=t(837490),c=t(407604),o=t(735622),d=t(588567),u=t(448439),_=t(96001),h=t(827611),x=t(307360),j=t(346417);function E(e){var n=e.currentTabIndex,t=e.findOptions,l=e.setFindOptions,i=e.onInputKeyDown,c=(0,a.useCallback)((function(e){"sheet_find_string_input"===e.currentTarget.id?l((0,s.Z)((0,s.Z)({},t),{},{findString:e.currentTarget.value})):l((0,s.Z)((0,s.Z)({},t),{},{replaceString:e.currentTarget.value}))}),[t,l]);return(0,j.jsx)(a.Fragment,{children:(0,j.jsxs)("table",{className:r.Z.form_table,children:[(0,j.jsxs)("colgroup",{children:[(0,j.jsx)("col",{style:{width:"25%"}}),(0,j.jsx)("col",{style:{width:"auto"}})]}),(0,j.jsxs)("tbody",{children:[(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"DLG_FIND_FIND_WAHT"})}),(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:"".concat(r.Z.multi_select),children:(0,j.jsx)("div",{className:r.Z.i_txt,children:(0,j.jsx)("input",{type:"text",id:"sheet_find_string_input",value:t.findString,onChange:c,onKeyDown:i,spellCheck:!1})})})})]}),1===n?(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"DLG_FIND_REPLACE_WITH"})}),(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:"".concat(r.Z.multi_select),children:(0,j.jsx)("div",{className:r.Z.i_txt,children:(0,j.jsx)("input",{type:"text",id:"sheet_replace_string_input",value:t.replaceString,onChange:c,onKeyDown:i,spellCheck:!1})})})})]}):null]})]})})}var p=t(981142),b=t(625477),f=t(384109);function S(e){var n=e.findItem,t=e.isActive,s=e.rowIndex,l=e.selectRow,a=t?r.Z.active:"";return(0,j.jsxs)("tr",{onClick:function(){return l(n,s)},className:a,children:[(0,j.jsx)("td",{children:(0,j.jsx)("span",{children:n.szSheetName})}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{children:n.szDefindName})}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{children:n.szCellLacation})}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{children:n.szCellValue})}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{children:n.szCallFormular})})]})}function N(e){var n=e.commandName,t=u.Z.getCommandInstance(n).storeSelector,c=(0,i.v9)(t||function(){return null}),o=c?c.listSize:0,d=!!c&&c.isNeedUpdateList,_=(0,a.useState)([]),h=(0,l.Z)(_,2),E=h[0],N=h[1],I=(0,a.useState)(-1),L=(0,l.Z)(I,2),Z=L[0],m=L[1];(0,a.useEffect)((function(){if(d){for(var e=[],n=0;n<o;n+=1)e.push(p.o.getAllFindListValue(n));N(e),(0,b.Ce)((0,f.He)())}}),[o,d]);var F={label:"IDS_MSG_SHEET_FIND_RESULT_COUNT",options:{count:o}},g=(0,a.useCallback)((function(e,n){m(n),p.o.sheetGoToCell("'".concat(e.szSheetName,"'!").concat(e.szCellLacation))}),[]);return(0,j.jsxs)(a.Fragment,{children:[(0,j.jsx)("div",{className:r.Z.find_result,children:(0,j.jsx)("div",{className:r.Z.scroll_box,children:(0,j.jsxs)("table",{children:[(0,j.jsxs)("colgroup",{children:[(0,j.jsx)("col",{style:{width:"18%"}}),(0,j.jsx)("col",{style:{width:"18%"}}),(0,j.jsx)("col",{style:{width:"18%"}}),(0,j.jsx)("col",{style:{width:"20%"}}),(0,j.jsx)("col",{style:{width:"auto"}})]}),(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"SHEET_FIND_ALL_LIST_SHEET"})}),(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"SHEET_FIND_ALL_LIST_NAME"})}),(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"SHEET_FIND_ALL_LIST_CELL"})}),(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"SHEET_FIND_ALL_LIST_VALUE"})}),(0,j.jsx)("th",{children:(0,j.jsx)(x.Z,{label:"SHEET_FIND_ALL_LIST_FORMULA"})})]})}),(0,j.jsx)("tbody",{children:E&&E.map((function(e,n){var t={findItem:e,isActive:n===Z,rowIndex:n,selectRow:g};return(0,a.createElement)(S,(0,s.Z)((0,s.Z)({},t),{},{key:n}))}))})]})})}),(0,j.jsx)("p",{className:r.Z.info_txt,children:(0,j.jsx)(x.Z,(0,s.Z)({},F))})]})}var I=t(59127),L=t(311501),Z=t(995124),m=t(628264),F=t(652928);function g(e){var n=e.dialogIndex,t=e.dialogId,x=e.commandName,p=e.tabs,b=(0,i.v9)(m.p_).viewMode===F.wO.edit?p:[p[0]],f=u.Z.getCommandInstance(x),S=(0,i.v9)((0,c.R1)(n)).currentTabIndex,g=(0,a.useState)(S||0),C=(0,l.Z)(g,2),T=C[0],v=C[1],D=b[T].buttons,w=(0,a.useState)(!1),R=(0,l.Z)(w,2),A=R[0],k=R[1],H=(0,a.useState)({nFlag:0,findString:"",replaceString:""}),y=(0,l.Z)(H,2),O=y[0],W=y[1],B=(0,a.useCallback)((function(e){var n=(0,d.nYJ)();n.nFlag=e,n.pStrFind=O.findString,e!==d.oWw.BR_SHEET_FIND_REPLACEALL&&e!==d.oWw.BR_SHEET_FIND_REPLACEONE||(n.pStrReplace=O.replaceString),n.nFlag|=d.oWw.BR_SHEET_FIND_FINDROW,n.nFlag|=d.oWw.BR_SHEET_FIND_INFORMULAS,n.tFormatFind.wFormat=-1,n.tFormatReplace.wFormat=-1,f.invoke(n),e===d.oWw.BR_SHEET_FIND_ALLFIND&&k(!0)}),[f,O]),M=(0,a.useCallback)((function(e){e.stopPropagation()}),[]),P=(0,a.useCallback)((function(e){e.keyCode===I.S.Enter&&B(0)}),[B]),z={tabIndex:T,tabs:b,onTabChange:(0,a.useCallback)((function(e){return v(e)}),[])},U=!(O.findString.length>0),G={buttonLabels:D,buttonDisableStates:0===T?[U,U,!1]:[U,U,U,U,!1],onClick:(0,a.useCallback)((function(e){if(D.length-1!==e){var n=0;if(0===T)0===e&&(n=d.oWw.BR_SHEET_FIND_ALLFIND);else{switch(e){case 0:n=d.oWw.BR_SHEET_FIND_REPLACEALL;break;case 1:n=d.oWw.BR_SHEET_FIND_REPLACEONE;break;case 2:n=d.oWw.BR_SHEET_FIND_ALLFIND}if(L.Z.getProtectedSheetStatus()&&(n===d.oWw.BR_SHEET_FIND_REPLACEALL||n===d.oWw.BR_SHEET_FIND_REPLACEONE))return void o.Z.showDialog({dialogId:Z.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_SHEET_FIND_REPLACE_SHEET_PROTECT"}})}B(n)}else o.Z.hideDialog(t)}),[D.length,T,t,B])},K={currentTabIndex:T,findOptions:O,setFindOptions:W,onInputKeyDown:P},V={commandName:x};return(0,j.jsxs)(a.Fragment,{children:[(0,j.jsx)(_.Z,(0,s.Z)({},z)),(0,j.jsxs)("div",{className:r.Z.popup_contents,onMouseUp:M,children:[(0,j.jsx)(E,(0,s.Z)({},K)),A?(0,j.jsx)(N,(0,s.Z)({},V)):null]}),(0,j.jsx)(h.Z,(0,s.Z)({},G))]})}}}]);