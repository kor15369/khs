"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[146607,846775],{846775:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var o=t(215671),r=t(143144),i=t(957112),a=t(815e3),c=t(237683),u=t(977917),s=t(625477),l=t(361688),f=t(459551),m=t(159366),d=t(981142),p=t(588567),h=t(780386),g=t(735622),_=t(995124),P=t(652928),Z=t(53110),v=t(628264),D=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,m.mD)(e.name)?e.blob?L(e.name,e.blob).catch((function(e){return u.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):u.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):u.ZP.api.reject(n,"[Please include an extension in the name.]"):u.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):u.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return O()}},{key:"movePage",value:function(e){R(e)}},{key:"isReadOnlyDocument",value:function(){return T()}},{key:"getDocumentExtension",value:function(){return b()}}]),e}(),L=function(e,n){return new Promise((function(t,o){var r,i=(0,m.mD)(e);if(C(i)){c.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),t(),r=null,c.Z.removeListener("onOpenComplete")})),c.Z.setListener("onLoadFail",(function(n){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),o({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))}),r=null,c.Z.removeListener("onLoadFail")})),c.Z.setListener("onLoadForce",(function(){null!==r&&a(r,!0),r=null,c.Z.removeListener("onLoadForce")}));var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?h.Z.setOpenMode(p.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):h.Z.setOpenMode(p.ekp.ePRM_COMMON),h.Z.setDocData(n,i);var o=(0,s.qm)(l.LG),r=(0,s.qm)(l.CI);(0,Z.Vq)()?d.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,o.width*r,o.height*r):d.o.memoryOpen(".".concat(i),e,e.byteLength,o.width*r,o.height*r,t),(0,s.Ce)((0,v._j)(!1))},u=new FileReader;u.onload=function(){u.readyState===FileReader.DONE&&u.result instanceof ArrayBuffer&&(r=u.result,a(u.result))};var P=function(e){o({message:e,errorCode:-1,closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})};u.onabort=function(){P("Reading the file is aborted. '".concat(u.error,"'."))},u.onerror=function(){P("Failed to read file. '".concat(u.error,"'."))},u.readAsArrayBuffer(n)}else g.Z.showDialog({dialogId:_.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){o({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){c.Z.setListener("onCancelOpenDocument",(function(){e(),c.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},O=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},C=function(e){var n=(0,s.qm)(f.hz).docType,t=e.toLowerCase();if(n===P.n_.hwp){if(["hwp","hwpx"].includes(t))return!0}else if(n===P.n_.word){if(["doc","docx"].includes(t))return!0}else if(n===P.n_.sheet){if(["xls","xlsx","csv"].includes(t))return!0}else if(n===P.n_.slide&&["ppt","pptx"].includes(t))return!0;return!1},R=function(e){var n=e,t=d.o.getConfig().nTotalPages;n<1&&(n=1),n>t&&(n=t),d.o.movePage(p.ZbX.eEV_MOVE_SETPAGE,n)},T=function(){return h.Z.isProtectDoc()||h.Z.isReadOnlyDoc()},b=function(){return(0,s.qm)(f.hz).extension}},146607:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var o=t(215671),r=t(143144),i=t(179340),a=t(432269),c=t(846775),u=t(237683),s=t(588567),l=t(981142),f=t(977917),m=function(e){(0,i.Z)(t,e);var n=(0,a.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"getDocumentInformation",value:function(){return d()}},{key:"exportAsImage",value:function(){return p().catch((function(e){return f.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}}]),t}(c.default),d=function(){var e=l.o.getSummaryData();return{title:e.szTitle,author:e.szAuthor,modifiedBy:e.szModifiedBy}},p=function(){return new Promise((function(e,n){var t=l.o.getSheetPrintTotalPages(s.AJA.BR_PRINT_150,0,s._AE.ePXMAS_XLS_PRINT_ACTIVE_SHEET|s._AE.ePXMAS_XLS_PRINT_FIT_NOSCALE),o=[],r=setTimeout((function(){o.length!==t&&n(new Error("\n                        The file is too large to print."))}),1e4);u.Z.setListener("onExportAsImage",(function(n,i){i&&(o[n-1]=i),o.length===t&&(e({blobs:o}),u.Z.removeListener("onExportAsImage"),clearTimeout(r))})),l.o.setPrint(s.e_4.BR_PRINT_PAGESIZE_A4,1,t,s.nXZ.PRINT_JPG_IMG,s.AJA.BR_PRINT_150)}))}}}]);