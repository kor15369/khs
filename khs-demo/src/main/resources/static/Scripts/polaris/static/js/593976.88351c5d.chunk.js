"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[593976],{593976:function(e,t,n){n.r(t),n.d(t,{HyperlinkTab:function(){return l},default:function(){return m}});var l,r=n(601413),a=n(870885),s=n(747313),i=n(180252),c=n(700936),u=n(837490),o=n(735622),h=n(448439),b=n(96001),T=n(827611),p=n(307360),x=n(407604),C=n(981142),d=n(588567),j=n(416031),_=n(305054),k=n(530624),L=n(551261),O=n(346417);function m(e){var t="mailto:",n=(0,c.Z)().formatMessage,m=(0,i.I0)(),I=e.dialogId,y=e.tabs,g=e.commandName,E=h.Z.getCommandInstance(g),f=(0,s.useState)(!1),N=(0,a.Z)(f,2),S=N[0],Z=N[1],D=(0,s.useState)(""),q=(0,a.Z)(D,2),v=q[0],K=q[1],H=(0,s.useState)(""),R=(0,a.Z)(H,2),A=R[0],P=R[1],M=(0,s.useState)(""),G=(0,a.Z)(M,2),B=G[0],V=G[1],W=(0,s.useState)(l.Web),Q=(0,a.Z)(W,2),U=Q[0],Y=Q[1],w=(0,s.useState)(!1),z=(0,a.Z)(w,2),F=z[0],X=z[1],J=(0,s.useState)(!1),$=(0,a.Z)(J,2),ee=$[0],te=$[1],ne=(0,s.useState)([]),le=(0,a.Z)(ne,2),re=le[0],ae=le[1],se=(0,s.useState)(0),ie=(0,a.Z)(se,2),ce=ie[0],ue=ie[1],oe=y[U].buttons,he="<<".concat(n({id:"DLG_HYPERLINK_SELECTED_ON_DOCUMENT"}),">>"),be=(0,s.useCallback)((function(){E.invoke({actionType:L.U.DeleteHyperlink})}),[E]),Te=(0,s.useCallback)((function(){var e="";e=U===l.Web?A:U===l.CurrentDocument?re[ce].linkType===d.QLl.EV_LINK_TO_START_DOC?"_top":re[ce].label:B,E.invoke({actionType:L.U.InsertHyperlink,displayText:""===v?e:v,hyperlink:e,hyperLinkTab:U,selectedLinkType:U===l.CurrentDocument?re[ce].linkType:null})}),[E,v,B,U,ce,re,A]),pe=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),xe=(0,s.useCallback)((function(e){"Enter"===e.key&&A.length>0&&(Te(),o.Z.hideDialog(I))}),[I,Te,A.length]),Ce=(0,s.useCallback)((function(e){ue(e),te(!re[e].canInsertHyperlink)}),[re]),de={tabIndex:U,tabs:y,onTabChange:(0,s.useCallback)((function(e){e===l.Web?te(!!(v.length<1||A.length<1)):e===l.CurrentDocument?te(!re[ce].canInsertHyperlink):e===l.Email&&te(!!(v.length<1||B.length<1)),Y(e)}),[v.length,A.length,re,ce,B.length])},je={buttonLabels:oe,buttonDisableStates:[F,ee,!1],onClick:(0,s.useCallback)((function(e){0===e?be():1===e&&Te(),o.Z.hideDialog(I)}),[I,be,Te])},_e=(0,s.useCallback)((function(e){K(e.currentTarget.value),U===l.Web?te(!!(A.length<1)):U===l.CurrentDocument?te(!re[ce].canInsertHyperlink):U===l.Email&&te(!!(e.currentTarget.value.length<1||B.length<1))}),[U,A.length,re,ce,B.length]),ke=(0,s.useCallback)((function(e){P(e.currentTarget.value),te(!!(e.currentTarget.value.length<1))}),[]),Le=(0,s.useCallback)((function(e){var n="";if(e.currentTarget.value.startsWith(t))n=e.currentTarget.value;else{for(var l=t.split(""),r=e.currentTarget.value.split(""),a=0;a<r.length&&!(l.length<=a)&&r[a]===l[a];a+=1)r[a]="";n=t+r.join("")}V(n),te(!!(v.length<1||e.currentTarget.value.length<1))}),[v.length]),Oe=(0,s.useCallback)((function(e){var t="DLG_HYPERLINK_TITLE_EDIT_HYPERLINK";return e.nLinkType===d.QLl.EV_LINK_TO_BOOKMARK?t:(0,j.isEmpty)(e.szHyperLink)?"DLG_HYPERLINK_TITLE_INSERT_HYPERLINK":t}),[]),me=(0,s.useCallback)((function(){switch(_.Z.getObjectControlType()){case k.uq.eObjCtrTemplate:case k.uq.eObjCtrShape:case k.uq.eObjCtrGroup:case k.uq.eObjCtrGroupInlineText:case k.uq.eObjCtrLine:case k.uq.eObjCtrLineInlineText:case k.uq.eObjCtrInfraPen:case k.uq.eObjCtrInfraPenInlineText:case k.uq.eObjCtrImageInlineText:case k.uq.eObjCtrImage:case k.uq.eObjCtrTextBox:case k.uq.eObjCtrTextBoxInlineText:case k.uq.eObjCtrChart:case k.uq.eObjCtrTemplateInlineText:case k.uq.eObjCtrFLine:case k.uq.eObjCtrFLineInlineText:case k.uq.eObjCtrSmtArtGroup:case k.uq.eObjCtrSmtArtGroupInlineText:case k.uq.eObjCtrSmtArtChildShape:case k.uq.eObjCtrSmtArtChildLine:case k.uq.eObjCtrPargraphStrip:case k.uq.eObjCtrPargraphStripInline:return!0}}),[]),Ie=(0,s.useCallback)((function(){switch(_.Z.getObjectControlType()){case k.uq.eObjCtrChartTextSelect:case k.uq.eObjCtrTableTextSelect:case k.uq.eObjCtrTextBoxTextSelect:case k.uq.eObjCtrTemplateTextSelect:case k.uq.eObjCtrMemoTextSelect:case k.uq.eObjCtrDropCapTextSelect:case k.uq.eObjCtrFLineTextSelect:case k.uq.eObjCtrSmtArtChildTextSelect:case k.uq.eObjCtrEquationTextSelect:case k.uq.eObjCtrHWPEquationTextSelect:return!0}return!1}),[]),ye=(0,s.useCallback)((function(e){var t="",n="",l=!0,r=!1;return e.nLinkType!==d.QLl.EV_LINK_TO_URL&&e.nLinkType!==d.QLl.EV_LINK_TO_BOOKMARK&&e.nLinkType!==d.QLl.EV_LINK_TO_EMAIL||(r=!0),me()?(t=he,l=!1,r&&(n=e.szHyperLink)):r?((0,j.isEmpty)(e.szHyperText)&&!(0,j.isEmpty)(e.szHyperLink)?(t=he,l=!1):t=e.szHyperText,n=e.szHyperLink):Ie()&&(0,j.isEmpty)(e.szHyperText)?(t=he,l=!1):t=e.szHyperText,{hyperlinkText:t,hyperlinkUrl:n,isDisplayTextEnable:l}}),[me,Ie,he]);return(0,s.useEffect)((function(){var e=C.o.getHyperlinkInfo(0,0,!0),t=ye(e),r=t.hyperlinkText,a=t.hyperlinkUrl,s=t.isDisplayTextEnable,i=n({id:Oe(e)}),c=[];c.push({linkType:d.QLl.EV_LINK_TO_START_DOC,label:n({id:"DLG_INSERT_LINK_DOCUMENT_TOP"}),canInsertHyperlink:!0,isIndent:!1,bookmark:"_top"}),c.push({linkType:d.QLl.EV_LINK_TO_BOOKMARK,label:n({id:"BOOKMARK"}),canInsertHyperlink:!1,isIndent:!1,bookmark:""});for(var u=C.o.getBookmarks(!0),o=0;o<u.length;o+=1)"_"!==u[o].charAt(0)&&c.push({linkType:d.QLl.EV_LINK_TO_BOOKMARK,label:u[o],canInsertHyperlink:!0,isIndent:!0,bookmark:u[o]});ae(c),e.nLinkType===d.QLl.EV_LINK_TO_BOOKMARK?(Y(l.CurrentDocument),te(!c[0].canInsertHyperlink),ue(c.findIndex((function(e){return e.bookmark===a})))):e.nLinkType===d.QLl.EV_LINK_TO_EMAIL?(Y(l.Email),V(a),te(!(r.length>0&&a.length>0))):(Y(l.Web),P(a),te(!(r.length>0&&a.length>0))),K(r),Z(!s),X(!(r.length>0&&a.length>0)),m((0,x.GV)({dialogId:I,dynamicTitle:i}))}),[n,E,I,m,Oe,ye,ae]),(0,O.jsxs)(s.Fragment,{children:[(0,O.jsx)(b.Z,(0,r.Z)({},de)),(0,O.jsx)("div",{className:u.Z.popup_contents,onMouseUp:pe,onKeyDown:xe,children:(0,O.jsxs)("table",{className:u.Z.form_table,children:[(0,O.jsx)("colgroup",{children:(0,O.jsx)("col",{style:{width:"auto"}})}),(0,O.jsxs)("tbody",{children:[(0,O.jsx)("tr",{children:(0,O.jsx)("th",{children:(0,O.jsx)(p.Z,{label:"DLG_HYPERLINK_TEXT_TO_DISPLAY"})})}),(0,O.jsx)("tr",{children:(0,O.jsx)("td",{children:(0,O.jsx)("div",{className:u.Z.multi_select,children:(0,O.jsx)("div",{className:u.Z.i_txt,children:(0,O.jsx)("input",{type:"text",value:v,onChange:_e,spellCheck:!1,readOnly:!!S,className:S?u.Z.disabled:""})})})})}),U===l.Web?(0,O.jsx)("tr",{children:(0,O.jsx)("th",{children:(0,O.jsx)(p.Z,{label:"DLG_HYPERLINK_ADDRESS"})})}):null,U===l.Web?(0,O.jsx)("tr",{children:(0,O.jsx)("td",{children:(0,O.jsx)("div",{className:u.Z.multi_select,children:(0,O.jsx)("div",{className:u.Z.i_txt,children:(0,O.jsx)("input",{type:"text",value:A,onChange:ke,spellCheck:!1})})})})}):null,U===l.CurrentDocument?(0,O.jsx)("tr",{children:(0,O.jsx)("th",{children:(0,O.jsx)(p.Z,{label:"DLG_HYPERLINK_TAB_CURRENT_DOCUMENT"})})}):null,U===l.CurrentDocument?(0,O.jsx)("tr",{children:(0,O.jsx)("td",{children:(0,O.jsx)("div",{className:u.Z.flex_box,children:(0,O.jsx)("div",{className:u.Z.inner_box,children:(0,O.jsx)("div",{className:u.Z.list_box,style:{height:"368px"},children:(0,O.jsx)("ul",{children:re.map((function(e,t){var n=e.label,l=e.isIndent,r="";return t===ce&&(r=u.Z.active),l&&(r+=" ".concat(u.Z.indent)),(0,O.jsx)("li",{children:(0,O.jsx)("button",{className:r,onClick:function(){return Ce(t)},children:n})},t)}))})})})})})}):null,U===l.Email?(0,O.jsx)("tr",{children:(0,O.jsx)("th",{children:(0,O.jsx)(p.Z,{label:"DLG_HYPERLINK_TAB_EMAIL"})})}):null,U===l.Email?(0,O.jsx)("tr",{children:(0,O.jsx)("td",{children:(0,O.jsx)("div",{className:u.Z.multi_select,children:(0,O.jsx)("div",{className:u.Z.i_txt,children:(0,O.jsx)("input",{type:"text",value:B,onChange:Le,spellCheck:!1})})})})}):null]})]})}),(0,O.jsx)(T.Z,(0,r.Z)({},je))]})}!function(e){e[e.Web=0]="Web",e[e.CurrentDocument=1]="CurrentDocument",e[e.Email=2]="Email"}(l||(l={}))}}]);