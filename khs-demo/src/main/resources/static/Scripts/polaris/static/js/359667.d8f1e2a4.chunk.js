"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[359667,161308,846775,146607],{161308:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=n(215671),r=n(143144),i=n(237683),a=n(977917),u=n(625477),c=n(361688),s=n(459551),l=n(981142),f=n(588567),d=n(628264),m=n(769071),h=n(735622),v=n(995124),g=n(815e3),p=n(780386),T=n(159366),_=n(305054),S=n(382800),b=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"saveDocument",value:function(){return R().catch((function(e){return a.ZP.api.reject("The document could not be saved.","[".concat(e.message,"]"))}))}},{key:"isModified",value:function(){return y()}},{key:"getDocContentRect",value:function(){return C()}},{key:"getTitleBarRect",value:function(){return E()}},{key:"getRibbonTabMenuRect",value:function(){return I()}},{key:"getRibbonBarRect",value:function(){return k()}},{key:"getViewMode",value:function(){return P()}},{key:"activeInput",value:function(){w()}},{key:"isProtectedDocument",value:function(){return p.Z.isPasswordDocument}},{key:"insertImage",value:function(e,t){}},{key:"insertHtmlData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l.o.insertHtmlData(t?f.vlz.CLIPDATA_HTML:f.vlz.CLIPDATA_STR,e),m.Z.focus("DocInputField"),S.Z.updateDrawCaret()}},{key:"insertString",value:function(e){l.o.insertString(e,f.v$l.BR_IME_COMPOSITING_RESULT)}},{key:"getMarkString",value:function(){return l.o.getMarkString()}},{key:"getCaretInfo",value:function(){var e=l.o.getCaretInfoFromJson().nCaretStatus;return{status:(f.Bn1[e]||"").replaceAll("BR_","").toLowerCase(),objectType:_.Z.getObjectType(),objectCount:_.Z.getObjectCount()}}},{key:"getFrameToImageBlob",value:function(e){return D(e)}},{key:"downloadSelectFrame",value:function(e,t){A(e,t)}},{key:"getHtmlTextContent",value:function(e){return L(e)}}]),e}(),R=function(){return new Promise((function(e,t){var n=(0,u.qm)(s.hz),o=n.extension,r=n.docName;if(i.Z.setListener("onSaveDocument",(function(n,a){if(n===f.WbN.kPoProcessSucess&&a)if("hwpx"===o){var u="".concat(r.replace(new RegExp(".".concat(o,"$")),".hwp"));e({name:u,blob:a})}else e({name:r,blob:a});else t(new Error("Error ".concat(n)));i.Z.removeListener("onSaveDocument")})),o&&"csv"===o.toLowerCase()&&!0===g.ZP.get("isShowAlertDialogForCSVSaving"))h.Z.showDialog({dialogId:v.O.CONFIRM_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_CSV_SAVE_INFO"},currentTabIndex:0},(function(e){0===e?l.o.saveDocument(o):t(new Error("Canceled by user."))}));else{var a=o;"hwpx"===o&&(a="hwp"),l.o.saveDocument(a)}}))},y=function(){return l.o.isDocumentModified()},C=function(){return(0,u.qm)(c.SV)},E=function(){return(0,u.qm)(c.IU)},I=function(){return(0,u.qm)(c.ms)},k=function(){return(0,u.qm)(c.qr)},P=function(){return(0,u.qm)(d.p_).viewMode},w=function(){m.Z.focus("DocInputField")},D=function(e){if(_.Z.isImageObject()&&1===_.Z.getObjectCount()){var t=(0,T.km)(e);return l.o.frameToImageBuffer(t)}return null},A=function(e,t){var n=(0,T.km)(t),o=l.o.frameToImageBuffer(n),r=document.createElement("a");r.style.display="none",document.body.appendChild(r);var i=window.URL.createObjectURL(o);r.href=i,r.download="".concat(e,".").concat(t),r.click(),window.URL.revokeObjectURL(i),document.body.removeChild(r)},L=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=t.children,o="",r=0;r<n.length;r+=1){var i;"STYLE"!==n[r].tagName&&(o+=null===(i=n[r].textContent)||void 0===i?void 0:i.replace(/\s\s+/g,"\n"))}return o}},846775:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=n(215671),r=n(143144),i=n(957112),a=n(815e3),u=n(237683),c=n(977917),s=n(625477),l=n(361688),f=n(459551),d=n(159366),m=n(981142),h=n(588567),v=n(780386),g=n(735622),p=n(995124),T=n(652928),_=n(53110),S=n(628264),b=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"openDocument",value:function(e){var t="The document could not be opened.";return e?e.name?(0,d.mD)(e.name)?e.blob?R(e.name,e.blob).catch((function(e){return c.ZP.api.rejectOpenDocument("".concat(t," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):c.ZP.api.reject(t,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):c.ZP.api.reject(t,"[Please include an extension in the name.]"):c.ZP.api.reject(t,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):c.ZP.api.reject(t,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return y()}},{key:"movePage",value:function(e){E(e)}},{key:"isReadOnlyDocument",value:function(){return I()}},{key:"getDocumentExtension",value:function(){return k()}}]),e}(),R=function(e,t){return new Promise((function(n,o){var r,i=(0,d.mD)(e);if(C(i)){u.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),n(),r=null,u.Z.removeListener("onOpenComplete")})),u.Z.setListener("onLoadFail",(function(t){(0,s.Ce)((0,f.RY)(e)),(0,s.Ce)((0,f.Js)(i)),o({message:"Loading failed '".concat(e,"'."),errorCode:t,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))}),r=null,u.Z.removeListener("onLoadFail")})),u.Z.setListener("onLoadForce",(function(){null!==r&&a(r,!0),r=null,u.Z.removeListener("onLoadForce")}));var a=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===i?v.Z.setOpenMode(h.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):v.Z.setOpenMode(h.ekp.ePRM_COMMON),v.Z.setDocData(t,i);var o=(0,s.qm)(l.LG),r=(0,s.qm)(l.CI);(0,_.Vq)()?m.o.memoryOpenForViewerSDK(".".concat(i),e,e.byteLength,o.width*r,o.height*r):m.o.memoryOpen(".".concat(i),e,e.byteLength,o.width*r,o.height*r,n),(0,s.Ce)((0,S._j)(!1))},c=new FileReader;c.onload=function(){c.readyState===FileReader.DONE&&c.result instanceof ArrayBuffer&&(r=c.result,a(c.result))};var T=function(e){o({message:e,errorCode:-1,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})};c.onabort=function(){T("Reading the file is aborted. '".concat(c.error,"'."))},c.onerror=function(){T("Failed to read file. '".concat(c.error,"'."))},c.readAsArrayBuffer(t)}else g.Z.showDialog({dialogId:p.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(i,")")}},currentTabIndex:0},(function(){o({message:"This document format is not supported. '(.".concat(i,")'"),closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},y=function(){return{version:a.i8,formats:a.bd,licenseKey:i.C}},C=function(e){var t=(0,s.qm)(f.hz).docType,n=e.toLowerCase();if(t===T.n_.hwp){if(["hwp","hwpx"].includes(n))return!0}else if(t===T.n_.word){if(["doc","docx"].includes(n))return!0}else if(t===T.n_.sheet){if(["xls","xlsx","csv"].includes(n))return!0}else if(t===T.n_.slide&&["ppt","pptx"].includes(n))return!0;return!1},E=function(e){var t=e,n=m.o.getConfig().nTotalPages;t<1&&(t=1),t>n&&(t=n),m.o.movePage(h.ZbX.eEV_MOVE_SETPAGE,t)},I=function(){return v.Z.isProtectDoc()||v.Z.isReadOnlyDoc()},k=function(){return(0,s.qm)(f.hz).extension}},359667:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var o,r,i=n(601413),a=n(974165),u=n(115861),c=n(215671),s=n(143144),l=n(179340),f=n(432269),d=n(237683),m=n(588567),h=n(981142),v=n(202265),g=n(625477),p=n(384109),T=n(423333),_=n(977917),S=n(459551),b=n(311501),R=n(371266),y=n(530624),C=n(305054),E=n(519370),I=n(361688),k=n(780386),P=n(416031),w=n(146607),D=n(161308),A=n(628264),L=n(53110),Z=n(995124),F=n(407604),O=n(6087);!function(e){e.Panes="panes",e.TopRow="top_row",e.FirstColumn="first_column"}(o||(o={})),function(e){e.selected_area="selected_area",e.entire_workbook="entire_workbook",e.selected_sheet="selected_sheet"}(r||(r={}));var M=function(e){(0,l.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,c.Z)(this,n),(e=t.call(this)).commonAPI=void 0,e.commonAPI=new D.default,e}return(0,s.Z)(n,[{key:"saveDocument",value:function(){return this.commonAPI.saveDocument()}},{key:"getViewMode",value:function(){return this.commonAPI.getViewMode()}},{key:"activeInput",value:function(){return this.commonAPI.activeInput()}},{key:"getDocContentRect",value:function(){return this.commonAPI.getDocContentRect()}},{key:"getTitleBarRect",value:function(){return this.commonAPI.getTitleBarRect()}},{key:"getRibbonTabMenuRect",value:function(){return this.commonAPI.getRibbonTabMenuRect()}},{key:"getRibbonBarRect",value:function(){return this.commonAPI.getRibbonBarRect()}},{key:"isProtectedDocument",value:function(){return this.commonAPI.isProtectedDocument()}},{key:"insertHtmlData",value:function(e){return this.commonAPI.insertHtmlData(e)}},{key:"insertString",value:function(e){return this.commonAPI.insertString(e)}},{key:"getMarkString",value:function(){return this.commonAPI.getMarkString()}},{key:"getCaretInfo",value:function(){return this.commonAPI.getCaretInfo()}},{key:"getFrameToImageBlob",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"png";return this.commonAPI.getFrameToImageBlob(e)}},{key:"downloadSelectFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PoImage",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png";this.commonAPI.downloadSelectFrame(e,t)}},{key:"openNewDocument",value:function(){return x().catch((function(e){return _.ZP.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"exportAsCSV",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"The document could not be exported as csv.",e.next=3,B().catch((function(e){return _.ZP.api.reject("The document could not be exported as csv.","[".concat(e.message,"]"))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"exportAsPDF",value:function(e){var t=e.target,n=e.isPdfAExport,o="The document could not be exported as pdf.";return(0,P.isNil)(t)||"string"!==typeof t||!(t in r)?_.ZP.api.reject(o,"['target' argument is invalid . Please set a valid 'target' argument and try again.]"):(0,P.isNil)(n)||"boolean"!==typeof n?_.ZP.api.reject(o,"['isPdfAExport' argument is invalid . Please set a valid 'target' argument and try again.]"):N(e).catch((function(e){return _.ZP.api.reject(o,"[".concat(e.message,"]"))}))}},{key:"freezePane",value:function(e){H(e)}},{key:"isFreezePane",value:function(){return j()}},{key:"autoFilter",value:function(){q()}},{key:"findText",value:function(e){G(e)}},{key:"isShowHeader",value:function(){return U()}},{key:"showHeader",value:function(e){W(e)}},{key:"insertImage",value:function(e,t){try{return V(e,t)}catch(n){return _.ZP.api.reject("","[".concat(n.message,"]"))}}},{key:"insertHyperlink",value:function(e,t){z(e,t)}},{key:"insertHyperLink",value:function(e,t){z(e,t)}},{key:"getSheetNameList",value:function(){return Y()}},{key:"getMemoList",value:function(e){return J(e)}},{key:"goToCell",value:function(e){X(e)}},{key:"insertMemo",value:function(e){$(e)}},{key:"deleteMemo",value:function(){K()}},{key:"editMemo",value:function(e){Q(e)}},{key:"isExistMemo",value:function(){return ee()}},{key:"canInsertHyperlink",value:function(){return!b.Z.isDisable(R.HXA)}},{key:"canInsertMemo",value:function(){return te()&&!this.isExistMemo()}},{key:"canEditMemo",value:function(){return te()&&this.isExistMemo()}},{key:"canDeleteMemo",value:function(){var e=h.o.getSheetSelectionCommentCout()>0,t=b.Z.getProtectedSheetStatus(),n=C.Z.getObjectControlType();return(e||n===y.uq.eObjCtrMemo)&&!t}},{key:"getCellRange",value:function(){return ne()}},{key:"isMergedCell",value:function(){return oe()}},{key:"isModified",value:function(){return re()}},{key:"getSelectedMemoInfo",value:function(){return ie()}},{key:"getPointDocLink",value:function(){return ae()}},{key:"setPointDocLink",value:function(e){ue(e)}},{key:"showOpenPasswordDialog",value:function(){ce()}},{key:"showWritePasswordDialog",value:function(){se()}},{key:"setOpenPassword",value:function(e){le(e)}},{key:"setWritePassword",value:function(e){fe(e)}},{key:"getHtmlTextContent",value:function(e){return this.commonAPI.getHtmlTextContent(e)}},{key:"getFormulaBarFieldText",value:function(){return de()}}]),n}(w.default),x=function(){return new Promise(function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,n){var o,r,i,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,g.Ce)((0,S.ge)("xlsx"));try{o=(0,g.qm)(S.hz),r=o.extension,i=(0,g.qm)(I.LG),u=(0,g.qm)(I.CI),d.Z.setListener("onOpenComplete",(function(){t(),d.Z.removeListener("onOpenComplete")})),k.Z.setOpenMode(m.ekp.ePRM_COMMON),h.o.newDocument(".".concat(r),i.width*u,i.height*u),(0,g.Ce)((0,A._j)(!0))}catch(a){n(a)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},B=function(){return new Promise((function(e,t){var n=(0,g.qm)(S.hz),o=n.extension,r=n.docName;d.Z.setListener("onSaveDocument",(function(n,i){if(n===m.WbN.kPoProcessSucess&&i){var a="".concat(r.replace(new RegExp(".".concat(o,"$")),".csv"));e({name:a,blob:i})}else t(new Error("Error ".concat(n)));d.Z.removeListener("onSaveDocument")})),h.o.saveDocument("csv",m.dLw.BR_SAVE_OPTION_TEMP_SAVE|m.dLw.BR_SAVE_OPTION_INFRA_PENDRAW_SAVE)}))},N=function(e){return new Promise((function(t,n){var o,i=e.target,a=e.isPdfAExport,u=(0,g.qm)(S.hz),c=u.docName,s=u.extension;switch(d.Z.setListener("onSaveDocument",(function(e,o){if(e===m.WbN.kPoProcessSucess&&o){var r="".concat(c.replace(new RegExp(".".concat(s,"$")),".pdf"));t({name:r,blob:o})}else n(new Error("Error ".concat(e)));d.Z.removeListener("onSaveDocument")})),i){case r.selected_area:o=m.tcK.BR_SELECTED_AREA;break;case r.entire_workbook:o=m.tcK.BR_SHEET_ALL;break;case r.selected_sheet:o=m.tcK.BR_ACTIVE_SHEET}o&&h.o.saveSheetDocument("pdf",o,a,!0,400)}))},H=function(e){var t=-1;switch(e){case o.Panes:t=m.wa9.eSFFT_NORMAL;break;case o.TopRow:t=m.wa9.eSFFT_FIRST_ROW;break;case o.FirstColumn:t=m.wa9.eSFFT_FIRST_COL}t>=0&&h.o.sheetFixFrame(t)},j=function(){return h.o.isCurrentSheetFreeze()},q=function(){return v.Z.sheetAutoFilter()},G=function(e){var t=(0,m.nYJ)();t.pStrFind=e,(0,g.Ce)((0,p.Mo)(t))},U=function(){return h.o.isSheetShowHeader()},W=function(e){return(0,g.Ce)((0,T.Y0)(e))},V=function(e,t){return new Promise(function(){var n=(0,u.Z)((0,a.Z)().mark((function n(o,r){var i,u,c,s,l;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,L.Cq)(e);case 3:if((i=n.sent)instanceof ArrayBuffer){n.next=6;break}return n.abrupt("return");case 6:u=(null===t||void 0===t?void 0:t.width)||0,c=(null===t||void 0===t?void 0:t.height)||0,0,s=(null===t||void 0===t?void 0:t.posX)||0,l=(null===t||void 0===t?void 0:t.posY)||0,h.o.imageInsert(i,u,c,0,s,l),o(),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),r(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},z=function(e,t){var n=(0,i.Z)((0,i.Z)({},(0,m.Nuw)()),{},{nLinkType:m.RKp.BR_SHEET_HYPERLINK_URL,szHyperLink:e,szHyperText:t||""});h.o.setSheetHyperLinkInfo(n)},Y=function(){return h.o.getSheetNameList(m.dZ$.BR_SHEET_SHOW,!1)},J=function(e){for(var t=h.o.getCommentInfoCount(e),n=[],o=0;o<t;o+=1){var r=h.o.getCommentInfo(e,o);n.push(r)}return n},X=function(e){h.o.sheetGoToCell(e)},$=function(e){h.o.sheetInsertCommentText(e)},K=function(){h.o.sheetDeleteCommentText()},Q=function(e){h.o.sheetInsertCommentText(e)},ee=function(){return h.o.isExistComment()},te=function(){var e=b.Z.getProtectedSheetStatus(),t=C.Z.getObjectControlType(),n=t===y.uq.eObjCtrSheetCell||t===y.uq.eObjCtrSheetColumn||t===y.uq.eObjCtrSheetRow||t===y.uq.eObjCtrTable||t===y.uq.eObjCtrTableCell||t===y.uq.eObjCtrMemo;return!(e||!1===n)},ne=function(){var e=h.o.getCellInfo(),t={firstRow:e.tSelectedRange.nRow1,firstCol:e.tSelectedRange.nCol1,lastRow:e.tSelectedRange.nRow2,lastCol:e.tSelectedRange.nCol2};if(-1!==t.firstRow&&-1!==t.firstCol&&-1!==t.lastRow&&-1!==t.lastCol)return t},oe=function(){return 0!==(h.o.getSheetFormatInfo(!1).dwCellType&m.aH7.BR_SHEET_CELL_TYPE_SINGLE_MERGE)},re=function(){return h.o.isDocumentModified()||h.o.isSheetEditingCell()},ie=function(){var e=(0,g.qm)(E.u9),t=e.current,n=e.tabList,o=h.o.getCellInfo(),r=o.tSelectedRange.nRow1,i=o.tSelectedRange.nCol1;if(o.tSelectedRange.nRow1===o.tSelectedRange.nRow2&&o.tSelectedRange.nCol1===o.tSelectedRange.nCol2)for(var a=h.o.getCommentInfoCount(t),u=0;u<a;u+=1){var c=h.o.getCommentInfo(t,u);if(c.nRow===r&&c.nCol===i)return{memo:c.pTextBuf,sheetName:n[t],row:r,col:i}}},ae=function(){return h.o.getPointDocLink()},ue=function(e){h.o.setPointDocLink(e)},ce=function(){var e=""===h.o.getPasswordStr().szOpenPassword?Z.O.OPEN_PASSWORD_SETTING_DIALOG:Z.O.OPEN_PASSWORD_CHANGE_DIALOG;(0,g.Ce)((0,F.vC)({dialogId:e,bModal:!0,currentTabIndex:0}))},se=function(){var e=""===h.o.getPasswordStr().szWritePassword?Z.O.WRITE_PASSWORD_SETTING_DIALOG:Z.O.WRITE_PASSWORD_CHANGE_DIALOG;(0,g.Ce)((0,F.vC)({dialogId:e,bModal:!0,currentTabIndex:0}))},le=function(e){var t=h.o.getPasswordStr(),n=h.o.isReadOnlyRecommendedDoc();h.o.setPasswordStr(e,t.szWritePassword,n)},fe=function(e){var t=h.o.getPasswordStr(),n=h.o.isReadOnlyRecommendedDoc();h.o.setPasswordStr(t.szOpenPassword,e,n)},de=function(){return(0,g.qm)(O.rW).fieldText}},146607:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var o=n(215671),r=n(143144),i=n(179340),a=n(432269),u=n(846775),c=n(237683),s=n(588567),l=n(981142),f=n(977917),d=function(e){(0,i.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"getDocumentInformation",value:function(){return m()}},{key:"exportAsImage",value:function(){return h().catch((function(e){return f.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}}]),n}(u.default),m=function(){var e=l.o.getSummaryData();return{title:e.szTitle,author:e.szAuthor,modifiedBy:e.szModifiedBy}},h=function(){return new Promise((function(e,t){var n=l.o.getSheetPrintTotalPages(s.AJA.BR_PRINT_150,0,s._AE.ePXMAS_XLS_PRINT_ACTIVE_SHEET|s._AE.ePXMAS_XLS_PRINT_FIT_NOSCALE),o=[],r=setTimeout((function(){o.length!==n&&t(new Error("\n                        The file is too large to print."))}),1e4);c.Z.setListener("onExportAsImage",(function(t,i){i&&(o[t-1]=i),o.length===n&&(e({blobs:o}),c.Z.removeListener("onExportAsImage"),clearTimeout(r))})),l.o.setPrint(s.e_4.BR_PRINT_PAGESIZE_A4,1,n,s.nXZ.PRINT_JPG_IMG,s.AJA.BR_PRINT_150)}))}},202265:function(e,t,n){var o=n(974165),r=n(115861),i=n(215671),a=n(143144),u=n(416031),c=n(977917),s=n(981142),l=n(735622),f=n(625477),d=n(260861),m=n(494638),h=n(361688),v=n(53110),g=n(995124),p=n(588567),T=n(740918).Buffer,_=function(){function e(){(0,i.Z)(this,e),this.filterIconPosition=void 0,this.currentFilterMenu=void 0,this.filterIcons=["sheet_btn_filter_more_normal.png","sheet_btn_filter_more_pressed.png","sheet_btn_filter_sort_normal.png","sheet_btn_filter_sort_pressed.png","sheet_btn_filter_sortup_normal.png","sheet_btn_filter_sortup_pressed.png","sheet_btn_filter_sortdown_normal.png","sheet_btn_filter_sortdown_pressed.png","sheet_btn_sortup_normal.png","sheet_btn_sortup_pressed.png","sheet_btn_sortdown_normal.png","sheet_btn_sortdown_pressed.png"],this.filterIconPosition=null,this.currentFilterMenu={handleId:0,focusIndex:0,titleArray:[],fixedItemArray:[],checkedArray:[],secondMainType:0,firstFilterType:0,secondFilterType:0}}return(0,a.Z)(e,[{key:"initFilterIcon",value:function(){var e=(0,r.Z)((0,o.Z)().mark((function e(){var t,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(this.filterIcons.map((function(e){return n(624099)("./".concat(e))})));case 3:t=e.sent,r=t.map((function(e){return T.from(e.default.replace(/.*base64,/,""),"base64")})),s.o.setAutofilterButtonConfigurationEx(r,this.filterIcons),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),c.ZP.error("Filter icon load Error","[".concat(e.t0.message,"]"));case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentFilterMenu",value:function(){return this.currentFilterMenu}},{key:"sheetAutoFilter",value:function(){if(!s.o.isRunningAutoFilter()){var e="",t=s.o.getSortRange(!1).result;if(t===p.nCv.kPoErrInternal?e="IDS_DLG_EDIT_ERROR_SORT_RANGE":t===p.nCv.kPoErrSheetUnusedCommandAsCellMultiselection&&(e="IDS_MSG_SHEET_MULTISELECTION_CUT_ERROR"),""!==e)return void this.showAlert(e)}s.o.sheetFilter()}},{key:"sheetClearFilter",value:function(){var e=s.o.getCurrentSheetIndex();1===s.o.sheetIsEnableClearAdvancedFilter(e)?(s.o.sheetSetClearAdvancedFilter(e),s.o.reDraw()):this.setFilterClearReapply(["clear"])}},{key:"setFilterClearReapply",value:function(e){s.o.sheetFilterCommand(this.getCurrentFilterMenu().handleId,-1,1,e,1)}},{key:"setSheetFilterCommand",value:function(e,t,n){var o=this.currentFilterMenu,r=o.handleId,i=o.focusIndex;s.o.getAutoFilterFilteringAble(i)?s.o.sheetFilterCommand(r,i,e,t,n):this.showAlert("IDS_MSG_SHEET_FIND_REPLACE_SHEET_PROTECT")}},{key:"setSheetAutoFilterButtonRelease",value:function(){s.o.setSheetAutoFilterButtonRelease(),s.o.reDraw()}},{key:"onSheetAutoFilterMenu",value:function(e){var t=e.nHandleId,n=e.nFocusIndex,o=e.titleArray,r=e.isFixedItemArray,i=e.isCheckedArray,a=(e.nItemCount,e.nLeft),u=e.nTop,c=e.nRight,s=e.nBottom,l=e.nSecondMainType,m=e.nFirstFilterType,v=e.nSecondFilterType;this.currentFilterMenu={handleId:t,focusIndex:n,titleArray:o,fixedItemArray:r,checkedArray:i,secondMainType:l,firstFilterType:m,secondFilterType:v};var g=(0,f.qm)(h.CI);this.filterIconPosition={top:u/g,left:a/g,right:c/g,bottom:s/g},(0,f.Ce)((0,d.kp)())}},{key:"isShowAutoFilter",value:function(){var e=(0,f.qm)(d.vd),t=e.isShow,n=e.menuList;return t&&(0,u.some)(n,["id","auto_filter"])}},{key:"existSheetAutoFilterBtn",value:function(e,t){var n=s.o.getVisibleFilterButtonCount();if(n<=0)return!1;for(var o=s.o.getVisibleFilterButtonRange(n),r=0;r<n;r+=1)if(e>=o[r].left&&e<=o[r].right&&t>=o[r].top&&t<=o[r].bottom)return!0;return!1}},{key:"showAutoFilterDropdown",value:function(){var e=this.isShowAutoFilter();if(this.filterIconPosition&&!e){var t=v.UL.calculateAppBounding((0,f.qm)(h.LG)),n=t.top,o=260,r=m.M.getDropdownConfig("auto_filter");r&&r.dropdownWidth.length>0&&(o=Number.parseInt(r.dropdownWidth));var i=this.filterIconPosition.right-o-2;i<0&&(i=0);var a=n+this.filterIconPosition.bottom;return a>n+t.height/2&&(a=this.filterIconPosition.top-n-10),(0,f.Ce)((0,d.SP)({id:"auto_filter",commandName:"DummyCommand",top:a,left:i,depth:0})),this.filterIconPosition=null,!0}return!1}},{key:"showAlert",value:function(e){l.Z.showDialog({dialogId:g.O.COMMON_ALERT,bModal:!0,alertMsg:{label:e}})}}]),e}(),S=new _;t.Z=S},423333:function(e,t,n){n.d(t,{Y0:function(){return d},lU:function(){return f}});var o=n(426373),r=n(135323),i=n(625477),a=n(981142),u=n(101922),c=n(311501),s=n(371266),l=(0,o.oM)({name:"showheaderfooter",initialState:{isChecked:!0,isDisabled:!1},reducers:{},extraReducers:function(e){e.addCase(u.He,(function(e){e.isChecked=a.o.isSheetShowHeader(),e.isDisabled=c.Z.isDisable(s.QRM)}))}}),f=(0,r.P1)((function(e){return e.command.view.showHeaderFooterSlice}),(function(e){return e}));t.ZP=l.reducer;var d=function(e){return(0,i.RU)("setShowHeaderFooterThunk",(function(){a.o.sheetShowHeader(e)}))}},6087:function(e,t,n){n.d(t,{P7:function(){return v},Tw:function(){return T},Wg:function(){return p},iv:function(){return S},rW:function(){return _},rb:function(){return g}});var o=n(601413),r=n(426373),i=n(135323),a=n(625477),u=n(305054),c=n(588567),s=n(981142),l={fieldText:"",fieldSelection:{start:0,end:0}},f=(0,o.Z)((0,o.Z)({},l),{},{isFieldDisabled:!1,isCellEditing:!1,isExtended:!1}),d=(0,r.oM)({name:"formulaBar",initialState:f,reducers:{setFormulaFieldText:function(e,t){e.fieldText=t.payload},setFormulaFieldSelection:function(e,t){e.fieldSelection=t.payload},setIsCellEditing:function(e,t){e.isCellEditing=t.payload},setIsExtended:function(e,t){e.isExtended=t.payload},initFormulaField:function(e,t){var n=t.payload,o=n.fieldText,r=n.fieldSelection;e.fieldText=o,e.fieldSelection=r}},extraReducers:function(e){e.addCase(u.j,(function(e){if(e.isCellEditing)e.isFieldDisabled=!1;else if(0!==s.o.getInfraPenType())e.isFieldDisabled=!0;else switch(u.Z.getObjectType()){case c.lkc.BR_OBJECT_CELL:case c.lkc.BR_OBJECT_HEADER_COLUMN:case c.lkc.BR_OBJECT_HEADER_ROW:e.isFieldDisabled=!1;break;default:e.isFieldDisabled=!0}}))}}),m=d.actions.initFormulaField,h=d.actions,v=h.setFormulaFieldText,g=h.setFormulaFieldSelection,p=h.setIsCellEditing,T=h.setIsExtended;t.ZP=d.reducer;var _=(0,i.P1)((function(e){return e.formulaBar}),(function(e){return e})),S=function(){return(0,a.RU)("initFormulaBarThunk",(function(e){e(m(l))}))}},519370:function(e,t,n){n.d(t,{$I:function(){return S},Ac:function(){return P},BV:function(){return I},EY:function(){return b},Hf:function(){return p},Lw:function(){return v},Lz:function(){return k},TN:function(){return L},Zh:function(){return R},hN:function(){return A},ho:function(){return w},kl:function(){return E},oc:function(){return T},qY:function(){return C},rs:function(){return _},te:function(){return D},u9:function(){return y},wX:function(){return g}});var o=n(426373),r=n(135323),i=n(416031),a=n(625477),u=n(981142),c=n(588567),s=n(735622),l=n(995124),f={left:0,right:0},d={current:0,tabList:[],scrollBarLeftRight:f,tabBarLeftRight:f,tabBarPositionLeft:0,isSheeTabRenaming:!1,isSheeTabDrag:!1},m=(0,o.oM)({name:"sheetTabBar",initialState:d,reducers:{setCurrentTab:function(e,t){e.current=t.payload},setTabList:function(e,t){e.tabList=t.payload},setScrollBarLeftRight:function(e,t){e.scrollBarLeftRight=t.payload},setTabBarLeftRight:function(e,t){e.tabBarLeftRight=t.payload},setTabBarPositionLeft:function(e,t){e.tabBarPositionLeft=t.payload},setIsSheeTabRenaming:function(e,t){e.isSheeTabRenaming=t.payload},setIsSheeTabDrag:function(e,t){var n=t.payload;e.isSheeTabDrag=n,!n&&(e.sheetTabDropTarget=void 0)},setSheetTabDropTarget:function(e,t){e.sheetTabDropTarget=t.payload}}}),h=m.actions,v=h.setCurrentTab,g=h.setTabList,p=h.setScrollBarLeftRight,T=h.setTabBarLeftRight,_=h.setTabBarPositionLeft,S=h.setIsSheeTabRenaming,b=h.setIsSheeTabDrag,R=h.setSheetTabDropTarget;t.ZP=m.reducer;var y=(0,r.P1)((function(e){return e.sheetTabBar}),(function(e){return e})),C=function(){return(0,a.RU)("updateSheetTabThunk",(function(e){var t=u.o.getSheetNameList(c.dZ$.BR_SHEET_SHOW,!1),n=u.o.getCurrentSheetIndex();e(g(t)),e(v(n))}))},E=function(){return(0,a.RU)("addSheetTabThunk",(function(e,t){var n=t().sheetTabBar.current+1;u.o.sheetEdit(c.ZcN.BR_SHEET_INSERT,null,n,0,0,null,0,!1)&&e(C())}))},I=function(){return(0,a.RU)("removeSheetTabThunk",(function(e,t){var n=t().sheetTabBar.current;u.o.sheetEdit(c.ZcN.BR_SHEET_DELETE,null,n,0,0,null,0,!1)&&e(C())}))},k=function(){return(0,a.RU)("sheetTabDropThunk",(function(e,t){var n=t().sheetTabBar,o=n.current,r=n.sheetTabDropTarget;(0,i.isNil)(r)||o===r||e(P(r>o?r+1:r))}))},P=function(e){return(0,a.RU)("moveSheetTabThunk",(function(t,n){var o=n().sheetTabBar.current;u.o.sheetEdit(c.ZcN.BR_SHEET_MOVE,null,o,1,e,null,0,!1)&&t(C())}))},w=function(e){return(0,a.RU)("moveSheetTabThunk",(function(t,n){var o=n().sheetTabBar.current;u.o.sheetEdit(c.ZcN.BR_SHEET_INSERT,null,o,1,e,null,0,!0)&&t(C())}))},D=function(e,t){return(0,a.RU)("renameSheetTabThunk",(function(n,o){o().sheetTabBar.tabList.includes(t)||u.o.getSheetNameList(c.dZ$.BR_SHEET_HIDE,!1).includes(t)?s.Z.showDialog({dialogId:l.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_SHEET_TAB_RENAME_EQUALS"},currentTabIndex:0},(function(){n(v(e)),n(S(!0))})):u.o.sheetEdit(c.ZcN.BR_SHEET_RENAME,t,e,0,0,null,0,!1)&&n(C())}))},A=function(){return(0,a.RU)("hideSheetTabThunk",(function(e,t){var n=t(),o=[],r=n.sheetTabBar.tabList[n.sheetTabBar.current],i=u.o.sheetGetPosition(r);o.push(i),u.o.sheetHideShow(0,i,o,1),e(C())}))},L=function(e){return(0,a.RU)("unHideSheetTabThunk",(function(t){var n=u.o.sheetGetPosition(e);u.o.sheetHideShow(c.dZ$.BR_SHEET_SHOW,n,[n],1),t(C())}))}}}]);