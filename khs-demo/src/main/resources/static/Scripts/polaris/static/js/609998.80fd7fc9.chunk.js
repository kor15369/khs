"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[609998],{827611:function(e,n,a){a.d(n,{Z:function(){return l}});a(747313);var t=a(837490),i=a(307360),s=a(346417);function l(e){var n=e.buttonLabels,a=e.onClick,l=e.buttonDisableStates;return(0,s.jsx)("div",{className:t.Z.popup_btn_wrap,children:n.map((function(e,n){var o=!!l&&l[n];return(0,s.jsx)("button",{className:"".concat(t.Z.p_btn," ").concat(t.Z.normal),onClick:function(){return a(n)},disabled:o,children:(0,s.jsx)(i.Z,{label:e})},n)}))})}},772217:function(e,n,a){a.d(n,{P:function(){return u}});var t=a(870885),i=a(416031),s=a(747313),l=a(837490),o=a(53110),c=a(346417),r=function(e,n,a,t){var s=isNaN(parseFloat(e))?0:parseFloat(e),l=e.replace(/[^0-9|.|-]/g,"").trim(),o="";return a||0!==s?(o=l,t&&s<0&&(o=Math.abs(parseFloat(o)).toString()),o+=(0,i.isEmpty)(n)?"":" ".concat(n)):o="",o},u=(0,s.forwardRef)((function(e,n){var a=e.min,i=e.max,u=e.changeUnit,d=e.isDisable,p=e.suffix,f=void 0===p?"":p,h=e.isDisplayZero,b=void 0===h||h,v=e.isDisplayAbs,_=void 0!==v&&v,x=e.isFontSpacingEvnet,m=void 0!==x&&x,g=(0,s.useRef)(null),C=(0,s.useState)(0),D=(0,t.Z)(C,2),N=D[0],Z=D[1],j=(0,s.useState)(!1),P=(0,t.Z)(j,2),O=P[0],T=P[1];(0,s.useEffect)((function(){var a=n&&n.current,t=g.current;if(a&&t){if(e.inputWidth){var i=window.getComputedStyle(a),s=window.getComputedStyle(t),l=parseInt(i.paddingLeft),o=parseInt(i.paddingRight),c=parseInt(s.borderLeft)||0,u=parseInt(s.borderRight)||0;Z(e.inputWidth-l-o-c-u)}"".concat(e.value," ").concat(f)===a.value||0===e.value&&a.value.trim()===f||(a.value=r("".concat(e.value),f,b,_),m&&T(e.value<0))}}),[_,b,e.inputWidth,e.value,n,f,m]);var S=(0,s.useCallback)((function(e){var t=n.current;if(!t)return 0;var s=(0,o.il)(u),l=Math.min(i,Math.max(a,isNaN(parseFloat(t.value))?0:parseFloat(t.value))),c=Math.floor(parseFloat((l/u).toFixed(1))),r=o.fb.round(c*u,s);return r=(0,o.wI)(l,a,i)?O?e?r-u:r+u:e?r+u:r-u:e?u+u:u,s>0?o.fb.round(r,s):r}),[u,i,a,n,O]),I=(0,s.useCallback)((function(a){var t=n.current;if(t){var i=t.selectionStart||0,s=t.value.charAt(i-1),l=isNaN(parseFloat(t.value))?0:parseFloat(t.value);e.onChange&&e.onChange(l),t.value=r(t.value,f,b,_);var o=s.length>0&&!1===["."].includes(s)&&isNaN(parseInt(s))?i-1:i;t.selectionStart=o,t.selectionEnd=o}}),[_,b,e,n,f]),k=(0,s.useCallback)((function(e){var a=n.current;if(a&&!(f.length<1)){var t=a.selectionStart||0,i=a.value.length,s=f.length+1;"Backspace"===e.key?t>i-s&&e.preventDefault():"Delete"===e.key?t+1>i-s&&e.preventDefault():/[0-9]/.test(e.key)&&i>=s&&t>i-s&&e.preventDefault()}}),[n,f.length]),w=(0,s.useCallback)((function(){var t=n.current;if(t){var s=S(!0);(0,o.wI)(s,a,i)&&(e.onChange&&e.onChange(s,!0),t.value=r("".concat(s),f,b,_))}}),[S,_,b,i,a,e,n,f]),M=(0,s.useCallback)((function(){var t=n.current;if(t){var s=S(!1);(0,o.wI)(s,a,i)&&(e.onChange&&e.onChange(s,!1),t.value=r("".concat(s),f,b,_))}}),[S,_,b,i,a,e,n,f]),E="".concat(l.Z.spinner_select," ").concat(l.Z.medium," ").concat(l.Z.horizontal," ").concat(d?"".concat(l.Z.disabled):""),G={width:N?"".concat(N,"px"):""};return(0,c.jsx)("div",{className:E,children:(0,c.jsxs)("div",{className:l.Z.i_txt,ref:g,children:[(0,c.jsx)("input",{type:"text",ref:n,style:G,onChange:I,onKeyDown:k}),(0,c.jsx)("button",{className:"".concat(l.Z.toggle," ").concat(l.Z.up),onClick:w,children:(0,c.jsx)("span",{children:"toggle up"})}),(0,c.jsx)("button",{className:"".concat(l.Z.toggle," ").concat(l.Z.down),onClick:M,children:(0,c.jsx)("span",{children:"toggle down"})})]})})}))},609998:function(e,n,a){a.r(n),a.d(n,{default:function(){return D}});var t=a(601413),i=a(870885),s=a(747313),l=a(837490),o=a(448439),c=a(827611),r=a(307360),u=a(735622),d=a(53110),p=a(995124),f=a(772217),h=a(981142),b=a(588567),v=a(346417),_=0,x=1e3,m=-1e3,g=1e3,C=[{position:b.DML.HWP_CAPTION_POS_LEFT_TOP,isSizeDisabled:!1,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_TOP,isSizeDisabled:!0,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_RIGHT_TOP,isSizeDisabled:!1,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_LEFT_CENTER,isSizeDisabled:!1,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_CENTER,isSizeDisabled:!0,isGapDisabled:!0},{position:b.DML.HWP_CAPTION_POS_RIGHT_CETNER,isSizeDisabled:!1,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_LEFT_BOTTOM,isSizeDisabled:!1,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_BOTTOM,isSizeDisabled:!0,isGapDisabled:!1},{position:b.DML.HWP_CAPTION_POS_RIGHT_BOTTOM,isSizeDisabled:!1,isGapDisabled:!1}];function D(e){var n,a,b=e.dialogId,D=e.tabs,N=e.commandName,Z=D[0].buttons,j=o.Z.getCommandInstance(N),P=(0,s.useState)(4),O=(0,i.Z)(P,2),T=O[0],S=O[1],I=(0,s.useState)(30),k=(0,i.Z)(I,2),w=k[0],M=k[1],E=(0,s.useState)(3),G=(0,i.Z)(E,2),L=G[0],A=G[1],R=(0,s.createRef)(),y=(0,s.createRef)(),F=(0,s.useCallback)((function(e,n,a,t){return!!(0,d.wI)(e,n,a)||(u.Z.showDialog({dialogId:p.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OUT_OF_RANGE",values:{arg1:"".concat(n),arg2:"".concat(a)}},currentTabIndex:0},t),!1)}),[]),W=(0,s.useCallback)((function(){return!!F(w,_,x,(function(){setTimeout((function(){var e;null===(e=R.current)||void 0===e||e.select()}),100)}))&&!!F(L,m,g,(function(){setTimeout((function(){var e;null===(e=y.current)||void 0===e||e.select()}),100)}))}),[L,y,w,R,F]),H=(0,s.useCallback)((function(){W()&&(j.invoke({captionPosition:C[T].position,captionSize:w,captionGap:L}),u.Z.hideDialog(b))}),[L,T,w,W,j,b]),z=(0,s.useCallback)((function(e){Z.length-1===e?(u.Z.clickButton(b,e),u.Z.hideDialog(b)):H()}),[H,Z.length,b]),B={buttonLabels:Z,onClick:z};(0,s.useEffect)((function(){var e=h.o.getHWPCaptionOption(),n=e.result,a=e.pos,t=e.width,i=e.gap;n?(S(C.findIndex((function(e){return e.position===a}))),M(t),A(i)):(M(30),A(3))}),[]);var U=(0,s.useCallback)((function(e){e!==T&&S(e)}),[T]),J=(0,s.useMemo)((function(){return{value:w,min:_,max:x,changeUnit:1,onChange:function(e){M(e)},inputWidth:160,suffix:"mm"}}),[w]),K=(0,s.useMemo)((function(){return{value:L,min:m,max:g,changeUnit:1,onChange:function(e){A(e)},inputWidth:160,suffix:"mm"}}),[L]);return(0,v.jsxs)(s.Fragment,{children:[(0,v.jsxs)("div",{className:l.Z.popup_contents,children:[(0,v.jsxs)("table",{className:"".concat(l.Z.form_table),children:[(0,v.jsxs)("colgroup",{children:[(0,v.jsx)("col",{style:{width:"74px"}}),(0,v.jsx)("col",{style:{width:"auto"}})]}),(0,v.jsx)("tbody",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{className:l.Z.vt,children:(0,v.jsx)(r.Z,{label:"DLG_CAPTION_INSERT_CAPTION"})}),(0,v.jsx)("td",{children:(0,v.jsx)("div",{className:l.Z.captions_box,children:C.map((function(e,n){return(0,v.jsxs)("button",{className:"".concat(n===T?l.Z.active:""),onClick:function(){U(n)},children:[(0,v.jsx)("span",{className:l.Z.num,children:"1"}),(0,v.jsx)("span",{className:l.Z.box})]},e.position)}))})})]})})]}),(0,v.jsxs)("table",{className:"".concat(l.Z.form_table),children:[(0,v.jsxs)("colgroup",{children:[(0,v.jsx)("col",{style:{width:"120px"}}),(0,v.jsx)("col",{style:{width:"auto"}})]}),(0,v.jsxs)("tbody",{children:[(0,v.jsxs)("tr",{className:"".concat(null!==(n=C[T])&&void 0!==n&&n.isSizeDisabled?l.Z.disabled:""),children:[(0,v.jsx)("th",{children:(0,v.jsx)(r.Z,{label:"DLG_CAPTION_SIZE"})}),(0,v.jsx)("td",{children:(0,v.jsx)(f.P,(0,t.Z)({ref:R},J))})]}),(0,v.jsxs)("tr",{className:"".concat(null!==(a=C[T])&&void 0!==a&&a.isGapDisabled?l.Z.disabled:""),children:[(0,v.jsx)("th",{children:(0,v.jsx)(r.Z,{label:"DLG_CAPTION_OBJECT_AND_THE_GAP"})}),(0,v.jsx)("td",{children:(0,v.jsx)(f.P,(0,t.Z)({ref:y},K))})]})]})]})]}),(0,v.jsx)(c.Z,(0,t.Z)({},B))]})}}}]);