"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[498134,846775],{846775:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var o=t(215671),i=t(143144),r=t(957112),a=t(815e3),u=t(237683),c=t(977917),s=t(625477),d=t(361688),l=t(459551),f=t(159366),h=t(981142),m=t(588567),p=t(780386),g=t(735622),v=t(995124),y=t(652928),P=t(53110),Z=t(628264),D=function(){function e(){(0,o.Z)(this,e)}return(0,i.Z)(e,[{key:"openDocument",value:function(e){var n="The document could not be opened.";return e?e.name?(0,f.mD)(e.name)?e.blob?w(e.name,e.blob).catch((function(e){return c.ZP.api.rejectOpenDocument("".concat(n," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):c.ZP.api.reject(n,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):c.ZP.api.reject(n,"[Please include an extension in the name.]"):c.ZP.api.reject(n,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):c.ZP.api.reject(n,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return b()}},{key:"movePage",value:function(e){C(e)}},{key:"isReadOnlyDocument",value:function(){return R()}},{key:"getDocumentExtension",value:function(){return _()}}]),e}(),w=function(e,n){return new Promise((function(t,o){var i,r=(0,f.mD)(e);if(O(r)){u.Z.setListener("onOpenComplete",(function(){(0,s.Ce)((0,l.RY)(e)),(0,s.Ce)((0,l.Js)(r)),t(),i=null,u.Z.removeListener("onOpenComplete")})),u.Z.setListener("onLoadFail",(function(n){(0,s.Ce)((0,l.RY)(e)),(0,s.Ce)((0,l.Js)(r)),o({message:"Loading failed '".concat(e,"'."),errorCode:n,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))}),i=null,u.Z.removeListener("onLoadFail")})),u.Z.setListener("onLoadForce",(function(){null!==i&&a(i,!0),i=null,u.Z.removeListener("onLoadForce")}));var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===r?p.Z.setOpenMode(m.ekp.ePRM_READ_ONLY_RECOMMENDED_READONLY):p.Z.setOpenMode(m.ekp.ePRM_COMMON),p.Z.setDocData(n,r);var o=(0,s.qm)(d.LG),i=(0,s.qm)(d.CI);(0,P.Vq)()?h.o.memoryOpenForViewerSDK(".".concat(r),e,e.byteLength,o.width*i,o.height*i):h.o.memoryOpen(".".concat(r),e,e.byteLength,o.width*i,o.height*i,t),(0,s.Ce)((0,Z._j)(!1))},c=new FileReader;c.onload=function(){c.readyState===FileReader.DONE&&c.result instanceof ArrayBuffer&&(i=c.result,a(c.result))};var y=function(e){o({message:e,errorCode:-1,closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})};c.onabort=function(){y("Reading the file is aborted. '".concat(c.error,"'."))},c.onerror=function(){y("Failed to read file. '".concat(c.error,"'."))},c.readAsArrayBuffer(n)}else g.Z.showDialog({dialogId:v.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(r,")")}},currentTabIndex:0},(function(){o({message:"This document format is not supported. '(.".concat(r,")'"),closeDialog:new Promise((function(e){u.Z.setListener("onCancelOpenDocument",(function(){e(),u.Z.removeListener("onCancelOpenDocument")}))}))})}))}))},b=function(){return{version:a.i8,formats:a.bd,licenseKey:r.C}},O=function(e){var n=(0,s.qm)(l.hz).docType,t=e.toLowerCase();if(n===y.n_.hwp){if(["hwp","hwpx"].includes(t))return!0}else if(n===y.n_.word){if(["doc","docx"].includes(t))return!0}else if(n===y.n_.sheet){if(["xls","xlsx","csv"].includes(t))return!0}else if(n===y.n_.slide&&["ppt","pptx"].includes(t))return!0;return!1},C=function(e){var n=e,t=h.o.getConfig().nTotalPages;n<1&&(n=1),n>t&&(n=t),h.o.movePage(m.ZbX.eEV_MOVE_SETPAGE,n)},R=function(){return p.Z.isProtectDoc()||p.Z.isReadOnlyDoc()},_=function(){return(0,s.qm)(l.hz).extension}},498134:function(e,n,t){t.r(n),t.d(n,{default:function(){return g}});var o=t(215671),i=t(143144),r=t(611752),a=t(661120),u=t(179340),c=t(432269),s=t(237683),d=t(846775),l=t(981142),f=t(588567),h=t(977917),m=t(173470),p=t(625477),g=function(e){(0,u.Z)(t,e);var n=(0,c.Z)(t);function t(){return(0,o.Z)(this,t),n.apply(this,arguments)}return(0,i.Z)(t,[{key:"getDocumentInformation",value:function(){return v()}},{key:"exportAsImage",value:function(){return y().catch((function(e){return h.ZP.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}},{key:"openDocument",value:function(e){return(0,p.Ce)((0,m.Wm)()),(0,r.Z)((0,a.Z)(t.prototype),"openDocument",this).call(this,e)}}]),t}(d.default),v=function(){var e=l.o.getSummaryData();return{title:e.szTitle,author:e.szAuthor,modifiedBy:e.szModifiedBy}},y=function(){return new Promise((function(e,n){var t=l.o.getConfig().nTotalPages,o=[],i=setTimeout((function(){o.length!==t&&n(new Error("\n                        The file is too large to print."))}),1e4);s.Z.setListener("onExportAsImage",(function(n,r){r&&(o[n-1]=r),o.length===t&&(e({blobs:o}),s.Z.removeListener("onExportAsImage"),clearTimeout(i))})),l.o.setPrint(f.e_4.BR_PRINT_PAGESIZE_A4,1,t,f.nXZ.PRINT_JPG_IMG,f.AJA.BR_PRINT_150)}))}},173470:function(e,n,t){t.d(n,{So:function(){return P},Wm:function(){return g},Z7:function(){return Z},ZS:function(){return o},i0:function(){return y},wP:function(){return p}});var o,i=t(426373),r=t(135323),a=t(625477),u=t(981142),c=t(53110),s=t(305054),d=t(530624);!function(e){e.EmbedVideo="embed_video",e.OnlineVideo="online_video"}(o||(o={}));var l={x:0,y:0,width:0,height:0,isShowing:!1,autoPlay:!1,videoPath:"",videoType:void 0},f=(0,i.oM)({name:"videoPlayer",initialState:l,reducers:{setVideoData:function(e,n){var t=n.payload,o=t.x,i=t.y,r=t.width,a=t.height,u=t.videoPath,c=t.videoType;e.x=o,e.y=i,e.width=r,e.height=a,e.videoPath=u,e.videoType=c,e.isShowing=!1},showVideoPlayer:function(e,n){e.isShowing=!0,e.autoPlay=n.payload},hideVideoPlayer:function(){return l},setVideoSize:function(e,n){var t=n.payload,o=t.x,i=t.y,r=t.width,a=t.height;e.x=o,e.y=i,e.width=r,e.height=a}},extraReducers:function(e){e.addCase(s.j,(function(e){if(d.uq.eObjCtrVideo!==s.Z.getObjectControlType())return l}))}}),h=f.actions,m=h.setVideoData,p=h.showVideoPlayer,g=h.hideVideoPlayer,v=h.setVideoSize;n.ZP=f.reducer;var y=(0,r.P1)((function(e){return e.videoPlayer}),(function(e){return e})),P=function(){return(0,a.RU)("loadVideoDataThunk",(function(e,n){var t=n(),i=u.o.getVideoPath(),r=u.o.getVideoRect(),a=t.section.devicePixelRatio,s=r.left/a,d=r.top/a,l=(r.right-r.left)/a,f=(r.bottom-r.top)/a,h=(0,c.jv)(i);e(m({x:s,y:d,width:l,height:f,videoPath:i,videoType:h?o.OnlineVideo:o.EmbedVideo}))}))},Z=function(){return(0,a.RU)("updateVideoSizeThunk",(function(e,n){var t=n(),o=u.o.getVideoRect(),i=t.section.devicePixelRatio,r=o.left/i,a=o.top/i,c=(o.right-o.left)/i,s=(o.bottom-o.top)/i;e(v({x:r,y:a,width:c,height:s}))}))}}}]);