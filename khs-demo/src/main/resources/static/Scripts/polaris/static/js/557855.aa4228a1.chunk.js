"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[557855],{557855:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var a=n(870885),i=n(747313),o=n(837490),r=n(981142),c=n(407604),u=n(180252),s=n(735622),l=n(583686),d=n(820371),g=n(815e3),m=n(346417);function f(e){var t=(0,u.I0)(),n=e.parentMemoId,c=e.memoItem,s=c.memoId,d=c.author,g=c.date,f=(0,i.useState)(c.memo),h=(0,a.Z)(f,2),_=h[0],I=h[1],E=(0,i.useCallback)((function(){r.o.memoDelete(s),setTimeout((function(){t((0,l.W3)(n))}),100)}),[t,s,n]),P=(0,i.useCallback)((function(e){I(e.target.value)}),[]),T=(0,i.useCallback)((function(e){r.o.memoSetString(s,e.currentTarget.value)}),[s]);return c?(0,m.jsxs)("table",{className:"".concat(o.Z.form_table," ").concat(o.Z.mt5),children:[(0,m.jsxs)("colgroup",{children:[(0,m.jsx)("col",{style:{width:"190px"}}),(0,m.jsx)("col",{style:{width:"auto"}})]}),(0,m.jsxs)("tbody",{className:o.Z.rep,children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:d}),(0,m.jsx)("td",{children:(0,m.jsx)("div",{className:"".concat(o.Z.flex_box," ").concat(o.Z.right),children:(0,m.jsx)("button",{className:"".concat(o.Z.small_btn," ").concat(o.Z.delete),onClick:E,children:"delete"})})})]}),(0,m.jsx)("tr",{children:(0,m.jsx)("td",{className:"".concat(o.Z.sub_txt),colSpan:2,children:g})}),(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:2,children:(0,m.jsx)("textarea",{className:o.Z.f_textarea,style:{height:"70px"},value:_,onChange:P,onBlur:T})})})]})]}):null}function h(e){var t=(0,u.I0)(),n=e.dialogIndex,h=e.dialogId,_=(0,u.v9)((0,c.R1)(n)).data,I=(0,u.v9)(d.$T).currentPage,E=(0,u.v9)(l.Fj),P=E.memoItem,T=E.childMemoItems,p=(0,i.useState)(""),N=(0,a.Z)(p,2),v=N[0],R=N[1],b=_;(0,i.useEffect)((function(){return t((0,l.W3)(b)),function(){t((0,l.A5)())}}),[t,b]),(0,i.useEffect)((function(){R(P.memo)}),[t,P]);var C=(0,i.useCallback)((function(){var e=g.ZP.get("author")||"";r.o.memoAddReply(e,b,I),t((0,l.W3)(b))}),[I,t,b]),D=(0,i.useCallback)((function(){r.o.memoDelete(b),s.Z.hideDialog(h)}),[h,b]),x=(0,i.useCallback)((function(e){R(e.target.value)}),[]),M=(0,i.useCallback)((function(e){r.o.memoSetString(b,e.currentTarget.value)}),[b]);return(0,m.jsx)(i.Fragment,{children:(0,m.jsxs)("div",{className:o.Z.popup_contents,style:{maxHeight:"430px",overflowY:"auto"},children:[(0,m.jsxs)("table",{className:"".concat(o.Z.form_table," ").concat(o.Z.mt5),children:[(0,m.jsxs)("colgroup",{children:[(0,m.jsx)("col",{style:{width:"190px"}}),(0,m.jsx)("col",{style:{width:"auto"}})]}),(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:P.author}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"".concat(o.Z.flex_box," ").concat(o.Z.right),children:[(0,m.jsx)("button",{className:"".concat(o.Z.small_btn," ").concat(o.Z.edit),onClick:C,children:"edit"}),(0,m.jsx)("button",{className:"".concat(o.Z.small_btn," ").concat(o.Z.delete),onClick:D,children:"delete"})]})})]}),(0,m.jsx)("tr",{children:(0,m.jsx)("td",{className:"".concat(o.Z.sub_txt),colSpan:2,children:P.date})}),(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:2,children:(0,m.jsx)("textarea",{className:o.Z.f_textarea,style:{height:"70px"},value:v,onChange:x,onBlur:M})})})]})]}),T&&T.map((function(e,t){return(0,m.jsx)(f,{parentMemoId:b,memoItem:e},t)}))]})})}},820371:function(e,t,n){n.d(t,{$T:function(){return p},Be:function(){return T},DM:function(){return N},FK:function(){return D},KT:function(){return R},ce:function(){return v},oK:function(){return b}});var a=n(601413),i=n(426373),o=n(135323),r=n(981142),c=n(625477),u=n(877703),s=n(628264),l=n(101922),d=n(53110),g=n(416031),m={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},f=(0,i.oM)({name:"page",initialState:m,reducers:{setPageSize:function(e,t){var n=t.payload,a=n.pageWidth,i=n.pageHeight;e.pageWidth=a,e.pageHeight=i,e.pageRatio=i>0?i/a:0},setPageNumber:function(e,t){var n=t.payload,a=n.currentPage,i=n.totalPage;d.tq?(e.currentPage===a&&e.totalPage===i||(e.isShowingPageInfo=!0),C()):e.isShowingPageInfo=!0,e.currentPage=a,e.totalPage=i,e.isFirstPage=1===a,e.isLastPage=a===i},setIsShowPresentationEndingConfirm:function(e,t){e.isShowPresentationEndingConfirm=t.payload},setIsShowingPageInfo:function(e,t){e.isShowingPageInfo=t.payload},setIsShowingPageNavigation:function(e,t){e.isShowingPageNavigation=t.payload}},extraReducers:function(e){e.addCase(l.qp,(function(e){e.isShowingPageInfo=!d.tq})),e.addCase(s.FZ,(function(e,t){if(!t.payload)return(0,a.Z)({},m)}))}}),h=f.actions,_=h.setPageSize,I=h.setPageNumber,E=h.setIsShowPresentationEndingConfirm,P=h.setIsShowingPageInfo,T=h.setIsShowingPageNavigation;t.ZP=f.reducer;var p=(0,o.P1)((function(e){return e.page}),(function(e){return e})),N=function(){return(0,c.RU)("updatePageSizeThunk",(function(e){var t=r.o.getPageInfo(1),n=t.nPageWidth,a=t.nPageHeight;e(_({pageWidth:n,pageHeight:a}))}))},v=function(){return(0,c.RU)("updatePageNumberThunk",(function(e){var t=r.o.getConfig(),n=t.nCurPage,a=t.nTotalPages;e(I({currentPage:n,totalPage:a}))}))},R=function(e,t){return(0,c.RU)("updatePageMoveThunk",(function(n,a){var i=a().page.currentPage;n(I({currentPage:e,totalPage:t})),n((0,u.Ml)([i,e]))}))},b=function(e){return(0,c.RU)("setIsShowPresentationEndingConfirmThunk",(function(t){t(E(e))}))},C=(0,g.debounce)((function(){(0,c.Ce)(P(!1))}),2e3),D=(0,g.debounce)((function(){(0,c.Ce)(T(!1))}),2e3)},583686:function(e,t,n){n.d(t,{A5:function(){return _},Fj:function(){return I},W3:function(){return T}});var a=n(242982),i=n(426373),o=n(135323),r=n(625477),c=n(981142),u=n(588567),s=n(820371),l=n(442113),d={memoItem:{memoId:0,memo:"",author:"",date:""},childMemoItems:[]},g=(0,i.oM)({name:"slideNewMemo",initialState:d,reducers:{setMemoItem:function(e,t){var n=t.payload;n&&(e.memoItem=n)},addChildMemoItem:function(e,t){var n=t.payload;n&&(e.childMemoItems=[].concat((0,a.Z)(e.childMemoItems),[n]))},removeChildMemoItem:function(e,t){var n=t.payload;n>0&&(e.childMemoItems=e.childMemoItems.filter((function(e){return e&&e.memoId===n})))},clearMemoItems:function(){return d}}}),m=g.actions,f=m.setMemoItem,h=m.addChildMemoItem,_=(m.removeChildMemoItem,m.clearMemoItems);t.ZP=g.reducer;var I=(0,o.P1)((function(e){return e.slideNewMemo}),(function(e){return e})),E=function(e){var t=l.localeIntl.formatMessage,n=6e4,a=60*n,i=60*a,o=new Date(e),r=new Date,c=r.getTime()-o.getTime(),u="";if(c<n)u="".concat(t({id:"DLG_MEMO_FEW_SECOND_BEFORE"}));else if(c<a){var s={arg1:Math.floor(c/n)};u="".concat(t({id:"DLG_MEMO_FEW_MINUTE_BEFORE"},s))}else if(c<i)if(o.getDay()!==r.getDay())u="".concat(t({id:"DLG_MEMO_DATE_YESTERDAY"}));else{var d={arg1:Math.floor(c/a)};u="".concat(t({id:"DLG_MEMO_FEW_HOUR_BEFORE"},d))}else u=c<1296e7?o.toLocaleString(window.navigator.language,{weekday:"long"}):o.toLocaleString(window.navigator.language,{year:"numeric",month:"numeric",day:"numeric"});return u},P=function(e){var t=(0,u.xPh)();t.memo_id=e,t.cmd_type=u.Ckc.BR_MEMOCMD_GETSTRING;var n=c.o.memoCmd(t);return{memoId:e,author:n&&n.szAuthor,date:n&&E(n.szDate),memo:n&&n.szMemo}},T=function(e){return(0,r.RU)("slideNewMemoGetDataThunk",(function(t){var n=(0,r.qm)(s.$T).currentPage,a=c.o.memoGetFirstId(),i=c.o.memoGetLastId(),o=a;for(t(_()),t(f(P(e)));o>-1;){if(e===c.o.memoGetParentId(o)){var u=P(o);t(e===o?f(u):h(u))}if(o===i)break;o=c.o.memoGetNext(o,n)}}))}},877703:function(e,t,n){n.d(t,{A7:function(){return M},Cq:function(){return v},Hq:function(){return P},Ml:function(){return x},Tb:function(){return b},Tz:function(){return T},XQ:function(){return p},ZB:function(){return R},Zm:function(){return w},aG:function(){return j},pL:function(){return S},yE:function(){return N},z_:function(){return O}});var a=n(601413),i=n(426373),o=n(135323),r=n(416031),c=n(625477),u=n(628264),s=n(981142),l=n(820371),d=n(588567),g=n(735622),m=n(995124),f=n(361688),h={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},_=(0,i.oM)({name:"slideThumbnail",initialState:h,reducers:{setThumbnailSize:function(e,t){var n=t.payload,a=n.width,i=n.height;e.width=a,e.height=i},setThumbnailItem:function(e,t){var n=t.payload,a=n.pageNumber,i=n.thumbnailItem;e.thumbnails[a]=i},unmountThumbnail:function(e,t){var n=t.payload;delete e.thumbnails[n]},clearThumbnails:function(e){},setIsResizing:function(e,t){e.isResizing=t.payload},setIsPageDrag:function(e,t){var n=t.payload;e.isPageDrag=n,!n&&(e.pageDropTarget=void 0)},setPageDropTarget:function(e,t){e.pageDropTarget=t.payload}},extraReducers:function(e){e.addCase(u.FZ,(function(e,t){if(!t.payload)return(0,a.Z)({},h)}))}}),I=_.actions.clearThumbnails,E=_.actions,P=E.setThumbnailSize,T=E.setThumbnailItem,p=E.unmountThumbnail,N=E.setIsResizing,v=E.setIsPageDrag,R=E.setPageDropTarget;t.ZP=_.reducer;var b=(0,o.P1)((function(e){return e.slideThumbnail}),(function(e){return e})),C=function(e,t,n,a){if(a||s.o.isPageModified(e)){var i=(0,c.qm)(f.CI),o=4*t*i,r=4*n*i;s.o.slideObjStartEx(o,r,e)}},D=function(e,t){return(0,c.RU)("requestSlideThumbnailFromToThunk",(function(n,a){var i=a(),o=i.slideThumbnail,r=o.width,c=o.height,u=i.page.totalPage;if(r&&c&&u>0&&e>=1&&t<=u)for(var s=e;s<=t;s+=1)C(s,r,c,!0)}))},x=function(e){return(0,c.RU)("requestSlideThumbnailListThunk",(function(t,n){var a=e.length;if(a>0){var i=n(),o=i.slideThumbnail,r=o.width,c=o.height,u=i.page.totalPage;if(r&&c)for(var s=0;s<a;s+=1){var l=e[s];l>=1&&l<=u&&C(l,r,c,!0)}}}))},M=function(e){return(0,c.RU)("requestSlideThumbnailAllThunk",(function(t,n){var a=n(),i=a.slideThumbnail,o=i.width,r=i.height,c=a.page.totalPage;if(e&&t(I()),o&&r&&c>0)for(var u=function(e){setTimeout((function(){C(e,o,r,!0)}))},s=1;s<=c;s+=1)u(s)}))},S=(0,r.debounce)((function(){var e=(0,c.qm)(l.$T).currentPage,t=(0,c.qm)(b),n=t.width,a=t.height;n&&a&&e>0&&C(e,n,a)}),500),O=function(e){var t=e.nAction,n=e.stListInfo,a=n.nPageCnt,i=n.pPageList;switch(t){case d.jar.eBR_UNREDO_ACTION_NONE:(0,c.Ce)((0,l.DM)()),(0,c.Ce)((0,l.ce)());break;case d.jar.eBR_UNREDO_ACTION_ADD:case d.jar.eBR_UNREDO_ACTION_DELETE:(0,c.Ce)((0,l.ce)());break;case d.jar.eBR_UNREDO_ACTION_MOVE:var o=a>0?i[0]:0,r=a>1?i[a-1]:o,u=Math.min(o,r),s=Math.max(o,r);(0,c.Ce)(D(u,s));break;case d.jar.eBR_UNREDO_ACTION_CHANGE:case d.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case d.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,c.Ce)(x(i));break;case d.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case d.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case d.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,c.Ce)(M());case d.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case d.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case d.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case d.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},j=function(){return(0,c.RU)("slidePageDropThunk",(function(e,t){var n=t(),i=n.page,o=n.slideThumbnail,c=i.currentPage,u=o.pageDropTarget;if(c>0&&!(0,r.isNil)(u)&&c!==u){var l=Math.min(u,c),g=Math.max(u,c);s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,d.zUw)()),{},{nType:d.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:u,nSectionIndex:0})),s.o.movePage(d.ZbX.eEV_MOVE_SETPAGE,u),e(D(l,g))}}))},w=function(){return(0,c.RU)("slidePageDeleteThunk",(function(e,t){var n=t().page,i=n.totalPage,o=n.currentPage;o>0&&(i>1?s.o.slideManageEx((0,a.Z)((0,a.Z)({},(0,d.zUw)()),{},{nType:d.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:o})):g.Z.showDialog({dialogId:m.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}}}]);