"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[754191],{12689:function(e,t,n){var i=n(215671),a=n(143144),o=n(305054),r=n(588567),u=n(981142),s=n(625477),c=n(89259),l=new(function(){function e(){(0,i.Z)(this,e),this._requestCount=0,this._responseCount=0,this._thumbnailDatas=[]}return(0,a.Z)(e,[{key:"requestAllThumbnail",value:function(){var e=(0,s.qm)(c.kr).layoutCountBySection;this._requestCount=0,this._responseCount=0,this._thumbnailDatas=[];for(var t=0;t<e.length;t+=1)for(var n=0;n<e[t];n+=1)o.Z.getDocExtType()===r.VrN.eDOCTYPE_PPTX?u.o.getLayoutPageInfo(t,n+2,320,188):u.o.getMasterPageInfo(n,320,188),this._requestCount+=1}},{key:"OnGetMasterPageInfo",value:function(e,t,n,i,a){var u={pageNumber:t,width:n,height:i,url:a},l=0,d=0;o.Z.getDocExtType()===r.VrN.eDOCTYPE_PPTX?(l=e,d=t-2):(l=0,d=e),this._responseCount+=1,void 0===this._thumbnailDatas[l]&&(this._thumbnailDatas[l]=[]),this._thumbnailDatas[l][d]=u,this._requestCount===this._responseCount&&(0,s.Ce)((0,c.p)({thumbnailDatas:this._thumbnailDatas}))}}]),e}());t.Z=l},46531:function(e,t,n){n.d(t,{FV:function(){return d},Gu:function(){return l}});var i=n(426373),a=n(135323),o=n(500811),r=n(101922),u=n(360008),s=n(371266),c=(0,i.oM)({name:"formCopy",initialState:{isChecked:!1,isDisabled:!1,isDisabledSubmenu:!1,currentIndex:3},reducers:{setFormCopyItem:function(e,t){e.currentIndex=t.payload}},extraReducers:function(e){e.addCase(r.He,(function(e){e.isDisabled=u.Z.isDisable(s.Gsz),e.isDisabledSubmenu=u.Z.isDisable(s.Gsz)})),e.addCase(o.$A,(function(e,t){e.isChecked=t.payload}))}}),l=(0,a.P1)((function(e){return e.command.clipboard.formCopy}),(function(e){return e})),d=c.actions.setFormCopyItem;t.ZP=c.reducer},89259:function(e,t,n){n.d(t,{Tg:function(){return S},kr:function(){return v},p:function(){return p},xF:function(){return C}});var i=n(426373),a=n(135323),o=n(625477),r=n(981142),u=n(12689),s=n(305054),c=n(588567),l=n(101922),d=n(360008),f=n(371266),h={isDisabled:!1,sectionCount:0,sectionNames:[],layoutCountBySection:[],layoutNames:[],thumbnailDatas:[]},g=(0,i.oM)({name:"setSlideLayout",initialState:h,reducers:{setSlideLayoutSectionData:function(e,t){var n=t.payload,i=n.sectionCount,a=n.sectionNames;e.sectionCount=i,e.sectionNames=a},setSlideLayoutData:function(e,t){var n=t.payload,i=n.layoutNames,a=n.layoutCountBySection;e.layoutCountBySection=a,e.layoutNames=i},setSlideLayoutThumbnails:function(e,t){var n=t.payload.thumbnailDatas;e.thumbnailDatas=n},clearLayoutDatas:function(){return h}},extraReducers:function(e){e.addCase(l.He,(function(e){e.isDisabled=d.Z.isDisable(f.voj)}))}}),P=g.actions,m=P.setSlideLayoutSectionData,T=P.setSlideLayoutData,p=P.setSlideLayoutThumbnails,S=P.clearLayoutDatas;t.ZP=g.reducer;var v=(0,a.P1)((function(e){return e.command.layout}),(function(e){return e.slideLayout})),C=function(){return(0,o.RU)("setSlideLayoutSectionThunk",(function(e){var t=[],n=0;if(s.Z.getDocExtType()===c.VrN.eDOCTYPE_PPTX){n=r.o.getPPTMasterCount();for(var i=0;i<n;i+=1){var a=r.o.getMasterLayoutName(i,0);t.push(a)}}else n=1,t.push("");e(m({sectionCount:n,sectionNames:t})),e(y())}))},y=function(){return(0,o.RU)("setSlideLayoutThunk",(function(e){var t=(0,o.qm)(v).sectionCount,n=[],i=[];if(s.Z.getDocExtType()===c.VrN.eDOCTYPE_PPTX)for(var a=0;a<t;a+=1){var u=r.o.getLayoutPageCount(a);void 0===i[a]&&(i[a]=[]);for(var l=2;l<=u;l+=1){var d=r.o.getMasterLayoutName(a,l);i[a].push(d)}n[a]=u-1}else{var f=r.o.getPPTMasterCount();n[0]=f;for(var h=0;h<f;h+=1)void 0===i[0]&&(i[0]=[]),i[0].push("")}e(T({layoutCountBySection:n,layoutNames:i})),e(_())}))},_=function(){return(0,o.RU)("setSlideLayoutThumbnailThunk",(function(e){u.Z.requestAllThumbnail()}))}},820371:function(e,t,n){n.d(t,{$T:function(){return C},Be:function(){return v},DM:function(){return y},FK:function(){return R},KT:function(){return D},ce:function(){return _},oK:function(){return N}});var i=n(601413),a=n(426373),o=n(135323),r=n(981142),u=n(625477),s=n(877703),c=n(628264),l=n(101922),d=n(53110),f=n(416031),h={currentPage:0,totalPage:0,isFirstPage:!1,isLastPage:!1,pageWidth:0,pageHeight:0,pageRatio:0,isShowPresentationEndingConfirm:!1,isShowingPageInfo:!1,isShowingPageNavigation:!1},g=(0,a.oM)({name:"page",initialState:h,reducers:{setPageSize:function(e,t){var n=t.payload,i=n.pageWidth,a=n.pageHeight;e.pageWidth=i,e.pageHeight=a,e.pageRatio=a>0?a/i:0},setPageNumber:function(e,t){var n=t.payload,i=n.currentPage,a=n.totalPage;d.tq?(e.currentPage===i&&e.totalPage===a||(e.isShowingPageInfo=!0),b()):e.isShowingPageInfo=!0,e.currentPage=i,e.totalPage=a,e.isFirstPage=1===i,e.isLastPage=i===a},setIsShowPresentationEndingConfirm:function(e,t){e.isShowPresentationEndingConfirm=t.payload},setIsShowingPageInfo:function(e,t){e.isShowingPageInfo=t.payload},setIsShowingPageNavigation:function(e,t){e.isShowingPageNavigation=t.payload}},extraReducers:function(e){e.addCase(l.qp,(function(e){e.isShowingPageInfo=!d.tq})),e.addCase(c.FZ,(function(e,t){if(!t.payload)return(0,i.Z)({},h)}))}}),P=g.actions,m=P.setPageSize,T=P.setPageNumber,p=P.setIsShowPresentationEndingConfirm,S=P.setIsShowingPageInfo,v=P.setIsShowingPageNavigation;t.ZP=g.reducer;var C=(0,o.P1)((function(e){return e.page}),(function(e){return e})),y=function(){return(0,u.RU)("updatePageSizeThunk",(function(e){var t=r.o.getPageInfo(1),n=t.nPageWidth,i=t.nPageHeight;e(m({pageWidth:n,pageHeight:i}))}))},_=function(){return(0,u.RU)("updatePageNumberThunk",(function(e){var t=r.o.getConfig(),n=t.nCurPage,i=t.nTotalPages;e(T({currentPage:n,totalPage:i}))}))},D=function(e,t){return(0,u.RU)("updatePageMoveThunk",(function(n,i){var a=i().page.currentPage;n(T({currentPage:e,totalPage:t})),n((0,s.Ml)([a,e]))}))},N=function(e){return(0,u.RU)("setIsShowPresentationEndingConfirmThunk",(function(t){t(p(e))}))},b=(0,f.debounce)((function(){(0,u.Ce)(S(!1))}),2e3),R=(0,f.debounce)((function(){(0,u.Ce)(v(!1))}),2e3)},886697:function(e,t,n){n.d(t,{k4:function(){return h},p0:function(){return f}});var i=n(601413),a=n(426373),o=n(135323),r=n(588567),u=n(981142),s=n(625477),c=(0,i.Z)((0,i.Z)({},(0,r.aL7)()),{},{isPageScroll:!1,isStartPos:!1,isEndPos:!1,scrollLimitX:0,scrollLimitY:0}),l=(0,a.oM)({name:"scrollBar",initialState:c,reducers:{setScrollBarState:function(e,t){return(0,i.Z)((0,i.Z)({},e),t.payload)}}}),d=l.actions.setScrollBarState;t.ZP=l.reducer;var f=(0,o.P1)((function(e){return e.scrollBar}),(function(e){return e})),h=function(){return(0,s.RU)("updateScrollInfoThunk",(function(e,t){var n=t().section.canvasRect,a=n.width,o=n.height,r=t().section.devicePixelRatio,s=u.o.getSlideScrollInfo(),c={nLeft:Math.floor(s.nLeft/r),nRight:Math.floor(s.nRight/r),nTop:Math.floor(s.nTop/r),nBottom:Math.floor(s.nBottom/r),nWidth:Math.floor(s.nWidth/r),nHeight:Math.floor(s.nHeight/r),nCurPosX:Math.floor(s.nCurPosX/r),nCurPosY:Math.floor(s.nCurPosY/r)};e(d((0,i.Z)((0,i.Z)({},c),{},{isPageScroll:c.nTop>=c.nCurPosY&&c.nBottom<=c.nCurPosY+o,isStartPos:c.nCurPosY<=0,isEndPos:c.nCurPosY+o>=c.nBottom,scrollLimitX:c.nRight-a,scrollLimitY:c.nBottom-o})))}))}},537997:function(e,t,n){n.d(t,{CG:function(){return h},Lf:function(){return d},V5:function(){return l},W0:function(){return f}});var i=n(426373),a=n(135323),o=n(625477),r=n(981142),u=n(101922),s=(0,i.oM)({name:"slideNote",initialState:{isShow:!1,note:""},reducers:{setSlideNote:function(e,t){e.note=t.payload},setIsSlideNoteShow:function(e,t){e.isShow=t.payload}},extraReducers:function(e){e.addCase(u.w4,(function(e,t){var n=t.payload.nCurrentPage;e.note=r.o.getSlideNoteString(n)}))}}),c=s.actions,l=c.setSlideNote,d=c.setIsSlideNoteShow;t.ZP=s.reducer;var f=(0,a.P1)((function(e){return e.slideNote}),(function(e){return e})),h=function(){return(0,o.RU)("updateSlideNoteThunk",(function(e,t){var n=t().page.currentPage,i=r.o.getSlideNoteString(n);e(l(i))}))}},877703:function(e,t,n){n.d(t,{A7:function(){return I},Cq:function(){return _},Hq:function(){return S},Ml:function(){return E},Tb:function(){return N},Tz:function(){return v},XQ:function(){return C},ZB:function(){return D},Zm:function(){return M},aG:function(){return L},pL:function(){return O},yE:function(){return y},z_:function(){return w}});var i=n(601413),a=n(426373),o=n(135323),r=n(416031),u=n(625477),s=n(628264),c=n(981142),l=n(820371),d=n(588567),f=n(735622),h=n(995124),g=n(361688),P={width:void 0,height:void 0,thumbnails:{},isResizing:!1,isPageDrag:!1},m=(0,a.oM)({name:"slideThumbnail",initialState:P,reducers:{setThumbnailSize:function(e,t){var n=t.payload,i=n.width,a=n.height;e.width=i,e.height=a},setThumbnailItem:function(e,t){var n=t.payload,i=n.pageNumber,a=n.thumbnailItem;e.thumbnails[i]=a},unmountThumbnail:function(e,t){var n=t.payload;delete e.thumbnails[n]},clearThumbnails:function(e){},setIsResizing:function(e,t){e.isResizing=t.payload},setIsPageDrag:function(e,t){var n=t.payload;e.isPageDrag=n,!n&&(e.pageDropTarget=void 0)},setPageDropTarget:function(e,t){e.pageDropTarget=t.payload}},extraReducers:function(e){e.addCase(s.FZ,(function(e,t){if(!t.payload)return(0,i.Z)({},P)}))}}),T=m.actions.clearThumbnails,p=m.actions,S=p.setThumbnailSize,v=p.setThumbnailItem,C=p.unmountThumbnail,y=p.setIsResizing,_=p.setIsPageDrag,D=p.setPageDropTarget;t.ZP=m.reducer;var N=(0,o.P1)((function(e){return e.slideThumbnail}),(function(e){return e})),b=function(e,t,n,i){if(i||c.o.isPageModified(e)){var a=(0,u.qm)(g.CI),o=4*t*a,r=4*n*a;c.o.slideObjStartEx(o,r,e)}},R=function(e,t){return(0,u.RU)("requestSlideThumbnailFromToThunk",(function(n,i){var a=i(),o=a.slideThumbnail,r=o.width,u=o.height,s=a.page.totalPage;if(r&&u&&s>0&&e>=1&&t<=s)for(var c=e;c<=t;c+=1)b(c,r,u,!0)}))},E=function(e){return(0,u.RU)("requestSlideThumbnailListThunk",(function(t,n){var i=e.length;if(i>0){var a=n(),o=a.slideThumbnail,r=o.width,u=o.height,s=a.page.totalPage;if(r&&u)for(var c=0;c<i;c+=1){var l=e[c];l>=1&&l<=s&&b(l,r,u,!0)}}}))},I=function(e){return(0,u.RU)("requestSlideThumbnailAllThunk",(function(t,n){var i=n(),a=i.slideThumbnail,o=a.width,r=a.height,u=i.page.totalPage;if(e&&t(T()),o&&r&&u>0)for(var s=function(e){setTimeout((function(){b(e,o,r,!0)}))},c=1;c<=u;c+=1)s(c)}))},O=(0,r.debounce)((function(){var e=(0,u.qm)(l.$T).currentPage,t=(0,u.qm)(N),n=t.width,i=t.height;n&&i&&e>0&&b(e,n,i)}),500),w=function(e){var t=e.nAction,n=e.stListInfo,i=n.nPageCnt,a=n.pPageList;switch(t){case d.jar.eBR_UNREDO_ACTION_NONE:(0,u.Ce)((0,l.DM)()),(0,u.Ce)((0,l.ce)());break;case d.jar.eBR_UNREDO_ACTION_ADD:case d.jar.eBR_UNREDO_ACTION_DELETE:(0,u.Ce)((0,l.ce)());break;case d.jar.eBR_UNREDO_ACTION_MOVE:var o=i>0?a[0]:0,r=i>1?a[i-1]:o,s=Math.min(o,r),c=Math.max(o,r);(0,u.Ce)(R(s,c));break;case d.jar.eBR_UNREDO_ACTION_CHANGE:case d.jar.eBR_UNREDO_ACTION_SLIDE_BACKGROUND:case d.jar.eBR_UNREDO_ACTION_SLIDE_INK:(0,u.Ce)(E(a));break;case d.jar.eBR_UNREDO_ACTION_SLIDE_ALL_BACKGROUND:case d.jar.eBR_UNREDO_ACTION_THEME_CHANGE:case d.jar.eBR_UNREDO_ACTION_ALL_FOOTER:(0,u.Ce)(I());case d.jar.eBR_UNREDO_ACTION_SLIDE_HIDE:case d.jar.eBR_UNREDO_ACTION_SLIDE_TRANSITION:case d.jar.eBR_UNREDO_ACTION_SLIDE_ANIMATION:case d.jar.eBR_UNREDO_ACTION_SLIDE_SECTION:}},L=function(){return(0,u.RU)("slidePageDropThunk",(function(e,t){var n=t(),a=n.page,o=n.slideThumbnail,u=a.currentPage,s=o.pageDropTarget;if(u>0&&!(0,r.isNil)(s)&&u!==s){var l=Math.min(s,u),f=Math.max(s,u);c.o.slideManageEx((0,i.Z)((0,i.Z)({},(0,d.zUw)()),{},{nType:d.fuO.BRGUI_PPT_SLIDEMOVEEX_EVENT,nSlidePage:s,nSectionIndex:0})),c.o.movePage(d.ZbX.eEV_MOVE_SETPAGE,s),e(R(l,f))}}))},M=function(){return(0,u.RU)("slidePageDeleteThunk",(function(e,t){var n=t().page,a=n.totalPage,o=n.currentPage;o>0&&(a>1?c.o.slideManageEx((0,i.Z)((0,i.Z)({},(0,d.zUw)()),{},{nType:d.fuO.BRGUI_PPT_SLIDEDELETE_EVENT,nSlidePage:o})):f.Z.showDialog({dialogId:h.O.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_SLIDE_REMAIN_ONE_PAGE"}}))}))}},173470:function(e,t,n){n.d(t,{So:function(){return S},Wm:function(){return m},Z7:function(){return v},ZS:function(){return i},i0:function(){return p},wP:function(){return P}});var i,a=n(426373),o=n(135323),r=n(625477),u=n(981142),s=n(53110),c=n(305054),l=n(530624);!function(e){e.EmbedVideo="embed_video",e.OnlineVideo="online_video"}(i||(i={}));var d={x:0,y:0,width:0,height:0,isShowing:!1,autoPlay:!1,videoPath:"",videoType:void 0},f=(0,a.oM)({name:"videoPlayer",initialState:d,reducers:{setVideoData:function(e,t){var n=t.payload,i=n.x,a=n.y,o=n.width,r=n.height,u=n.videoPath,s=n.videoType;e.x=i,e.y=a,e.width=o,e.height=r,e.videoPath=u,e.videoType=s,e.isShowing=!1},showVideoPlayer:function(e,t){e.isShowing=!0,e.autoPlay=t.payload},hideVideoPlayer:function(){return d},setVideoSize:function(e,t){var n=t.payload,i=n.x,a=n.y,o=n.width,r=n.height;e.x=i,e.y=a,e.width=o,e.height=r}},extraReducers:function(e){e.addCase(c.j,(function(e){if(l.uq.eObjCtrVideo!==c.Z.getObjectControlType())return d}))}}),h=f.actions,g=h.setVideoData,P=h.showVideoPlayer,m=h.hideVideoPlayer,T=h.setVideoSize;t.ZP=f.reducer;var p=(0,o.P1)((function(e){return e.videoPlayer}),(function(e){return e})),S=function(){return(0,r.RU)("loadVideoDataThunk",(function(e,t){var n=t(),a=u.o.getVideoPath(),o=u.o.getVideoRect(),r=n.section.devicePixelRatio,c=o.left/r,l=o.top/r,d=(o.right-o.left)/r,f=(o.bottom-o.top)/r,h=(0,s.jv)(a);e(g({x:c,y:l,width:d,height:f,videoPath:a,videoType:h?i.OnlineVideo:i.EmbedVideo}))}))},v=function(){return(0,r.RU)("updateVideoSizeThunk",(function(e,t){var n=t(),i=u.o.getVideoRect(),a=n.section.devicePixelRatio,o=i.left/a,r=i.top/a,s=(i.right-i.left)/a,c=(i.bottom-i.top)/a;e(T({x:o,y:r,width:s,height:c}))}))}}}]);