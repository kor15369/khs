"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[159954],{954384:function(e,t,n){n.d(t,{Z:function(){return L}});var o,r=n(601413),i=n(870885),u=n(747313),a=n(180252),c=n(837490),s=n(229860),l=n(361688),f=n(628264),v=n(981142),d=n(588567),h=n(748738),p=n(134314),m=n(382800),g=n(511173),M=n(432898),y=n(769071),S=n(732094),D=n(347806),C=n(258528),E=n(53110),I=n(795668),T=n(23719),O=n(652928),Z=n(851574),_=n(871521),A=n(499252),w=n(346417);function L(e){var t=(0,a.I0)(),n=(0,u.useRef)(null),L=(0,h.WV)((function(e){e&&p.Z.initCanvas(e)})),R=(0,i.Z)(L,2),k=R[0],K=R[1],N=(0,h.WV)((function(e){e&&m.Z.initCanvas(e)})),P=(0,i.Z)(N,2),x=P[0],V=P[1],Y=(0,a.v9)(s.RW).cursorStyle,X=(0,a.v9)(f.p_).isAppReady,U=(0,a.v9)(l.LG),B=(0,a.v9)(f.p_).viewMode,H=(0,M.Q)(),F=(0,u.useState)(o.None),W=(0,i.Z)(F,2),z=W[0],j=W[1],q=(0,u.useState)(0),G=(0,i.Z)(q,2),$=G[0],Q=G[1],J=(0,a.v9)(Z.te).selectPentType,ee=(0,u.useState)(0),te=(0,i.Z)(ee,2),ne=te[0],oe=te[1],re=(0,a.v9)(l.CI);(0,u.useEffect)((function(){var t=n.current;if(t){var o=function(t){if(!S.Z.isShapeDrawing()||g._b.current!==g.nV.Drag){var n=Math.sign(t.deltaY)>0;e.onWheel&&e.onWheel(t,{isPositive:n})||(H((function(){var e=t.ctrlKey,o=t.altKey,r=t.shiftKey;!e||o||r||B===O.wO.presentation||(n?v.o.zoomOut():v.o.zoomIn())})),t.preventDefault(),t.stopPropagation())}};t.addEventListener("wheel",o,{passive:!1});var r=function(e){e.touches.length>1&&e.preventDefault(),oe(e.timeStamp)};return t.addEventListener("touchstart",r,{passive:!1}),function(){t.removeEventListener("wheel",o),t.removeEventListener("touchstart",r)}}}),[e,H,B]),(0,u.useEffect)((function(){t((0,l.TA)(window.devicePixelRatio)),t((0,l.$e)(Math.floor(96*window.devicePixelRatio)));var e=k.current,n=x.current,o=U.width,r=U.height;e&&n&&o>0&&r>0&&(e.width=o*re,e.height=r*re,e.style.width="".concat(o,"px"),e.style.height="".concat(r,"px"),n.width=o*re,n.height=r*re,n.style.width="".concat(o,"px"),n.style.height="".concat(r,"px"),t(X?(0,f.u1)():(0,f.Ll)()))}),[k,U,X,t,x,re]);var ie=(0,u.useCallback)((function(e,t){return{offsetX:Math.floor(e-U.left),offsetY:Math.floor(t-U.top)}}),[U]),ue=(0,u.useCallback)((function(e){var t,n;if(e.touches&&e.touches.length>1)t=e.touches[0].clientX,n=e.touches[0].clientY;else{var o=e.nativeEvent.changedTouches;t=o[0].clientX,n=o[0].clientY}return{clientX:t,clientY:n}}),[]),ae=(0,u.useMemo)((function(){return{onMouseDown:function(t,n){var o=ie(t.clientX,t.clientY),i=o.offsetX,u=o.offsetY;e.onMouseDown&&e.onMouseDown(t,(0,r.Z)((0,r.Z)({},n),{},{offsetX:i,offsetY:u}))||(B===O.wO.edit&&y.Z.focus("DocInputField"),b.hidAction(d.vaW.eEV_HID_ACTION_DOWN,i*re,u*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseMove:function(t,n){var o=ie(t.clientX,t.clientY),i=o.offsetX,u=o.offsetY;e.onMouseMove&&e.onMouseMove(t,(0,r.Z)((0,r.Z)({},n),{},{offsetX:i,offsetY:u}))||g._b.current!==g.nV.Drag&&(b.mouseHovering(i*re,u*re,t.shiftKey,t.ctrlKey,t.altKey),t.preventDefault())},onMouseUp:function(t,n){var o=ie(t.clientX,t.clientY),i=o.offsetX,u=o.offsetY;e.onMouseUp&&e.onMouseUp(t,(0,r.Z)((0,r.Z)({},n),{},{offsetX:i,offsetY:u}))||(m.Z.clearSelectionArea(),b.hidAction(d.vaW.eEV_HID_ACTION_UP,i*re,u*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseDrag:function(t,n){var o=ie(t.clientX,t.clientY),i=o.offsetX,u=o.offsetY;e.onMouseDrag&&e.onMouseDrag(t,(0,r.Z)((0,r.Z)({},n),{},{offsetX:i,offsetY:u}))||(m.Z.resizeSelectionArea({nX:i*re,nY:u*re}),b.hidAction(d.vaW.eEV_HID_ACTION_MOVE,i*re,u*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseDrop:function(t,n){var i=ie(t.clientX,t.clientY),u=i.offsetX,a=i.offsetY;if(m.Z.clearSelectionArea(),z!==o.Swiping)if(u>U.right||u<0){var c=u<0?0:U.right;b.hidAction(d.vaW.eEV_HID_ACTION_UP,c*re,a*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey))}else if(a>U.bottom||a<0){var s=a<0?0:U.bottom;b.hidAction(d.vaW.eEV_HID_ACTION_UP,u*re,s*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey))}else b.hidAction(d.vaW.eEV_HID_ACTION_UP,u*re,a*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey));e.onMouseDrop&&e.onMouseDrop(t,(0,r.Z)((0,r.Z)({},n),{},{offsetX:u,offsetY:a}))||t.preventDefault()}}}),[ie,e,B,z,re,U]),ce=(0,g.Ek)(ae),se=(0,i.Z)(ce,2)[1],le=(0,u.useMemo)((function(){return{onTouchStart:function(n){var r=ue(n),i=r.clientX,u=r.clientY,a=ie(i,u),c=a.offsetX,s=a.offsetY;e.onTouchStart&&e.onTouchStart(n)||(b.hidAction(d.vaW.eEV_HID_ACTION_DOWN,c*re,s*re,b.getModifierVK(0,!1,!1),0,0,!0),n.touches&&2===n.touches.length&&(n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation()),j(o.None),t((0,_.gu)(!1)))},onLongTouch:function(t){var n=ue(t),o=n.clientX,r=n.clientY,i=ie(o,r),u=i.offsetX,a=i.offsetY;b.hidAction(d.vaW.eEV_HID_ACTION_DOWN,u*re,a*re,b.getModifierVK(0,t.ctrlKey,t.shiftKey)),b.hidAction(d.vaW.eEV_HID_ACTION_DBLCLK,u*re,a*re,b.getModifierVK(0,t.ctrlKey,t.shiftKey)),b.hidAction(d.vaW.eEV_HID_ACTION_UP,u*re,a*re,b.getModifierVK(0,t.ctrlKey,t.shiftKey)),e.onLongTouch&&e.onLongTouch(t)},onTouchMove:function(t,n){var o=ue(t),r=o.clientX,i=o.clientY,u=ie(r,i),a=u.offsetX,c=u.offsetY,s=n.touchStatus,l=n.firstTouchList,f=n.lastTouchList,h=n.zoomRatio;if(!e.onTouchMove||!e.onTouchMove(t,n))if(s===I.th.Move){if(!t.touches||!f)return;b.hidAction(d.vaW.eEV_HID_ACTION_MOVE,a*re,c*re,b.getModifierVK(0,!1,!1),0,0,!0)}else if(s===I.th.Scaling){if(!h)return;if(!t.touches||2!==t.touches.length||!l)return;var p=h.startZoomRatio,m=h.minZoomRatio,g=h.maxZoomRatio,M=t.touches[0].clientX-t.touches[1].clientX,y=t.touches[0].clientY-t.touches[1].clientY,S=Math.sqrt(Math.abs(M*M)+Math.abs(y*y)),D=l[0].clientX-l[1].clientX,C=l[0].clientY-l[1].clientY,E=Math.sqrt(Math.abs(D*D)+Math.abs(C*C)),T=Math.abs(p*(1+(S-E)/E));T=Math.floor(Math.max(Math.min(T,g),m)),Math.abs($-T)>200&&(v.o.setZoom(T),Q(T)),t.nativeEvent.preventDefault(),t.nativeEvent.stopPropagation()}},onTouchEnd:function(n){var r=ue(n),i=r.clientX,u=r.clientY,a=ie(i,u),c=a.offsetX,s=a.offsetY;z!==o.Swiped&&b.hidAction(d.vaW.eEV_HID_ACTION_UP,c*re,s*re,b.getModifierVK(0,!1,!1),0,0,!0),2===n.touches.length&&(n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation()),e.onTouchEnd&&e.onTouchEnd(n)||setTimeout((function(){var e=v.o.getMarkStringLength()>0?v.o.getMarkString():"";t((0,A.OU)(e)),t((0,_.gu)(!0))}),200)}}}),[$,t,ue,ie,e,z,re]),fe=(0,I.VZ)(le),ve=(0,u.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),de=(0,u.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),he=(0,u.useCallback)((function(t){var n=ie(t.clientX,t.clientY),o=n.offsetX,r=n.offsetY;e.onDoubleClick&&e.onDoubleClick(t,{offsetX:o,offsetY:r})||(b.hidAction(d.vaW.eEV_HID_ACTION_DBLCLK,o*re,r*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),b.hidAction(d.vaW.eEV_HID_ACTION_UP,o*re,r*re,b.getModifierVK(t.button,t.ctrlKey,t.shiftKey)))}),[e,ie,re]),pe=(0,u.useCallback)((function(t){var n=ie(t.clientX,t.clientY),o=n.offsetX,r=n.offsetY;if((!e.onContextMenu||!e.onContextMenu(t,{offsetX:o,offsetY:r}))&&!S.Z.isShapeDrawing()){var i=E.UL.getAppBoundingClientRect(t.currentTarget),u={type:C.b9.DocFrame,posX:i.left+o,posY:i.top+r,limitPosX:i.right,limitPosY:i.bottom,offsetX:o,offsetY:r};D.Z.showContextMenu(u),t.preventDefault(),t.stopPropagation()}}),[e,ie]),me=(0,T.useSwipeable)({onSwiping:function(t){(0,Z.dE)(J)||e.onSwiping&&e.onSwiping(t)||j(o.Swiping)},onSwiped:function(t){var n=t.event,r=t.absX,i=t.absY,u=(n.timeStamp||0)-ne;if(!(Math.sqrt(r*r+i*i)/(u||1)<1)&&!(0,Z.dE)(J)&&(!e.onSwiped||!e.onSwiped(t))){var a=t.vxvy,c=t.initial,s=t.deltaX,l=t.deltaY,f=ie(c[0]+s,c[1]+l),h=f.offsetX,p=f.offsetY,m=1e3*a[0]*-1,g=1e3*a[1]*-1;v.o.flick(Math.floor(m*re),Math.floor(g*re)),b.hidAction(d.vaW.eEV_HID_ACTION_UP,h*re,p*re,b.getModifierVK(0,!1,!1),0,0,!0),j(o.Swiped)}},preventDefaultTouchmoveEvent:!0,trackMouse:!1,trackTouch:!0}),ge=(0,u.useMemo)((function(){return(0,w.jsx)("canvas",{className:Y.type===s.E.ClassName?Y.value:"",style:{cursor:Y.type===s.E.InlineStyle?"url(".concat(Y.value,"), auto"):""},ref:K})}),[Y.type,Y.value,K]),Me=(0,u.useMemo)((function(){return(0,w.jsx)("canvas",{className:Y.type===s.E.ClassName?Y.value:"",style:{cursor:Y.type===s.E.InlineStyle?"url(".concat(Y.value,"), auto"):""},ref:V})}),[Y.type,Y.value,V]);return(0,w.jsxs)("div",(0,r.Z)((0,r.Z)((0,r.Z)({className:c.Z.canvas,ref:n},se),fe),{},{onDragOver:de,onDrop:ve,onDoubleClick:he,onContextMenu:pe,children:[(0,w.jsx)("div",(0,r.Z)((0,r.Z)({},me),{},{children:ge})),(0,w.jsx)("div",{children:Me})]}))}!function(e){e[e.None=0]="None",e[e.Swiping=1]="Swiping",e[e.Swiped=2]="Swiped"}(o||(o={}));var b={getModifierVK:function(e,t,n){var o=0;return t&&n?o=d.DPu.VK_CTRL_SHIFT:t?o=d.DPu.VK_CONTROL:n&&(o=d.DPu.VK_SHIFT),o},hidAction:function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];v.o.HIDAction(e,t,n,o,r,i,u)},mouseHovering:function(e,t,n,o,r){v.o.mouseHovering(e,t,n,o,r)}}},225858:function(e,t,n){n.d(t,{Z:function(){return T}});var o=n(601413),r=n(870885),i=n(747313),u=n(837490),a=n(769071),c=n(59127),s=n(80865),l=n(495017),f=n(981142),v=n(588567),d=n(906375),h=n(939208),p=n(382800),m=n(180252),g=n(459551),M=n(652928),y=n(628264),S=n(53110),D=n(851574),C=n(625477),E=n(361688),I=n(346417);function T(e){var t=(0,i.useRef)(null),n=(0,a.n)({id:"DocInputField",elementRef:t}),d=(0,r.Z)(n,2)[1],D=(0,i.useState)(""),C=(0,r.Z)(D,2),T=C[0],Z=C[1],_=(0,m.v9)(E.CI),A=(0,i.useMemo)((function(){var e=p.Z.getCaretInfo();return e?{left:(null===e||void 0===e?void 0:e.x)/_,top:(null===e||void 0===e?void 0:e.y)/_,inputChar:T}:{left:void 0,top:void 0,inputChar:T}}),[T,_]),w=A.left,L=A.top,b=(0,m.v9)(g.hz).docType,R=(0,m.v9)(y.p_).viewMode;(0,i.useEffect)((function(){var e=t.current;e&&(S.tq||R!==M.wO.edit?e.setAttribute("readOnly","readOnly"):e.removeAttribute("readOnly"))}),[t,R]);var k=(0,i.useMemo)((function(){return{left:"".concat(w,"px"),top:"".concat(L,"px")}}),[w,L]),K=(0,i.useMemo)((function(){return{onKeyDown:function(t,n){e.onKeyDown&&e.onKeyDown(t,n)||O(t,b)&&"Enter"!==t.key&&t.preventDefault()},onInput:function(t,n){if(!e.onInput||!e.onInput(t,n)){var o=t.nativeEvent;if(o){var r=o.inputType,i=o.isComposing,u=o.data;if(!i){switch(r){case"deleteContentBackward":f.o.charInsert(c.S.Backspace,!1,!1,!1);break;case"insertText":h.Z.record(h.d.CompositionEnd,u),f.o.insertString(u,v.v$l.BR_IME_COMPOSITING_RESULT);break;case"insertReplacementText":f.o.charInsert(c.S.Backspace,!1,!1,!1),f.o.insertString(u,v.v$l.BR_IME_COMPOSITING_RESULT)}"insertParagraph"!==r&&" "!==u||(t.currentTarget.value="")}}}},onKeyUp:function(t,n){e.onKeyUp&&e.onKeyUp(t,n)}}}),[b,e]),N=(0,s.L)(K),P=(0,r.Z)(N,2)[1],x=(0,i.useMemo)((function(){return{onCompositionStart:function(e,t){h.Z.record(h.d.CompositionStart,e.data)},onCompositionUpdate:function(e,t){h.Z.record(h.d.CompositionUpdate,e.data),f.o.insertString(e.data,v.v$l.BR_IME_COMPOSITING),Z(e.data)},onCompositionEnd:function(e,t){var n=e.data;""===n&&(n=T),h.Z.record(h.d.CompositionEnd,n),f.o.insertString(n,v.v$l.BR_IME_COMPOSITING_RESULT),e.currentTarget.value="",Z("")}}}),[T,Z]),V=(0,l.MT)(x),Y=(0,r.Z)(V,2)[1],X={onPaste:(0,i.useCallback)((function(t){e.onPaste&&e.onPaste(t)}),[e]),onCopy:(0,i.useCallback)((function(t){e.onCopy&&e.onCopy(t)}),[e]),onCut:(0,i.useCallback)((function(t){e.onCut&&e.onCut(t)}),[e])};return(0,I.jsx)("input",(0,o.Z)((0,o.Z)((0,o.Z)((0,o.Z)({type:"text",className:u.Z.inputfield,ref:t,style:k},d),P),Y),X))}var O=function(e,t){var n=e.keyCode,o=e.shiftKey,r=e.ctrlKey,i=e.altKey;if(c.Z.NAVIGATION.includes(n))return f.o.caretMove(n,o,r,i,!1,t===M.n_.hwp),!0;if(n===c.S.Backspace||n===c.S.Delete)return f.o.charInsert(n,o,r,i),!0;if(n===c.S.BackTick)return f.o.charInsert(o?126:96,o,r,i),!0;if(n===c.S.Enter)return f.o.isSheetEditingCell()?(i?(a.Z.updateFocus("DocInputField"),f.o.charInsert(10,o,r,i)):f.o.sheetCellEditingConfirm(o,r),!0):(f.o.charInsert(10,o,r,i),!0);if(n===c.S.Tab)return f.o.charInsert(n,o,r,i),!0;if(n===c.S.Escape){if(d.Z.isTableDrawing())return f.o.setTableDrawOff(),!0;var u=(0,C.qm)(D.te).selectPentType;return(0,D.dE)(u)&&(0,C.Ce)((0,D.v4)()),f.o.charInsert(n,o,r,i),!0}return!1}},84912:function(e,t,n){n.d(t,{Z:function(){return M}});var o=n(601413),r=n(944925),i=n(870885),u=n(747313),a=n(180252),c=n(401355),s=n(837490),l=n(652928),f=n(795668),v=n(511173),d=n(628264),h=n(711106),p=n(346417),m=["type","range","current"],g=["type","range","current","ratio"];function M(e){var t=e.type,n=(0,i.Z)(e.range,2),o=n[0],f=n[1],v=e.current,h=v.position,g=v.size,M=(0,r.Z)(e,m),S=(0,u.useRef)(null),D=(0,u.useRef)(null),C=(0,a.v9)(d.p_).viewMode,E=(0,u.useState)(0),I=(0,i.Z)(E,2),T=I[0],O=I[1],Z="vertical"===t,_=(0,u.useMemo)((function(){return f-o}),[o,f]),A=(0,u.useMemo)((function(){return _>g&&T>0}),[_,g,T]);(0,u.useEffect)((function(){var e=S.current;if(e){var t=new c.Z((function(){var t=e.getBoundingClientRect(),n=t.width,o=t.height;O((Z?o:n)/_)}));return t.observe(e),function(){t.unobserve(e)}}}),[Z,_]);var w=(0,u.useCallback)((function(e){var t,n=null===(t=D.current)||void 0===t?void 0:t.getRect();if(n){var o=Z?n.top:n.left,r=Z?n.bottom:n.right,i=Z?e.clientY:e.clientX;i<o?M.onScrollClick&&M.onScrollClick(!1):i>r&&M.onScrollClick&&M.onScrollClick(!0)}}),[Z,M]),L={visibility:C===l.wO.presentation?"hidden":"visible"};return(0,p.jsx)("div",{className:"".concat(s.Z.scrollbar," ").concat(s.Z[t]),ref:S,style:L,onMouseDown:w,children:A&&(0,p.jsx)(y,{ref:D,type:t,range:[o,f],current:{position:h,size:g},ratio:T,onScrollDrag:M.onScrollDrag,onScrollDrop:M.onScrollDrop})})}var y=(0,u.forwardRef)((function(e,t){var n=e.type,c=(0,i.Z)(e.range,2),l=c[0],d=c[1],m=e.current,M=m.position,y=m.size,S=e.ratio,D=(0,r.Z)(e,g),C=(0,a.I0)(),E="vertical"===n,I=(0,u.useRef)(null),T=(0,u.useState)(!1),O=(0,i.Z)(T,2),Z=O[0],_=O[1],A=(0,u.useRef)();(0,u.useEffect)((function(){C(Z?(0,h.Gi)(s.Z.scrollbar_drag):(0,h.iQ)(s.Z.scrollbar_drag))}),[C,Z]),(0,u.useImperativeHandle)(t,(function(){return{getRect:function(){return I.current&&I.current.getBoundingClientRect()}}}));var w=(0,u.useMemo)((function(){return Z&&A.current?A.current.ratio:S}),[Z,S]),L=(0,u.useMemo)((function(){return y*w}),[y,w]),b=(0,u.useMemo)((function(){return(M-l)*w}),[M,l,w]),R=(0,u.useCallback)((function(e){var t=I.current,n=null===t||void 0===t?void 0:t.parentElement;if(t&&n){var o=n.getBoundingClientRect()[E?"top":"left"],r=t.getBoundingClientRect()[E?"top":"left"];A.current={parentStart:o,innerPos:e-r,range:[l,d],size:y,ratio:S}}}),[E,y,S,l,d]),k=(0,u.useCallback)((function(e){var t=A.current;if(t){var n=e-t.parentStart,o=(n-t.innerPos)/t.ratio;o+=t.range[0],o=Math.max(o,t.range[0]),o=Math.min(o,t.range[1]-t.size);var r=n/t.ratio;return r+=t.range[0],r=Math.max(r,t.range[0]),[o,r=Math.min(r,t.range[1])]}}),[]),K=(0,u.useMemo)((function(){return{onMouseDown:function(e){var t=E?e.clientY:e.clientX;R(t)},onMouseDrag:function(e){if(!Z&&_(!0),D.onScrollDrag){var t=Math.sign(e.movementY)>0,n=k(E?e.clientY:e.clientX);n&&D.onScrollDrag(n[0],n[1],t)}},onMouseDrop:function(e){if(Z&&_(!1),D.onScrollDrop){var t=Math.sign(e.movementY)>0,n=k(E?e.clientY:e.clientX);n&&D.onScrollDrop(n[0],n[1],t)}A.current=void 0},onMouseUp:function(){A.current=void 0}}}),[E,Z,R,k,D]),N=(0,v.Ek)(K),P=(0,i.Z)(N,2)[1],x=(0,u.useMemo)((function(){return{onTouchStart:function(e){var t=E?e.touches[0].clientY:e.touches[0].clientX;R(t)},onTouchMove:function(e,t){var n=t.touchStatus,o=t.lastTouchList;if(n===f.th.Move&&e.touches&&o){var r=e.touches[0].clientY-o[0].clientY;if(D.onScrollDrag){var i=Math.sign(r)>0,u=k(E?e.touches[0].clientY:e.touches[0].clientX);u&&D.onScrollDrag(u[0],u[1],i)}}},onTouchEnd:function(){A.current=void 0}}}),[k,E,D,R]),V=(0,f.VZ)(x),Y={};Y[E?"height":"width"]="".concat(L,"px"),Y[E?"top":"left"]="".concat(b,"px");var X=s.Z.bar;return Z&&(X="".concat(X," ").concat(s.Z.on)),(0,p.jsx)("div",(0,o.Z)((0,o.Z)({className:X,ref:I,style:Y},P),V))}))},782345:function(e,t,n){n.d(t,{U:function(){return I},j:function(){return o}});var o,r=n(974165),i=n(115861),u=n(215671),a=n(143144),c=n(625477),s=n(500811),l=n(628264),f=n(652928),v=n(735622),d=n(995124),h=n(769071),p=n(981142),m=n(588567),g=n(416031),M=n(815e3),y=n(53110);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(o||(o={}));var S=/<!--\[if gte vml 1\]>/g,D=/<!\[endif\]-->/g,C=/<!--\[PO\]\[if gte vml 1\]>/g,E=/<!\[endif\]\[PO\]-->/g,I=function(){function e(){(0,u.Z)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return(0,a.Z)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,(0,c.Ce)((0,s.vQ)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,(0,c.Ce)((0,s.$A)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===d.O.COMMON_CLIPBOARD?v.Z.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):v.Z.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return(0,c.qm)(l.p_).viewMode===f.wO.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,p.o.editDocument(m.OjI.BR_EDITMODE_COPY,m.vlz.CLIPDATA_FAVORITE_DATA,null,o.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,p.o.editDocument(m.OjI.BR_EDITMODE_CUT,m.vlz.CLIPDATA_STR,null,o.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.OjI.BR_EDITMODE_PASTE,t=M.ZP.get("preventPasteFromExternal");this.isNativeMode||t?p.o.editDocument(e,m.vlz.CLIPDATA_STR,null,o.NATIVE_CLIPBOARD):this.showAlert(d.O.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){p.o.editDocument(m.OjI.BR_EDITMODE_ORIGINAL_FORMAT,t,t===m.vlz.CLIPDATA_HTML?this.excludeImgElements(e):e,o.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=function(){var t=e[0];if(t){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,o=t.width,u=t.height;o>e||u>n;)o>e?(u*=e/o,o=e):u>n&&(o*=n/u,u=n);var a=document.createElement("canvas");a.width=o,a.height=u;var c=a.getContext("2d");c&&(c.drawImage(t,0,0,o,u),a.toBlob(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,(0,y.Cq)(t);case 3:(n=e.sent)instanceof ArrayBuffer&&p.o.imageInsert(n,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(t)}},n=0;n<e.length;n+=1)t()}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),o=!(0,g.isEmpty)(n),r=!(0,g.isEmpty)(t),i=o&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),u=e.files&&e.files.length>0,a=M.ZP.get("preventPasteFromExternal");i||a?this.nativePaste():u&&!r?this.appendClipboardImage(e.files):o&&this.htmlDataTagCount(n)>0?this.externalPaste(n,m.vlz.CLIPDATA_HTML):r&&this.externalPaste(t,m.vlz.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var o=n.getElementsByTagName(t).length;return n.remove(),o}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===m.vlz.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var o=document.createRange();o.selectNodeContents(n);var r=window.getSelection();if(r){var i,u,a=[];if(r.rangeCount>0)for(var c=0;c<r.rangeCount;c+=1){var s=r.getRangeAt(c);a.push(s)}if(r.removeAllRanges(),r.addRange(o),document.execCommand("copy"),r.removeAllRanges(),a&&a.length>0)for(var l=0;l<a.length;l+=1)r.addRange(a[l]);var f=null===(i=h.Z.getForcusRef("DocInputField"))||void 0===i||null===(u=i.elementRef)||void 0===u?void 0:u.current;f&&f instanceof HTMLInputElement&&f.select()}}n.remove(),h.Z.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(S,"").replace(D,"");for(var n=t.getElementsByTagName("img"),o=0;o<n.length;o+=1){var r=n[o].getAttribute("v:shapes");if(!(0,g.isEmpty)(r)){var i=t.querySelector('[id="'.concat(r,'"]'));if(!i||!i.tagName||!i.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(S,"\x3c!--[PO][if gte vml 1]>")).replace(D,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!C.test(e)||!E.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(C,"").replace(E,"");var n=document.createElement("div");n.innerHTML=e.replace(C,"\x3c!--[if gte vml 1]>").replace(E,"<![endif]--\x3e");for(var o=n.getElementsByTagName("img"),r=o.length-1;r>=0;r-=1){var i=o[r],u=i.getAttribute("v:shapes");if(!(0,g.isEmpty)(u)){var a=t.querySelector('[id="'.concat(u,'"]'));a&&a.tagName&&a.tagName.toLowerCase().startsWith("v:")&&i.remove()}}return n.innerHTML}}]),e}()},511173:function(e,t,n){n.d(t,{Ek:function(){return s},_b:function(){return l},nV:function(){return o}});var o,r,i,u=n(215671),a=n(143144),c=n(747313);!function(e){e[e.Down=0]="Down",e[e.Move=1]="Move",e[e.Up=2]="Up",e[e.Drag=3]="Drag",e[e.Drop=4]="Drop"}(o||(o={})),function(e){e[e.Enter=0]="Enter",e[e.Leave=1]="Leave"}(r||(r={})),function(e){e[e.Over=0]="Over",e[e.Out=1]="Out"}(i||(i={}));var s=function(e){var t=(0,c.useRef)(),n=(0,c.useRef)(),u=(0,c.useRef)(),a=(0,c.useRef)({});(0,c.useEffect)((function(){a.current=e}),[e]);var s=(0,c.useCallback)((function(e){n.current===r.Leave&&(l.onMouseMove(),t.current=o.Drag,a.current.onMouseDrag&&a.current.onMouseDrag(e,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current}))}),[]),f=(0,c.useCallback)((function(e){document.removeEventListener("mousemove",s,!0),document.removeEventListener("mouseup",f,!0),u.current===i.Out&&t.current===o.Drag&&(l.onMouseUp(),t.current=o.Drop,a.current.onMouseDrop&&a.current.onMouseDrop(e,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current}))}),[s]),v=(0,c.useMemo)((function(){return{onMouseDown:function(r){l.onMouseDown(),t.current=o.Down,e.onMouseDown&&e.onMouseDown(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current}),document.addEventListener("mousemove",s,!0),document.addEventListener("mouseup",f,!0)},onMouseMove:function(r){l.onMouseMove(),t.current===o.Down||t.current===o.Drag?t.current=o.Drag:t.current=o.Move,t.current===o.Drag&&e.onMouseDrag?e.onMouseDrag(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current}):e.onMouseMove&&e.onMouseMove(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})},onMouseUp:function(r){l.onMouseUp(),t.current===o.Drag?t.current=o.Drop:t.current=o.Up,t.current===o.Drop&&e.onMouseDrop?e.onMouseDrop(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current}):e.onMouseUp&&e.onMouseUp(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})},onMouseEnter:function(o){n.current=r.Enter,e.onMouseEnter&&e.onMouseEnter(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})},onMouseLeave:function(o){n.current=r.Leave,e.onMouseLeave&&e.onMouseLeave(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})},onMouseOver:function(o){u.current=i.Over,e.onMouseOver&&e.onMouseOver(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})},onMouseOut:function(o){u.current=i.Out,e.onMouseOut&&e.onMouseOut(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:u.current})}}}),[e,s,f]);return[t,v]},l=new(function(){function e(){(0,u.Z)(this,e),this.status=void 0}return(0,a.Z)(e,[{key:"current",get:function(){return this.status}},{key:"onMouseDown",value:function(){this.status=o.Down}},{key:"onMouseMove",value:function(){this.status===o.Down||this.status===o.Drag?this.status=o.Drag:this.status=o.Move}},{key:"onMouseUp",value:function(){this.status===o.Drag?this.status=o.Drop:this.status=o.Up}}]),e}())},495017:function(e,t,n){n.d(t,{KC:function(){return o},MT:function(){return a},pY:function(){return u}});var o,r=n(747313);!function(e){e[e.Start=0]="Start",e[e.Update=1]="Update",e[e.End=2]="End"}(o||(o={}));var i=o.End,u=function(){return i},a=function(e){var t=(0,r.useRef)(),n=(0,r.useMemo)((function(){return{onCompositionStart:function(n){i=o.Start,t.current=!0,null!==e&&void 0!==e&&e.onCompositionStart&&e.onCompositionStart(n,{isComposing:t.current})},onCompositionUpdate:function(n){i=o.Update,t.current=!0,null!==e&&void 0!==e&&e.onCompositionUpdate&&e.onCompositionUpdate(n,{isComposing:t.current})},onCompositionEnd:function(n){i=o.End,t.current=!1,null!==e&&void 0!==e&&e.onCompositionEnd&&e.onCompositionEnd(n,{isComposing:t.current})}}}),[e]);return[t,n]}},432898:function(e,t,n){n.d(t,{Q:function(){return r}});var o=n(747313),r=function(){var e=(0,o.useRef)();return function(t){e.current&&window.cancelAnimationFrame(e.current),e.current=window.requestAnimationFrame((function(n){t(n),e.current=void 0}))}}},795668:function(e,t,n){n.d(t,{VZ:function(){return a},th:function(){return o}});var o,r=n(870885),i=n(747313),u=n(981142);!function(e){e[e.Start=0]="Start",e[e.Move=1]="Move",e[e.End=2]="End",e[e.ScaleStart=3]="ScaleStart",e[e.Scaling=4]="Scaling",e[e.ScaleEnd=5]="ScaleEnd"}(o||(o={}));var a=function(e){var t=(0,i.useRef)(),n=(0,i.useRef)({}),a=(0,i.useState)(void 0),c=(0,r.Z)(a,2),s=c[0],l=c[1],f=(0,i.useState)(void 0),v=(0,r.Z)(f,2),d=v[0],h=v[1],p=(0,i.useState)(void 0),m=(0,r.Z)(p,2),g=m[0],M=m[1],y=(0,i.useRef)(null);return(0,i.useEffect)((function(){n.current=e}),[e]),(0,i.useMemo)((function(){return{onTouchStart:function(n){var r=n.touches.length;if(t.current=2===r?o.ScaleStart:o.Start,t.current===o.ScaleStart){var i=u.o.getConfig();M({startZoomRatio:i.nZoomRatio,minZoomRatio:i.nMinZoom,maxZoomRatio:i.nMaxZoom})}e.onTouchStart&&e.onTouchStart(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:g}),l(n.touches),h(n.touches),y.current=setTimeout((function(){e.onLongTouch&&(e.onLongTouch(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:g}),y.current=null)}),500)},onTouchMove:function(n){t.current===o.Start?y.current&&(t.current=o.Move,clearTimeout(y.current)):t.current===o.ScaleStart&&(t.current=o.Scaling),e.onTouchMove&&e.onTouchMove(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:g}),h(n.touches)},onTouchEnd:function(n){t.current===o.Start?(y.current&&clearTimeout(y.current),t.current=o.End):t.current===o.Move?t.current=o.End:t.current===o.Scaling&&(t.current=o.ScaleEnd),e.onTouchEnd&&e.onTouchEnd(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:g}),h(n.touches)}}}),[s,e,d,g])}},557950:function(e,t,n){n.d(t,{l:function(){return u}});var o=n(215671),r=n(143144),i=n(650984),u=function(){function e(){(0,o.Z)(this,e),this.keyItems=void 0,this.isMacOS="macOS"===(0,i.getParser)(window.navigator.userAgent).getOSName(),this.keyItems=[],this.initKeyItem()}return(0,r.Z)(e,[{key:"addItem",value:function(e,t,n,o,r,i,u){var a=t&&this.isMacOS;this.keyItems.push({keyCode:e,ctrlKey:t,shiftKey:n,altKey:o,metaKey:a,action:r,resourceID:i,combindKeyCode:u})}},{key:"getHotKeyItem",value:function(e,t){var n=this;return this.keyItems.find((function(o){var r=o.keyCode,i=o.ctrlKey,u=o.shiftKey,a=o.altKey,c=o.metaKey,s=o.combindKeyCode;return s&&t?s===(null===e||void 0===e?void 0:e.keyCode)&&r===(null===t||void 0===t?void 0:t.keyCode)&&u===t.shiftKey&&a===t.altKey&&(n.isMacOS?c===t.metaKey:i===t.ctrlKey):(r===e.keyCode||r===e.code)&&u===e.shiftKey&&a===e.altKey&&(n.isMacOS?c===e.metaKey:i===e.ctrlKey)}))}}]),e}()},562748:function(e,t,n){n.d(t,{y:function(){return s}});var o=n(215671),r=n(143144),i=n(625477),u=n(628264),a=n(652928),c=n(769071),s=function(){function e(){(0,o.Z)(this,e),this.previousIputKeyData=void 0}return(0,r.Z)(e,[{key:"isEditMode",value:function(){return(0,i.qm)(u.p_).viewMode===a.wO.edit}},{key:"preventInput",value:function(){c.Z.blur("DocInputField"),setTimeout((function(){c.Z.focus("DocInputField")}),100)}}]),e}()}}]);