"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[698062],{827611:function(e,t,n){n.d(t,{Z:function(){return i}});n(747313);var l=n(837490),r=n(307360),a=n(346417);function i(e){var t=e.buttonLabels,n=e.onClick,i=e.buttonDisableStates;return(0,a.jsx)("div",{className:l.Z.popup_btn_wrap,children:t.map((function(e,t){var s=!!i&&i[t];return(0,a.jsx)("button",{className:"".concat(l.Z.p_btn," ").concat(l.Z.normal),onClick:function(){return n(t)},disabled:s,children:(0,a.jsx)(r.Z,{label:e})},t)}))})}},96001:function(e,t,n){n.d(t,{Z:function(){return i}});n(747313);var l=n(837490),r=n(307360),a=n(346417);function i(e){var t=e.tabs,n=e.onTabChange,i=e.tabIndex;return(0,a.jsx)("div",{className:l.Z.popup_tab,children:(0,a.jsx)("ul",{children:t.map((function(e,t){return(0,a.jsx)("li",{children:(0,a.jsx)("button",{className:i===t?l.Z.on:"",onClick:function(){return n(t)},children:(0,a.jsx)(r.Z,{label:e.label})})},t)}))})})}},551261:function(e,t,n){n.d(t,{U:function(){return l},Z:function(){return T}});var l,r=n(601413),a=n(215671),i=n(143144),s=n(179340),c=n(432269),u=n(145729),o=n(981142),p=n(588567),h=n(766046),b=n(416031);!function(e){e.DeleteHyperlink="delete_hyperlink",e.InsertHyperlink="insert_hyperlink"}(l||(l={}));var T=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"invoke",value:function(e){var t=e.actionType,n=e.displayText,a=e.hyperlink,i=e.hyperLinkTab,s=e.selectedLinkType;if(t===l.DeleteHyperlink){var c=o.o.getHyperlinkInfo(0,0);c.nLinkType=p.QLl.EV_LINK_TO_REMOVE,c.nRunType=p.Cuw.EV_LINK_RUNTYPE_MOUSE_CLICK,c.nLinkTypeMouseOver=p.QLl.EV_LINK_TO_REMOVE,o.o.setHyperLinkInfoFromJson(c)}else if(t===l.InsertHyperlink)if(i===h.HyperlinkTab.Web||i===h.HyperlinkTab.Email){var u,T=a.toLowerCase(),_="";if(T.startsWith("http:/")){var x=T.startsWith("http://")?7:6;_="http://".concat(a.substring(x)),u=p.QLl.EV_LINK_TO_URL}else if(T.startsWith("https:/")){var L=T.startsWith("https://")?8:7;_="https://".concat(a.substring(L)),u=p.QLl.EV_LINK_TO_URL}else if(T.startsWith("mailto:")){var d;d=T.startsWith("mailto://")?9:T.startsWith("mailto:/")?8:7,_="mailto://".concat(a.substring(d)),u=p.QLl.EV_LINK_TO_EMAIL}else _="http://".concat(a),u=p.QLl.EV_LINK_TO_URL;var C=(0,r.Z)((0,r.Z)({},(0,p.Nuw)()),{},{nLinkType:u,nRunType:p.Cuw.EV_LINK_RUNTYPE_MOUSE_CLICK,szHyperLink:_,szHyperText:(0,b.isEmpty)(n)?_:n});o.o.setHyperLinkInfoFromJson(C)}else{var k=(0,r.Z)((0,r.Z)({},(0,p.Nuw)()),{},{nLinkType:s,nRunType:p.Cuw.EV_LINK_RUNTYPE_MOUSE_CLICK,szHyperLink:a,szHyperText:(0,b.isEmpty)(n)?a:n});o.o.setHyperLinkInfoFromJson(k)}}}]),n}(u.mY)},766046:function(e,t,n){n.r(t),n.d(t,{HyperlinkTab:function(){return l},default:function(){return m}});var l,r=n(601413),a=n(870885),i=n(747313),s=n(180252),c=n(700936),u=n(837490),o=n(735622),p=n(448439),h=n(96001),b=n(827611),T=n(307360),_=n(407604),x=n(981142),L=n(588567),d=n(416031),C=n(305054),k=n(530624),y=n(551261),j=n(346417);function m(e){var t="mailto:",n=(0,c.Z)().formatMessage,m=(0,s.I0)(),I=e.dialogId,O=e.tabs,E=e.commandName,f=p.Z.getCommandInstance(E),g=(0,i.useState)(!1),N=(0,a.Z)(g,2),v=N[0],Z=N[1],K=(0,i.useState)(""),H=(0,a.Z)(K,2),S=H[0],D=H[1],q=(0,i.useState)(""),R=(0,a.Z)(q,2),A=R[0],M=R[1],V=(0,i.useState)(""),P=(0,a.Z)(V,2),U=P[0],W=P[1],Q=(0,i.useState)(l.Web),w=(0,a.Z)(Q,2),Y=w[0],G=w[1],z=(0,i.useState)(!1),B=(0,a.Z)(z,2),F=B[0],J=B[1],X=(0,i.useState)(!1),$=(0,a.Z)(X,2),ee=$[0],te=$[1],ne=(0,i.useState)([]),le=(0,a.Z)(ne,2),re=le[0],ae=le[1],ie=(0,i.useState)(0),se=(0,a.Z)(ie,2),ce=se[0],ue=se[1],oe=O[Y].buttons,pe="<<".concat(n({id:"DLG_HYPERLINK_SELECTED_ON_DOCUMENT"}),">>"),he=(0,i.useCallback)((function(){f.invoke({actionType:y.U.DeleteHyperlink})}),[f]),be=(0,i.useCallback)((function(){var e="";e=Y===l.Web?A:Y===l.CurrentDocument?re[ce].linkType===L.QLl.EV_LINK_TO_START_DOC?"_top":re[ce].label:U,f.invoke({actionType:y.U.InsertHyperlink,displayText:""===S?e:S,hyperlink:e,hyperLinkTab:Y,selectedLinkType:Y===l.CurrentDocument?re[ce].linkType:null})}),[f,S,U,Y,ce,re,A]),Te=(0,i.useCallback)((function(e){e.stopPropagation()}),[]),_e=(0,i.useCallback)((function(e){"Enter"===e.key&&A.length>0&&(be(),o.Z.hideDialog(I))}),[I,be,A.length]),xe=(0,i.useCallback)((function(e){ue(e),te(!re[e].canInsertHyperlink)}),[re]),Le={tabIndex:Y,tabs:O,onTabChange:(0,i.useCallback)((function(e){e===l.Web?te(!!(S.length<1||A.length<1)):e===l.CurrentDocument?te(!re[ce].canInsertHyperlink):e===l.Email&&te(!!(S.length<1||U.length<1)),G(e)}),[S.length,A.length,re,ce,U.length])},de={buttonLabels:oe,buttonDisableStates:[F,ee,!1],onClick:(0,i.useCallback)((function(e){0===e?he():1===e&&be(),o.Z.hideDialog(I)}),[I,he,be])},Ce=(0,i.useCallback)((function(e){D(e.currentTarget.value),Y===l.Web?te(!!(A.length<1)):Y===l.CurrentDocument?te(!re[ce].canInsertHyperlink):Y===l.Email&&te(!!(e.currentTarget.value.length<1||U.length<1))}),[Y,A.length,re,ce,U.length]),ke=(0,i.useCallback)((function(e){M(e.currentTarget.value),te(!!(e.currentTarget.value.length<1))}),[]),ye=(0,i.useCallback)((function(e){var n="";if(e.currentTarget.value.startsWith(t))n=e.currentTarget.value;else{for(var l=t.split(""),r=e.currentTarget.value.split(""),a=0;a<r.length&&!(l.length<=a)&&r[a]===l[a];a+=1)r[a]="";n=t+r.join("")}W(n),te(!!(S.length<1||e.currentTarget.value.length<1))}),[S.length]),je=(0,i.useCallback)((function(e){var t="DLG_HYPERLINK_TITLE_EDIT_HYPERLINK";return e.nLinkType===L.QLl.EV_LINK_TO_BOOKMARK?t:(0,d.isEmpty)(e.szHyperLink)?"DLG_HYPERLINK_TITLE_INSERT_HYPERLINK":t}),[]),me=(0,i.useCallback)((function(){switch(C.Z.getObjectControlType()){case k.uq.eObjCtrTemplate:case k.uq.eObjCtrShape:case k.uq.eObjCtrGroup:case k.uq.eObjCtrGroupInlineText:case k.uq.eObjCtrLine:case k.uq.eObjCtrLineInlineText:case k.uq.eObjCtrInfraPen:case k.uq.eObjCtrInfraPenInlineText:case k.uq.eObjCtrImageInlineText:case k.uq.eObjCtrImage:case k.uq.eObjCtrTextBox:case k.uq.eObjCtrTextBoxInlineText:case k.uq.eObjCtrChart:case k.uq.eObjCtrTemplateInlineText:case k.uq.eObjCtrFLine:case k.uq.eObjCtrFLineInlineText:case k.uq.eObjCtrSmtArtGroup:case k.uq.eObjCtrSmtArtGroupInlineText:case k.uq.eObjCtrSmtArtChildShape:case k.uq.eObjCtrSmtArtChildLine:case k.uq.eObjCtrPargraphStrip:case k.uq.eObjCtrPargraphStripInline:return!0}}),[]),Ie=(0,i.useCallback)((function(){switch(C.Z.getObjectControlType()){case k.uq.eObjCtrChartTextSelect:case k.uq.eObjCtrTableTextSelect:case k.uq.eObjCtrTextBoxTextSelect:case k.uq.eObjCtrTemplateTextSelect:case k.uq.eObjCtrMemoTextSelect:case k.uq.eObjCtrDropCapTextSelect:case k.uq.eObjCtrFLineTextSelect:case k.uq.eObjCtrSmtArtChildTextSelect:case k.uq.eObjCtrEquationTextSelect:case k.uq.eObjCtrHWPEquationTextSelect:return!0}return!1}),[]),Oe=(0,i.useCallback)((function(e){var t="",n="",l=!0,r=!1;return e.nLinkType!==L.QLl.EV_LINK_TO_URL&&e.nLinkType!==L.QLl.EV_LINK_TO_BOOKMARK&&e.nLinkType!==L.QLl.EV_LINK_TO_EMAIL||(r=!0),me()?(t=pe,l=!1,r&&(n=e.szHyperLink)):r?((0,d.isEmpty)(e.szHyperText)&&!(0,d.isEmpty)(e.szHyperLink)?(t=pe,l=!1):t=e.szHyperText,n=e.szHyperLink):Ie()&&(0,d.isEmpty)(e.szHyperText)?(t=pe,l=!1):t=e.szHyperText,{hyperlinkText:t,hyperlinkUrl:n,isDisplayTextEnable:l}}),[me,Ie,pe]);return(0,i.useEffect)((function(){var e=x.o.getHyperlinkInfo(0,0,!0),t=Oe(e),r=t.hyperlinkText,a=t.hyperlinkUrl,i=t.isDisplayTextEnable,s=n({id:je(e)}),c=[];c.push({linkType:L.QLl.EV_LINK_TO_START_DOC,label:n({id:"DLG_INSERT_LINK_DOCUMENT_TOP"}),canInsertHyperlink:!0,isIndent:!1,bookmark:"_top"}),c.push({linkType:L.QLl.EV_LINK_TO_BOOKMARK,label:n({id:"BOOKMARK"}),canInsertHyperlink:!1,isIndent:!1,bookmark:""});for(var u=x.o.getBookmarks(!0),o=0;o<u.length;o+=1)"_"!==u[o].charAt(0)&&c.push({linkType:L.QLl.EV_LINK_TO_BOOKMARK,label:u[o],canInsertHyperlink:!0,isIndent:!0,bookmark:u[o]});ae(c),e.nLinkType===L.QLl.EV_LINK_TO_BOOKMARK?(G(l.CurrentDocument),te(!c[0].canInsertHyperlink),ue(c.findIndex((function(e){return e.bookmark===a})))):e.nLinkType===L.QLl.EV_LINK_TO_EMAIL?(G(l.Email),W(a),te(!(r.length>0&&a.length>0))):(G(l.Web),M(a),te(!(r.length>0&&a.length>0))),D(r),Z(!i),J(!(r.length>0&&a.length>0)),m((0,_.GV)({dialogId:I,dynamicTitle:s}))}),[n,f,I,m,je,Oe,ae]),(0,j.jsxs)(i.Fragment,{children:[(0,j.jsx)(h.Z,(0,r.Z)({},Le)),(0,j.jsx)("div",{className:u.Z.popup_contents,onMouseUp:Te,onKeyDown:_e,children:(0,j.jsxs)("table",{className:u.Z.form_table,children:[(0,j.jsx)("colgroup",{children:(0,j.jsx)("col",{style:{width:"auto"}})}),(0,j.jsxs)("tbody",{children:[(0,j.jsx)("tr",{children:(0,j.jsx)("th",{children:(0,j.jsx)(T.Z,{label:"DLG_HYPERLINK_TEXT_TO_DISPLAY"})})}),(0,j.jsx)("tr",{children:(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:u.Z.multi_select,children:(0,j.jsx)("div",{className:u.Z.i_txt,children:(0,j.jsx)("input",{type:"text",value:S,onChange:Ce,spellCheck:!1,readOnly:!!v,className:v?u.Z.disabled:""})})})})}),Y===l.Web?(0,j.jsx)("tr",{children:(0,j.jsx)("th",{children:(0,j.jsx)(T.Z,{label:"DLG_HYPERLINK_ADDRESS"})})}):null,Y===l.Web?(0,j.jsx)("tr",{children:(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:u.Z.multi_select,children:(0,j.jsx)("div",{className:u.Z.i_txt,children:(0,j.jsx)("input",{type:"text",value:A,onChange:ke,spellCheck:!1})})})})}):null,Y===l.CurrentDocument?(0,j.jsx)("tr",{children:(0,j.jsx)("th",{children:(0,j.jsx)(T.Z,{label:"DLG_HYPERLINK_TAB_CURRENT_DOCUMENT"})})}):null,Y===l.CurrentDocument?(0,j.jsx)("tr",{children:(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:u.Z.flex_box,children:(0,j.jsx)("div",{className:u.Z.inner_box,children:(0,j.jsx)("div",{className:u.Z.list_box,style:{height:"368px"},children:(0,j.jsx)("ul",{children:re.map((function(e,t){var n=e.label,l=e.isIndent,r="";return t===ce&&(r=u.Z.active),l&&(r+=" ".concat(u.Z.indent)),(0,j.jsx)("li",{children:(0,j.jsx)("button",{className:r,onClick:function(){return xe(t)},children:n})},t)}))})})})})})}):null,Y===l.Email?(0,j.jsx)("tr",{children:(0,j.jsx)("th",{children:(0,j.jsx)(T.Z,{label:"DLG_HYPERLINK_TAB_EMAIL"})})}):null,Y===l.Email?(0,j.jsx)("tr",{children:(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:u.Z.multi_select,children:(0,j.jsx)("div",{className:u.Z.i_txt,children:(0,j.jsx)("input",{type:"text",value:U,onChange:ye,spellCheck:!1})})})})}):null]})]})}),(0,j.jsx)(b.Z,(0,r.Z)({},de))]})}!function(e){e[e.Web=0]="Web",e[e.CurrentDocument=1]="CurrentDocument",e[e.Email=2]="Email"}(l||(l={}))}}]);