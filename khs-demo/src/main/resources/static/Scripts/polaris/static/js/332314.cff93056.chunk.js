"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[332314],{782345:function(e,t,n){n.d(t,{U:function(){return y},j:function(){return a}});var a,i=n(974165),o=n(115861),r=n(215671),u=n(143144),l=n(625477),s=n(500811),c=n(628264),d=n(652928),f=n(735622),h=n(995124),C=n(769071),v=n(981142),m=n(588567),p=n(416031),T=n(815e3),E=n(53110);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(a||(a={}));var I=/<!--\[if gte vml 1\]>/g,_=/<!\[endif\]-->/g,O=/<!--\[PO\]\[if gte vml 1\]>/g,g=/<!\[endif\]\[PO\]-->/g,y=function(){function e(){(0,r.Z)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return(0,u.Z)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,(0,l.Ce)((0,s.vQ)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,(0,l.Ce)((0,s.$A)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===h.O.COMMON_CLIPBOARD?f.Z.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):f.Z.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return(0,l.qm)(c.p_).viewMode===d.wO.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,v.o.editDocument(m.OjI.BR_EDITMODE_COPY,m.vlz.CLIPDATA_FAVORITE_DATA,null,a.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,v.o.editDocument(m.OjI.BR_EDITMODE_CUT,m.vlz.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.OjI.BR_EDITMODE_PASTE,t=T.ZP.get("preventPasteFromExternal");this.isNativeMode||t?v.o.editDocument(e,m.vlz.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD):this.showAlert(h.O.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){v.o.editDocument(m.OjI.BR_EDITMODE_ORIGINAL_FORMAT,t,t===m.vlz.CLIPDATA_HTML?this.excludeImgElements(e):e,a.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=function(){var t=e[0];if(t){var n=new FileReader;n.onload=function(){if(n.readyState===FileReader.DONE){var e=n.result,t=new Image;e&&(t.src=e.toString(),t.onload=function(){for(var e=640,n=360,a=t.width,r=t.height;a>e||r>n;)a>e?(r*=e/a,a=e):r>n&&(a*=n/r,r=n);var u=document.createElement("canvas");u.width=a,u.height=r;var l=u.getContext("2d");l&&(l.drawImage(t,0,0,a,r),u.toBlob(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,(0,E.Cq)(t);case 3:(n=e.sent)instanceof ArrayBuffer&&v.o.imageInsert(n,0,0,0,0,0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))})}},n.readAsDataURL(t)}},n=0;n<e.length;n+=1)t()}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),a=!(0,p.isEmpty)(n),i=!(0,p.isEmpty)(t),o=a&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),r=e.files&&e.files.length>0,u=T.ZP.get("preventPasteFromExternal");o||u?this.nativePaste():r&&!i?this.appendClipboardImage(e.files):a&&this.htmlDataTagCount(n)>0?this.externalPaste(n,m.vlz.CLIPDATA_HTML):i&&this.externalPaste(t,m.vlz.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var a=n.getElementsByTagName(t).length;return n.remove(),a}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===m.vlz.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var a=document.createRange();a.selectNodeContents(n);var i=window.getSelection();if(i){var o,r,u=[];if(i.rangeCount>0)for(var l=0;l<i.rangeCount;l+=1){var s=i.getRangeAt(l);u.push(s)}if(i.removeAllRanges(),i.addRange(a),document.execCommand("copy"),i.removeAllRanges(),u&&u.length>0)for(var c=0;c<u.length;c+=1)i.addRange(u[c]);var d=null===(o=C.Z.getForcusRef("DocInputField"))||void 0===o||null===(r=o.elementRef)||void 0===r?void 0:r.current;d&&d instanceof HTMLInputElement&&d.select()}}n.remove(),C.Z.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(I,"").replace(_,"");for(var n=t.getElementsByTagName("img"),a=0;a<n.length;a+=1){var i=n[a].getAttribute("v:shapes");if(!(0,p.isEmpty)(i)){var o=t.querySelector('[id="'.concat(i,'"]'));if(!o||!o.tagName||!o.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(I,"\x3c!--[PO][if gte vml 1]>")).replace(_,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!O.test(e)||!g.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(O,"").replace(g,"");var n=document.createElement("div");n.innerHTML=e.replace(O,"\x3c!--[if gte vml 1]>").replace(g,"<![endif]--\x3e");for(var a=n.getElementsByTagName("img"),i=a.length-1;i>=0;i-=1){var o=a[i],r=o.getAttribute("v:shapes");if(!(0,p.isEmpty)(r)){var u=t.querySelector('[id="'.concat(r,'"]'));u&&u.tagName&&u.tagName.toLowerCase().startsWith("v:")&&o.remove()}}return n.innerHTML}}]),e}()},440009:function(e,t,n){var a=n(215671),i=n(143144),o=n(981142),r=n(625477),u=n(524097),l=new(function(){function e(){(0,a.Z)(this,e),this._thumbnailDatas=[],this.STYLE_NAME_LIST=["QUICK_STYLE_TITLE","QUICK_STYLE_HEADING1","QUICK_STYLE_HEADING2","QUICK_STYLE_HEADING3","QUICK_STYLE_HEADING4","QUICK_STYLE_HEADING5","QUICK_STYLE_HEADING6","QUICK_STYLE_HEADING7","QUICK_STYLE_HEADING8","QUICK_STYLE_HEADING9","QUICK_STYLE_SUBTITLE","QUICK_STYLE_SUBEMPHASI","QUICK_STYLE_EMPHASIS","QUICK_STYLE_INTEMPHASI","QUICK_STYLE_STRONG","QUICK_STYLE_QUOTE","QUICK_STYLE_INTQUOTE","QUICK_STYLE_SUBREFER","QUICK_STYLE_INTREFER","QUICK_STYLE_LISTPARA","QUICK_STYLE_NORMAL","QUICK_STYLE_NOSPACE","QUICK_STYLE_BOOKTITLE"],this.DEFAULT_STYLE_NAME=["Title","heading 1","heading 2","heading 3","heading 4","heading 5","heading 6","heading 7","heading 8","heading 9","Subtitle","Subtle Emphasis","Emphasis","Intense Emphasis","Strong","Quote","Intense Quote","Subtle Reference","Intense Reference","List Paragraph","Normal","No Spacing","Book title"]}return(0,i.Z)(e,[{key:"requestThumbnail",value:function(e){this._thumbnailDatas=[],o.o.getPreviewStyle(70*e,30*e,0,96*e)}},{key:"OnDrawGetPreviewStyle",value:function(e,t,n,a,i,o,l){var s=this,c=o,d=!1,f=this.DEFAULT_STYLE_NAME.indexOf(c);-1!==f&&(c=this.STYLE_NAME_LIST[f],d=!0);var h={index:i,width:t,height:n,url:e,styleName:c,styleIndex:a,isLocaleText:d};this._thumbnailDatas[i]=h,setTimeout((function(){(0,r.Ce)((0,u.KA)({thumbnailDatas:s._thumbnailDatas}))}),300)}}]),e}());t.Z=l},335302:function(e,t,n){var a=n(215671),i=n(143144),o=n(179340),r=n(432269),u=n(782345),l=n(981142),s=n(305054),c=n(588567),d=n(530624),f=n(625477),h=n(229860),C=n(600021),v=n(815e3),m=function(e){(0,o.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"cancelCopyFormatMode",value:function(){this.copyFormatMode(!1)}},{key:"copyFormat",value:function(e){this.isCopyFormatMode?this.copyFormatMode(!1):(this.copyFormatMode(!0,e),l.o.setFormCopyPaste(c.YMl.eFCP_COPY))}},{key:"copyFormatMode",value:function(e,t){this.setCopyFormatMode(e)&&(this.isCopyFormatMode?((0,f.Ce)((0,C.FV)(t?1:0)),(0,f.Ce)((0,h.kA)(t?c.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_MULTI:c.mel.BR_MOUSE_HOVERING_UI_FORM_COPY_ONE)),(0,f.Ce)((0,h.ve)(!0))):((0,f.Ce)((0,C.FV)(-1)),(0,f.Ce)((0,h.kA)(c.mel.BR_MOUSE_HOVERING_NONE,!0))))}},{key:"formatPaste",value:function(){s.Z.getObjectControlType()===d.uq.eObjCtrEmpty?this.copyFormatMode(!1):(l.o.formatPaste(!1),0===(0,f.qm)(C.Gu).currentIndex&&this.copyFormatMode(!1))}},{key:"onClipboardResult",value:function(e,t,n,a){if(e===c.RUN.COPY_EVENT||e===c.RUN.CUT_EVENT){if(this.setNativeMode(!0),v.ZP.get("preventCopyToExternal"))return;var i="",o=c.vlz.CLIPDATA_STR;if(""!==n&&(i=n),""!==a&&(i=a,o=c.vlz.CLIPDATA_HTML),s.Z.getObjectControlType()!==d.uq.eObjCtrTemplate&&s.Z.getObjectControlType()!==d.uq.eObjCtrTemplateInlineText&&s.Z.getObjectControlType()!==d.uq.eObjCtrLine&&s.Z.getObjectControlType()!==d.uq.eObjCtrLineInlineText&&s.Z.getObjectControlType()!==d.uq.eObjCtrImage&&s.Z.getObjectControlType()!==d.uq.eObjCtrImageInlineText&&s.Z.getObjectControlType()!==d.uq.eObjCtrChart&&s.Z.getObjectControlType()!==d.uq.eObjCtrChartInlineText||(i="<span>".concat(i,"</span>"),o=c.vlz.CLIPDATA_HTML),this.clipboardDataTransfer){var r=this.createClipboardElement(i);this.clipboardDataTransfer.setData("text/html",r.innerHTML),n.length>0&&this.clipboardDataTransfer.setData("text/plain",n),this.clipboardDataTransfer=null,r.remove()}else this.copyToClipboard(i,o)}}}]),n}(u.U),p=new m;t.Z=p},332314:function(e,t,n){n.r(t);var a=n(625477),i=n(448439),o=n(260861),r=n(347806),u=n(768895),l=n(981142),s=n(732094),c=n(335302),d=n(588567),f=n(735622),h=n(995124),C=n(237683),v=n(53110),m=n(440009),p=n(836051),T=n(407530),E=n(109687),I=n(335788),_=n(815e3),O=n(652928),g=n(780386),y=n(305054),D=n(491440),S={OnInitComplete:function(){(0,v.Vq)()||((0,a.Ce)((0,p.PF)()),(0,a.Ce)((0,T.T5)()))},OnOpenComplete:function(){i.Z.commandInitvalue(),r.Z.hideContextMenu(),(0,a.Ce)((0,o.kp)()),(0,a.Ce)((0,u.iE)()),l.o.setZoom(1e4),l.o.scrollUp(d.ZJZ.eSCROLL_FACTOR_80),v.tq&&l.o.setViewMode(d.lK3.eVIEWMODE_FITTOWIDTH),setTimeout((function(){(0,a.Ce)((0,E.kS)()),(0,a.Ce)((0,I.TA)())}),200)},OnLoadFail:function(e){var t=function(){C.Z.apply("onLoadFail",[e]),f.Z.showDialog({dialogId:h.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_INTERNAL"}},(function(){C.Z.apply("onCancelOpenDocument")}))};switch(e){case d.v6t.kPoErrWritePasswordDoc:case d.v6t.kPoErrReadPasswordDoc:case d.v6t.kPoErrWrongWritePassword:case d.v6t.kPoErrWrongReadPassword:var n=_.ZP.get("viewMode"),a=_.ZP.get("preventEditPasswordDocument");if(((0,v.Vq)()||n!==O.wO.edit||!0===a)&&e===d.v6t.kPoErrWritePasswordDoc)return g.Z.setOpenMode(d.ekp.ePRM_PASSWORD_WRITE_READ_ONLY),void g.Z.openDocumentWithPassword();f.Z.showDialog({dialogId:h.O.COMMON_DOC_PASSWORD_CONFIRM,bModal:!0,data:e},(function(){t()}));break;case d.v6t.kPoErrUnsupportedEncryptionType:C.Z.apply("onLoadFail",[e]),f.Z.showDialog({dialogId:h.O.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_ENCRYPTION_TYPE"}},(function(){C.Z.apply("onCancelOpenDocument")}));break;default:t()}},OnDrawBitmapThrottle:function(){(0,a.Ce)((0,u.oY)())},OnShapeDrawModeEnd:function(){s.Z.endShapeDraw()},OnGetHighlightListCount:function(e){},OnClipboardResult:function(e){var t=e.nEventType,n=e.nResult,a=e.textData,i=e.htmlData;c.Z.onClipboardResult(t,n,a,i)},OnDrawGetPreviewStyle:function(e){var t=e.imageBlob,n=e.width,a=e.height,i=e.styleIndex,o=e.index,r=e.styleName,u=e.bTextAttStyle;m.Z.OnDrawGetPreviewStyle(URL.createObjectURL(t),n,a,i,o,r,u)},OnNewDoc:function(){},OnMemoResult:function(e){var t=_.ZP.get("viewMode");if(!y.Z.isHeaderFooterEditing()&&!g.Z.isPasswordDocument&&t===O.wO.edit&&e===d.TlE.MEMO_RESULT_SELECT_REPLAY_ICON){var n=_.ZP.get("author")||"User";l.o.memoAddReply(n,-1,0)}},OnGetImageLocationsInScreen:function(e){var t=e.imageLocations;if(_.ZP.checkCallback("onServiceExternal")){var n=[];t.forEach((function(e){var t=e.priority,a=e.points,i=e.origin_rect,o=e.rotateAngle,r=e.frameID,u=e.urlExists,l=u?e.frameUrl:"";n.push({priority:t,points:a,originalRect:i,rotateAngle:o,frameId:r,frameUrl:l,existUrl:u})})),(0,a.Ce)((0,D.UO)(n))}},BSendTrackReviewModeInfo:function(e){(0,a.Ce)((0,E.se)(e))}};t.default=S},600021:function(e,t,n){n.d(t,{FV:function(){return d},Gu:function(){return c}});var a=n(426373),i=n(135323),o=n(500811),r=n(101922),u=n(798879),l=n(371266),s=(0,a.oM)({name:"formCopy",initialState:{isChecked:!1,isDisabled:!1,isDisabledSubmenu:!1,currentIndex:3},reducers:{setFormCopyItem:function(e,t){e.currentIndex=t.payload}},extraReducers:function(e){e.addCase(r.He,(function(e){e.isDisabled=u.Z.isDisable(l.Gsz),e.isDisabledSubmenu=u.Z.isDisable(l.Gsz)})),e.addCase(o.$A,(function(e,t){e.isChecked=t.payload}))}}),c=(0,i.P1)((function(e){return e.command.clipboard.formCopy}),(function(e){return e})),d=s.actions.setFormCopyItem;t.ZP=s.reducer},524097:function(e,t,n){n.d(t,{J1:function(){return T},J4:function(){return m},KA:function(){return v},jX:function(){return p}});var a=n(426373),i=n(135323),o=n(625477),r=n(101922),u=n(798879),l=n(371266),s=n(440009),c=n(981142),d=n(260861),f={isDisabled:!1,currentStyleIndex:-1,thumbnailDatas:[]},h=(0,a.oM)({name:"fontStyle",initialState:f,reducers:{setFontStyleThumbnail:function(e,t){var n=t.payload.thumbnailDatas;e.thumbnailDatas=n},clearFontStyleDatas:function(){return f}},extraReducers:function(e){e.addCase(r.He,(function(e){e.isDisabled=u.Z.isDisable(l.vvn)})),e.addCase(d.SP,(function(e,t){"home_style"===t.payload.id&&(e.currentStyleIndex=c.o.getStyleTypeIndex())}))}}),C=h.actions,v=C.setFontStyleThumbnail,m=C.clearFontStyleDatas;t.ZP=h.reducer;var p=(0,i.P1)((function(e){return e.command.font}),(function(e){return e.style})),T=function(){return(0,o.RU)("setFontStyleThumbnailThunk",(function(e,t){var n=t().section.devicePixelRatio;s.Z.requestThumbnail(n)}))}},407530:function(e,t,n){n.d(t,{T5:function(){return h},UN:function(){return C},wW:function(){return s}});var a=n(426373),i=n(135323),o=n(981142),r=n(705233),u=n(625477),l=(0,a.oM)({name:"tableGrid",initialState:{isChecked:!1},reducers:{setIsChecked:function(e,t){e.isChecked=t.payload}}}),s=(0,i.P1)((function(e){return e.command.table.tableGrid}),(function(e){return e})),c=l.actions.setIsChecked;t.ZP=l.reducer;var d;!function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"}(d||(d={}));var f=function(e){o.o.setTableGrid(e?d.Show:d.Hide)},h=function(){return(0,u.RU)("initTableGridShowThunk",(function(e){var t="true"===(0,r.le)(r.Fe.TABLE_GRID_SHOW_KEY);f(t),e(c(t))}))},C=function(e){return(0,u.RU)("setTableGridShowThunk",(function(t){f(e),t(c(e)),function(e){(0,r.D$)(r.Fe.TABLE_GRID_SHOW_KEY,e?"true":"false")}(e)}))}},836051:function(e,t,n){n.d(t,{Cm:function(){return p},Kc:function(){return C},PF:function(){return m}});var a=n(426373),i=n(135323),o=n(625477),r=n(981142),u=n(101922),l=n(798879),s=n(371266),c=n(705233),d=n(53110),f=(0,a.oM)({name:"gridline",initialState:{isChecked:!0,isDisabled:!1},reducers:{setIsChecked:function(e,t){e.isChecked=t.payload}},extraReducers:function(e){e.addCase(u.He,(function(e){(0,d.Vq)()||(e.isChecked=r.o.getGridGuides().bShow,e.isDisabled=l.Z.isDisable(s.G4l))}))}}),h=function(e){var t=r.o.getGridGuides();r.o.setGridGuides(e,t.bSnap,t.nGapHimetric)},C=(0,i.P1)((function(e){return e.command.view.gridline}),(function(e){return e})),v=f.actions.setIsChecked;t.ZP=f.reducer;var m=function(){return(0,o.RU)("initGridlineThunk",(function(e){var t="true"===(0,c.le)(c.Fe.GRIDLINE_SHOW_KEY);h(t),e(v(t))}))},p=function(e){return(0,o.RU)("setGridlineThunk",(function(t){h(e),t(v(e)),function(e){(0,c.D$)(c.Fe.GRIDLINE_SHOW_KEY,e?"true":"false")}(e)}))}}}]);