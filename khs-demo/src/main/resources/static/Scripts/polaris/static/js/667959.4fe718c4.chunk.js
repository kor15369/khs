"use strict";(self.webpackChunkpolaris_weboffice=self.webpackChunkpolaris_weboffice||[]).push([[667959],{827611:function(e,t,n){n.d(t,{Z:function(){return s}});n(747313);var a=n(837490),l=n(307360),r=n(346417);function s(e){var t=e.buttonLabels,n=e.onClick,s=e.buttonDisableStates;return(0,r.jsx)("div",{className:a.Z.popup_btn_wrap,children:t.map((function(e,t){var i=!!s&&s[t];return(0,r.jsx)("button",{className:"".concat(a.Z.p_btn," ").concat(a.Z.normal),onClick:function(){return n(t)},disabled:i,children:(0,r.jsx)(l.Z,{label:e})},t)}))})}},96001:function(e,t,n){n.d(t,{Z:function(){return s}});n(747313);var a=n(837490),l=n(307360),r=n(346417);function s(e){var t=e.tabs,n=e.onTabChange,s=e.tabIndex;return(0,r.jsx)("div",{className:a.Z.popup_tab,children:(0,r.jsx)("ul",{children:t.map((function(e,t){return(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:s===t?a.Z.on:"",onClick:function(){return n(t)},children:(0,r.jsx)(l.Z,{label:e.label})})},t)}))})})}},667959:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var a=n(601413),l=n(870885),r=n(747313),s=n(180252),i=n(700936),c=n(837490),u=n(735622),o=n(448439),h=n(96001),b=n(827611),x=n(307360),p=n(407604),d=n(981142),j=n(588567),C=n(416031),T=n(305054),g=n(530624),m=n(767644),L=n(346417);function _(e){var t="mailto:",n=(0,i.Z)().formatMessage,_=(0,s.I0)(),f=e.dialogId,y=e.tabs,I=e.commandName,k=o.Z.getCommandInstance(I),Z=(0,r.useState)(!1),E=(0,l.Z)(Z,2),v=E[0],O=E[1],S=(0,r.useState)(""),q=(0,l.Z)(S,2),N=q[0],H=q[1],D=(0,r.useState)(""),P=(0,l.Z)(D,2),R=P[0],A=P[1],G=(0,r.useState)(""),Y=(0,l.Z)(G,2),w=Y[0],z=Y[1],B=(0,r.useState)(0),K=(0,l.Z)(B,2),U=K[0],M=K[1],F=(0,r.useState)(!1),W=(0,l.Z)(F,2),V=W[0],X=W[1],J=(0,r.useState)(!1),Q=(0,l.Z)(J,2),$=Q[0],ee=Q[1],te=y[U].buttons,ne="<<".concat(n({id:"DLG_HYPERLINK_SELECTED_ON_DOCUMENT"}),">>"),ae=(0,r.useCallback)((function(e){e.stopPropagation()}),[]),le={tabIndex:U,tabs:y,onTabChange:(0,r.useCallback)((function(e){M(e),0===e?ee(!!(N.length<1||R.length<1)):1===e&&ee(!!(N.length<1||w.length<1))}),[w.length,N.length,R.length])},re=(0,r.useCallback)((function(){var e=m.Z.getData();return!!e&&(0!==(e.dwCellType&j.aH7.BR_SHEET_CELL_TYPE_NUMBER)||0!==(e.dwCellType&j.aH7.BR_SHEET_CELL_TYPE_FORMULA))}),[]),se={buttonLabels:te,buttonDisableStates:[V,$,!1],onClick:(0,r.useCallback)((function(e){switch(e){case 0:k.invoke({buttonIndex:e});break;case 1:k.invoke({buttonIndex:e,displayText:v?"":N,isDisplayTextDisabled:v,isSheetFormulaORNumber:re(),url:0===U?R:w})}u.Z.hideDialog(f)}),[k,f,N,w,v,re,U,R])},ie=(0,r.useCallback)((function(e){H(e.currentTarget.value),0===U?ee(!!(R.length<1)):1===U&&ee(!!(e.currentTarget.value.length<1||w.length<1))}),[U,w.length,R.length]),ce=(0,r.useCallback)((function(e){A(e.currentTarget.value),ee(!!(e.currentTarget.value.length<1))}),[]),ue=(0,r.useCallback)((function(e){var n="";if(e.currentTarget.value.startsWith(t))n=e.currentTarget.value;else{for(var a=t.split(""),l=e.currentTarget.value.split(""),r=0;r<l.length&&!(a.length<=r)&&l[r]===a[r];r+=1)l[r]="";n=t+l.join("")}z(n),ee(!!(N.length<1||e.currentTarget.value.length<1))}),[N.length]),oe=(0,r.useCallback)((function(e){var t="DLG_HYPERLINK_TITLE_EDIT_HYPERLINK";return(0,C.isEmpty)(e.szHyperCell)&&(0,C.isEmpty)(e.szHyperLink)?"DLG_HYPERLINK_TITLE_INSERT_HYPERLINK":t}),[]),he=(0,r.useCallback)((function(){switch(T.Z.getObjectControlType()){case g.uq.eObjCtrTemplateTextCaret:case g.uq.eObjCtrTemplateTextSelect:case g.uq.eObjCtrTextBoxTextCaret:case g.uq.eObjCtrTextBoxTextSelect:case g.uq.eObjCtrSmtArtChildTextSelect:case g.uq.eObjCtrSmtArtChildTextCaret:case g.uq.eObjCtrTemplate:case g.uq.eObjCtrShape:case g.uq.eObjCtrGroup:case g.uq.eObjCtrGroupInlineText:case g.uq.eObjCtrLine:case g.uq.eObjCtrLineInlineText:case g.uq.eObjCtrInfraPen:case g.uq.eObjCtrInfraPenInlineText:case g.uq.eObjCtrImageInlineText:case g.uq.eObjCtrImage:case g.uq.eObjCtrTextBox:case g.uq.eObjCtrTextBoxInlineText:case g.uq.eObjCtrChart:case g.uq.eObjCtrTemplateInlineText:case g.uq.eObjCtrFLine:case g.uq.eObjCtrFLineInlineText:case g.uq.eObjCtrSmtArtGroup:case g.uq.eObjCtrSmtArtGroupInlineText:case g.uq.eObjCtrSmtArtChildShape:case g.uq.eObjCtrSmtArtChildLine:case g.uq.eObjCtrPargraphStrip:case g.uq.eObjCtrPargraphStripInline:return!0}return!1}),[]),be=(0,r.useCallback)((function(e){var t="",n="",a=!0,l=!1;return e.nLinkType!==j.py1.eSLT_URL&&e.nLinkType!==j.py1.eSLT_UNC&&e.nLinkType!==j.py1.eSLT_FILE&&e.nLinkType!==j.py1.eSLT_MAIL||(l=!0),he()?(t=ne,a=!1,l&&(n=e.szHyperLink)):l?((0,C.isEmpty)(e.szHyperText)&&!(0,C.isEmpty)(e.szHyperLink)?(t=ne,a=!1):t=e.szHyperText,n=e.szHyperLink):t=e.szHyperText,re()&&(t=ne,a=!1),{hyperlinkText:t,hyperlinkUrl:n,isDisplayTextEnable:a}}),[he,re,ne]);return(0,r.useEffect)((function(){var e=d.o.getSheetHyperLinkInfo(),a=be(e),l=a.hyperlinkText,r=a.hyperlinkUrl,s=a.isDisplayTextEnable,i=!!r.startsWith(t),c=n({id:oe(e)});H(l),i?z(r):A(r),O(!s),M(i?1:0),X(!(l.length>0&&r.length>0)),ee(!(l.length>0&&r.length>0)),_((0,p.GV)({dialogId:f,dynamicTitle:c}))}),[n,k,f,_,oe,be]),(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(h.Z,(0,a.Z)({},le)),(0,L.jsx)("div",{className:c.Z.popup_contents,onMouseUp:ae,children:(0,L.jsxs)("table",{className:c.Z.form_table,children:[(0,L.jsx)("colgroup",{children:(0,L.jsx)("col",{style:{width:"auto"}})}),(0,L.jsxs)("tbody",{children:[(0,L.jsx)("tr",{children:(0,L.jsx)("th",{children:(0,L.jsx)(x.Z,{label:"DLG_HYPERLINK_TEXT_TO_DISPLAY"})})}),(0,L.jsx)("tr",{children:(0,L.jsx)("td",{children:(0,L.jsx)("div",{className:c.Z.multi_select,children:(0,L.jsx)("div",{className:c.Z.i_txt,children:(0,L.jsx)("input",{type:"text",value:N,onChange:ie,spellCheck:!1,readOnly:!!v,className:v?c.Z.disabled:""})})})})}),0===U?(0,L.jsx)("tr",{children:(0,L.jsx)("th",{children:(0,L.jsx)(x.Z,{label:"DLG_HYPERLINK_ADDRESS"})})}):null,0===U?(0,L.jsx)("tr",{children:(0,L.jsx)("td",{children:(0,L.jsx)("div",{className:c.Z.multi_select,children:(0,L.jsx)("div",{className:c.Z.i_txt,children:(0,L.jsx)("input",{type:"text",value:R,onChange:ce,spellCheck:!1})})})})}):null,1===U?(0,L.jsx)("tr",{children:(0,L.jsx)("th",{children:(0,L.jsx)(x.Z,{label:"DLG_HYPERLINK_TAB_EMAIL"})})}):null,1===U?(0,L.jsx)("tr",{children:(0,L.jsx)("td",{children:(0,L.jsx)("div",{className:c.Z.multi_select,children:(0,L.jsx)("div",{className:c.Z.i_txt,children:(0,L.jsx)("input",{type:"text",value:w,onChange:ue,spellCheck:!1})})})})}):null]})]})}),(0,L.jsx)(b.Z,(0,a.Z)({},se))]})}}}]);